{
  "hash": "851b0c9d554ef865f8bebeee652e9fcd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"확률과 통계 R 실습 과제\"\ndate: last-modified\ncategories: [\"확률과 통계\", \"보고서\"]\n---\n\n\n\n\n![](/img/stat-thumb.jpg){.post-thumbnail}\n\n## One-way ANOVA\n\n### a\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nval1 <- c(1.84, 2.67, 2.61, 2.95, 2.25, 2.35, 2.85, 2.58, 3.08, 2.25)\nval2 <- c(1.79, 1.98, 2.01, 1.93, 2.24, 2.03, 2.22, 1.44, 2.24, 2.05)\nval3 <- c(3.31, 2.24, 2.74, 2.36, 2.79, 2.20, 2.32, 2.82, 2.73, 2.78)\ndf <- data.frame(\n  group = c(rep(\"일반 마우스\", 10), rep(\"트랙 패트\", 10), rep(\"버티컬 마우스\", 10)),\n  finger = c('왼중지', '왼검지', '오른약지', '왼약지', '왼엄지', '오른약지', '오른새끼', '오른엄지', '왼중지', '왼새끼', '오른중지', '오른엄지', '오른중지', '오른검지', '왼엄지', '왼검지', '오른새끼', '오른검지', '왼엄지', '오른중지', '왼검지', '왼새끼', '오른검지', '왼약지', '오른새끼', '오른엄지', '왼약지', '왼중지', '왼새끼', '오른약지'),\n  value = c(val1, val2, val3)\n)\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           group   finger value\n1    일반 마우스   왼중지  1.84\n2    일반 마우스   왼검지  2.67\n3    일반 마우스 오른약지  2.61\n4    일반 마우스   왼약지  2.95\n5    일반 마우스   왼엄지  2.25\n6    일반 마우스 오른약지  2.35\n7    일반 마우스 오른새끼  2.85\n8    일반 마우스 오른엄지  2.58\n9    일반 마우스   왼중지  3.08\n10   일반 마우스   왼새끼  2.25\n11     트랙 패트 오른중지  1.79\n12     트랙 패트 오른엄지  1.98\n13     트랙 패트 오른중지  2.01\n14     트랙 패트 오른검지  1.93\n15     트랙 패트   왼엄지  2.24\n16     트랙 패트   왼검지  2.03\n17     트랙 패트 오른새끼  2.22\n18     트랙 패트 오른검지  1.44\n19     트랙 패트   왼엄지  2.24\n20     트랙 패트 오른중지  2.05\n21 버티컬 마우스   왼검지  3.31\n22 버티컬 마우스   왼새끼  2.24\n23 버티컬 마우스 오른검지  2.74\n24 버티컬 마우스   왼약지  2.36\n25 버티컬 마우스 오른새끼  2.79\n26 버티컬 마우스 오른엄지  2.20\n27 버티컬 마우스   왼약지  2.32\n28 버티컬 마우스   왼중지  2.82\n29 버티컬 마우스   왼새끼  2.73\n30 버티컬 마우스 오른약지  2.78\n```\n\n\n:::\n:::\n\n\n\n\n- 요인: 클릭하는 장치 종류\n- 수준: 일반 마우스, 트랙 패드, 버티컬 마우스\n- 반응치: [클릭 반응속도](https://www.arealme.com/reaction-test/ko/)\n\n10개의 손가락에 대해 3개의 장치를 랜덤으로 사용하여 클릭 반응속도를 측정한다.\n\n각 손가락의 실험에 대해 랜덤으로 그룹을 나눈 후, 그룹별로 클릭하는 장치 종류를 배정하였다.\n\n### b\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.means <- tapply(df$value, INDEX=df$group, FUN=mean)\nboxplot(df$value ~ df$group, col=c(\"lightblue\", \"mistyrose\", \"lightcyan\"))\npoints(1:3, df.means, col=\"red\", pch=4, cex=1.5)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### c\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.sd <- tapply(df$value, INDEX=df$group, FUN=sd)\ndf.sd.diff <- max(df.sd) / min(df.sd)\nif (df.sd.diff > 2) \n{\n  print(\"모집단의 분산이 동일하지 않음\")\n} else \n{\n  print(\"모집단의 분산이 동일하다고 가정\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"모집단의 분산이 동일하다고 가정\"\n```\n\n\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### d\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggplot2\n```\n\n\n:::\n\n```{.r .cell-code}\nggqqplot(val1)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggqqplot(val2)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggqqplot(val3)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\n\n\n그림을 보니 반응치 값들이 정규분포를 따르는 것 같다!\n\n### e\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.anova <- aov(value ~ group, data=df)\nsummary(df.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ngroup        2  2.381  1.1907   11.17 0.000292 ***\nResiduals   27  2.878  0.1066                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nis_significant <- summary(df.anova)[[1]][[\"Pr(>F)\"]][1] < 0.05\nif (is_significant)\n{\n  print(\"95%에서 처리별 모평균의 차이가 있음\")\n} else\n{\n  print(\"95%에서 처리별 모평균의 차이가 없음\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"95%에서 처리별 모평균의 차이가 있음\"\n```\n\n\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### f\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (is_significant)\n{\n  df.bon <- pairwise.t.test(df$value, df$group, p.adjust.method = \"bonferroni\")\n  diff_pair <- which(df.bon$p.value < 0.05, arr.ind = TRUE)\n  if (length(diff_pair) > 0)\n  {\n    cat(\"모평균의 차이가 있는 쌍\", \"\\n\")\n    for (i in 1:nrow(diff_pair)) \n    {\n      cat(colnames(df.bon$p.value)[diff_pair[i, \"col\"]], \"-\", rownames(df.bon$p.value)[diff_pair[i, \"row\"]], \"\\n\")\n    }\n  } else \n  {\n    print(\"모평균의 차이가 있는 처리 쌍 없음\")\n  }\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n모평균의 차이가 있는 쌍 \n버티컬 마우스 - 트랙 패트 \n일반 마우스 - 트랙 패트 \n```\n\n\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n## ANOVA for Randomized Block Design\n\n### a\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- data.frame(\n  block = rep(c(\"아스팔트\", \"트랙\", \"모래밭\", \"잔디밭\"), each=3),\n  treatment = rep(c(\"런닝화\", \"축구화\", \"크록스\"), times=4),\n  value = c(6.1, 6.4, 6.5, 5.5, 5.9, 6.0, 6.9, 7.1, 7.5, 6.3, 6.9, 7.0)\n)\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      block treatment value\n1  아스팔트    런닝화   6.1\n2  아스팔트    축구화   6.4\n3  아스팔트    크록스   6.5\n4      트랙    런닝화   5.5\n5      트랙    축구화   5.9\n6      트랙    크록스   6.0\n7    모래밭    런닝화   6.9\n8    모래밭    축구화   7.1\n9    모래밭    크록스   7.5\n10   잔디밭    런닝화   6.3\n11   잔디밭    축구화   6.9\n12   잔디밭    크록스   7.0\n```\n\n\n:::\n:::\n\n\n\n\n- 요인: 운동화 종류\n- 수준: 런닝화, 축구화, 크록스\n- block: 달리는 땅\n- 반응치: 50m 달리기 시간(초)\n\n각 block에 대해 3개의 운동화 종류를 사용하는 순서를 랜덤으로 결정해서 달리기 시간을 측정한다.\n\n### b\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.anova.rbd <- aov(value ~ treatment + block, data=df)\nsummary(df.anova.rbd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ntreatment    2 0.6317  0.3158   27.73  0.00093 ***\nblock        3 3.0492  1.0164   89.24 2.28e-05 ***\nResiduals    6 0.0683  0.0114                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n처리에 의한 변동이 통계적으로 유의미하다.\n\nblock에 의한 변동 역시 통계적으로 유의미하다.\n\n### c\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.anova <- aov(value~treatment, data=df)\nsummary(df.anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)\ntreatment    2 0.6317  0.3158   0.912  0.436\nResiduals    9 3.1175  0.3464               \n```\n\n\n:::\n:::\n\n\n\n\n처리에 의한 변동이 통계적으로 유의미하지 않다고 나온다.\n\nblock에 의한 변동이 통계적으로 유의미하기 때문에, block에 의한 변동을 제거하고 처리에 의한 변동을 분석해야 하기 때문이다.\n\n## Simple Linear Regression\n\n### a\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- runif(100, 0, 10)\nerror <- rnorm(100, 0, 4)\ny <- 3 * x - 2 + error\nmodel <- lm(y ~ x)\nmodel\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ x)\n\nCoefficients:\n(Intercept)            x  \n     -1.167        2.928  \n```\n\n\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### b\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"B1의 추정 기울기: \", coef(model)[2])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nB1의 추정 기울기:  2.928177\n```\n\n\n:::\n\n```{.r .cell-code}\ntrust <- confint(model, level=0.95)[2, ]\ncat(\"신뢰구간: \", trust, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n신뢰구간:  2.638494 3.217861 \n```\n\n\n:::\n\n```{.r .cell-code}\nif (3 > trust[1] && 3 < trust[2]) \n{\n  print(\"신뢰구간에 3 포함\")\n} else \n{\n  print(\"신뢰구간에 3 안 포함\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"신뢰구간에 3 포함\"\n```\n\n\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### c\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(x, y, cex=0.7)\nabline(model, col = \"red\", lwd = 2)\nabline(-2, 3, col = \"blue\", lwd = 2)\nlegend(\"topleft\", legend = c(\"실제 회귀선\", \"추정 회귀선\"), col = c(\"blue\", \"red\"), lwd = 2)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n결과는 다음과 같이 나온다.\n\n### d\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncnt <- 0\nfor (i in 1:100) \n{\n  x <- runif(100, 0, 10)\n  error <- rnorm(100, 0, 4)\n  y <- 3 * x - 2 + error\n  model <- lm(y ~ x)\n  trust <- confint(model, level=0.95)[2, ]\n  cnt <- cnt + (3 > trust[1] && 3 < trust[2])\n}\ncnt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 94\n```\n\n\n:::\n:::\n\n\n\n\n95에 가깝게 나온다.\n\n## Multiple Linear Regression\n\n### a\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(iris)\nmodel <- lm(Sepal.Width ~ Sepal.Length + Petal.Length + Petal.Width, data = iris)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Sepal.Width ~ Sepal.Length + Petal.Length + Petal.Width, \n    data = iris)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.88045 -0.20945  0.01426  0.17942  0.78125 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   1.04309    0.27058   3.855 0.000173 ***\nSepal.Length  0.60707    0.06217   9.765  < 2e-16 ***\nPetal.Length -0.58603    0.06214  -9.431  < 2e-16 ***\nPetal.Width   0.55803    0.12256   4.553  1.1e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3038 on 146 degrees of freedom\nMultiple R-squared:  0.524,\tAdjusted R-squared:  0.5142 \nF-statistic: 53.58 on 3 and 146 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\nF 값의 p-value가 매우 작으므로, 모델이 통계적으로 유의미하다고 할 수 있다.\n\n각각의 독립변수에 대한 p-value 역시 모두 매우 작으므로, 종속변수에 통계적으로 유의미한 영향을 미친다고 할 수 있다.\n\n하지만 r-squared 값이 크지 않아서 모델이 종속변수의 변동을 잘 설명하지 못한다고 할 수 있다.\n\n### b\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(model, 1)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n잔차가 U자 패턴을 보이므로, 선형성이 만족되지 않는 것 같다.\n\n### c\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- lm(Sepal.Width ~ Sepal.Length + I(Sepal.Length^2) + Petal.Length + I(Petal.Length^2) + Petal.Width + I(Petal.Width^2), data = iris)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Sepal.Width ~ Sepal.Length + I(Sepal.Length^2) + \n    Petal.Length + I(Petal.Length^2) + Petal.Width + I(Petal.Width^2), \n    data = iris)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.82277 -0.16843 -0.00315  0.15300  0.77761 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       -3.10783    1.37460  -2.261 0.025275 *  \nSepal.Length       2.32243    0.50141   4.632 8.08e-06 ***\nI(Sepal.Length^2) -0.15699    0.04264  -3.682 0.000327 ***\nPetal.Length      -0.89155    0.20300  -4.392 2.17e-05 ***\nI(Petal.Length^2)  0.06925    0.02336   2.965 0.003549 ** \nPetal.Width       -0.03666    0.38214  -0.096 0.923708    \nI(Petal.Width^2)   0.13095    0.10529   1.244 0.215648    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2755 on 143 degrees of freedom\nMultiple R-squared:  0.6167,\tAdjusted R-squared:  0.6006 \nF-statistic: 38.35 on 6 and 143 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\n### d\n\nSepal.Length, $\\text{Sepal.Length}^2$, Petal.Length의 p-value가 모두 0.05보다 작으므로, 이 변수들이 종속변수에 통계적으로 유의미한 영향을 미친다고 할 수 있다.\n\nr-squared 값도 더 작아져서, c 모델이 b 모델보다 종속변수의 변동을 잘 설명한다고 할 수 있다.\n\n### e\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(model2, 1)\n```\n\n::: {.cell-output-display}\n![](06_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n\nU자 패턴이 완만해진걸로 보인다.\n",
    "supporting": [
      "06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "65cfadcd1d8c3ea165966484e18b96d2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"단순 미래 예측\"\ndate: 2025-07-09\ncategories: [\"확률 통계\", \"시계열 분석\"]\n---\n\n\n\n\n![](/img/stat-thumb.jpg){.post-thumbnail}\n\n## 베이스라인 모델 정의\n\n- 단순예측법: 최근의 자료가 미래에 대한 최선의 추정치 $\\hat{p_{t+1}} = p_t$\n- 추세분석: 전기와 현기 사이의 추세를 다음 기의 판매예측에 반영하는 방법. $\\hat{p_{t+1}} = p_t + p_t - p_{t-1}$\n- 단순 이동평균법: time window를 계속 이동하면서 평균 구하는거\n    - time window ↑: 먼 과거까지 보겠다\n- 가중 이동평균법: 가중치를 다르게 부여\n\n### all 평균 (추세)\n\n::: {#a4517d80 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.rcParams['font.family'] = 'Noto Sans KR'\ndf = pd.read_csv('_data/jj.csv')\n\ntrain = df[:-4]\ntest = df[-4:]\n\nhistorical_mean = np.mean(train['data'])\nhistorical_mean\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nnp.float64(4.308499987499999)\n```\n:::\n:::\n\n\n::: {#bed4a4ef .cell execution_count=2}\n``` {.python .cell-code}\ntest['pred_mean'] = historical_mean\n```\n:::\n\n\n::: {#cb49ac08 .cell execution_count=3}\n``` {.python .cell-code}\ndef mape(y_true, y_pred):\n    return np.mean(np.abs(y_true - y_pred) / y_true) * 100\n\nmape_hist_mean = mape(test['data'], test['pred_mean'])\nmape_hist_mean\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\nnp.float64(70.00752579965119)\n```\n:::\n:::\n\n\n::: {#4ea9426a .cell execution_count=4}\n``` {.python .cell-code}\nsns.lineplot(data=train, x='date', y='data', label='훈련')\nsns.lineplot(data=test, x='date', y='data', label='테스트')\nsns.lineplot(data=test, x='date', y='pred_mean', label='단순 예측')\nplt.xticks(np.arange(0, 85, 8), np.arange(1960, 1981, 2))\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n([<matplotlib.axis.XTick at 0x7a338eb948c0>,\n  <matplotlib.axis.XTick at 0x7a338eb94860>,\n  <matplotlib.axis.XTick at 0x7a338eb49850>,\n  <matplotlib.axis.XTick at 0x7a338ebc9550>,\n  <matplotlib.axis.XTick at 0x7a338ebc9ee0>,\n  <matplotlib.axis.XTick at 0x7a338ebc9940>,\n  <matplotlib.axis.XTick at 0x7a338ebcac30>,\n  <matplotlib.axis.XTick at 0x7a338ebcb5f0>,\n  <matplotlib.axis.XTick at 0x7a338ebcbec0>,\n  <matplotlib.axis.XTick at 0x7a338ebf88f0>,\n  <matplotlib.axis.XTick at 0x7a338ebcb2c0>],\n [Text(0, 0, '1960'),\n  Text(8, 0, '1962'),\n  Text(16, 0, '1964'),\n  Text(24, 0, '1966'),\n  Text(32, 0, '1968'),\n  Text(40, 0, '1970'),\n  Text(48, 0, '1972'),\n  Text(56, 0, '1974'),\n  Text(64, 0, '1976'),\n  Text(72, 0, '1978'),\n  Text(80, 0, '1980')])\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](01_files/figure-html/cell-5-output-2.png){width=583 height=430}\n:::\n:::\n\n\n### 최근만 평균 (추세)\n\n::: {#8e3ab9ff .cell execution_count=5}\n``` {.python .cell-code}\nlast_year_mean = np.mean(train.iloc[-4:]['data'])\ntest['pred_last_yr_mean'] = last_year_mean\nmape_last_year_mean = mape(test['data'], test['pred_last_yr_mean'])\nmape_last_year_mean\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nnp.float64(15.5963680725103)\n```\n:::\n:::\n\n\n::: {#6a117ce7 .cell execution_count=6}\n``` {.python .cell-code}\nsns.lineplot(data=train, x='date', y='data', label='훈련')\nsns.lineplot(data=test, x='date', y='data', label='테스트')\nsns.lineplot(data=test, x='date', y='pred_last_yr_mean', label='최근 예측')\nplt.xticks(np.arange(0, 85, 8), np.arange(1960, 1981, 2))\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n([<matplotlib.axis.XTick at 0x7a338ebfa4b0>,\n  <matplotlib.axis.XTick at 0x7a338eae7860>,\n  <matplotlib.axis.XTick at 0x7a338ea21730>,\n  <matplotlib.axis.XTick at 0x7a338c92dbe0>,\n  <matplotlib.axis.XTick at 0x7a338c96a390>,\n  <matplotlib.axis.XTick at 0x7a338c96acf0>,\n  <matplotlib.axis.XTick at 0x7a338c96af60>,\n  <matplotlib.axis.XTick at 0x7a338c96b920>,\n  <matplotlib.axis.XTick at 0x7a338c988350>,\n  <matplotlib.axis.XTick at 0x7a338c988d10>,\n  <matplotlib.axis.XTick at 0x7a338c9896d0>],\n [Text(0, 0, '1960'),\n  Text(8, 0, '1962'),\n  Text(16, 0, '1964'),\n  Text(24, 0, '1966'),\n  Text(32, 0, '1968'),\n  Text(40, 0, '1970'),\n  Text(48, 0, '1972'),\n  Text(56, 0, '1974'),\n  Text(64, 0, '1976'),\n  Text(72, 0, '1978'),\n  Text(80, 0, '1980')])\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](01_files/figure-html/cell-7-output-2.png){width=583 height=430}\n:::\n:::\n\n\n### 단순 예측법\n\n::: {#6ea6b6f1 .cell execution_count=7}\n``` {.python .cell-code}\nlast = train.iloc[-1]['data']\ntest['pred_last'] = last\nmape_last = mape(test['data'], test['pred_last'])\nmape_last\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nnp.float64(30.457277908606535)\n```\n:::\n:::\n\n\n::: {#0e0f86bd .cell execution_count=8}\n``` {.python .cell-code}\nsns.lineplot(data=train, x='date', y='data', label='훈련')\nsns.lineplot(data=test, x='date', y='data', label='테스트')\nsns.lineplot(data=test, x='date', y='pred_last', label='단순 예측')\nplt.xticks(np.arange(0, 85, 8), np.arange(1960, 1981, 2))\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n([<matplotlib.axis.XTick at 0x7a338ea22180>,\n  <matplotlib.axis.XTick at 0x7a338eafc770>,\n  <matplotlib.axis.XTick at 0x7a338ea59c40>,\n  <matplotlib.axis.XTick at 0x7a338c895be0>,\n  <matplotlib.axis.XTick at 0x7a338c8f6150>,\n  <matplotlib.axis.XTick at 0x7a338c8f6ab0>,\n  <matplotlib.axis.XTick at 0x7a338c8f7440>,\n  <matplotlib.axis.XTick at 0x7a338c8f7d70>,\n  <matplotlib.axis.XTick at 0x7a338c8f6db0>,\n  <matplotlib.axis.XTick at 0x7a338c724500>,\n  <matplotlib.axis.XTick at 0x7a338c8f7170>],\n [Text(0, 0, '1960'),\n  Text(8, 0, '1962'),\n  Text(16, 0, '1964'),\n  Text(24, 0, '1966'),\n  Text(32, 0, '1968'),\n  Text(40, 0, '1970'),\n  Text(48, 0, '1972'),\n  Text(56, 0, '1974'),\n  Text(64, 0, '1976'),\n  Text(72, 0, '1978'),\n  Text(80, 0, '1980')])\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](01_files/figure-html/cell-9-output-2.png){width=583 height=430}\n:::\n:::\n\n\n### 계절적 예측\n\n::: {#e8e608bf .cell execution_count=9}\n``` {.python .cell-code}\ntest['pred_last_season'] = train.iloc[-4:]['data'].values\nmape_naive_seasonal = mape(test['data'], test['pred_last_season'])\nmape_naive_seasonal\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\nnp.float64(11.561658552433654)\n```\n:::\n:::\n\n\n",
    "supporting": [
      "01_files"
    ],
    "filters": [],
    "includes": {}
  }
}
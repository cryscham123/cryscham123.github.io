{
  "hash": "55d5d92e44bb19f6d21ddae6b2094fc1",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"베이즈 정리\"\ndate: 2025-06-19\ncategories: [\"확률 통계\"]\n---\n\n\n\n\n![](/img/stat-thumb.jpg){.post-thumbnail}\n\n## 이론\n\n사전확률을 이용해서 사후확률을 구하는 과정을 베이즈 갱신이라고 한다.\n\n$P(H|D) = \\frac{P(D|H)P(H)}{P(D)}$\n\n- $P(H)$: 가설의 확률. 사전확률\n- $P(H|D)$: 데이터가 주어졌을 때 가설의 확률. 사후확률\n- $P(D|H)$: 가설하에서 데이터가 나올 확률. 가능도(우도)\n- $P(D)$: 데이터의 확률. $P(D) = \\sum P(H_i)P(D|H_i)$\n\n가설은 상호 배제와 전체 포괄 가정이 필요하다.  \n즉, 가설은 서로 배타적이어야 하고, 모든 가능한 가설을 포함해야 한다.\n\n## 베이즈 테이블\n\n1. 가설과 데이터를 정리한다.\n1. 사전확률을 구한다.\n1. 각 가설 하에서의 데이터 가능도를 구한다.\n1. 베이즈 테이블을 정리한다.\n\n### 쿠키 문제\n\n- 그릇 1에서 바닐라 쿠키를 집을 확률은 3/4\n- 그릇 2에서 바닐라 쿠키를 집을 확률은 1/2\n- 바닐라 쿠키를 집었을 때, 그릇 i에서 집었을 확률은?\n\n::: {#c15e790e .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n\ntable = pd.DataFrame(index=['bowl1', 'bowl2'])\ntable['prior'] = 1/2, 1/2\ntable['likelihood'] = 3/4, 1/2\ntable['unnorm'] = table['prior'] * table['likelihood']\ntable['posterior'] = table['unnorm'] / table['unnorm'].sum()\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>bowl1</th>\n      <td>0.5</td>\n      <td>0.75</td>\n      <td>0.375</td>\n      <td>0.6</td>\n    </tr>\n    <tr>\n      <th>bowl2</th>\n      <td>0.5</td>\n      <td>0.50</td>\n      <td>0.250</td>\n      <td>0.4</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 주사위 문제\n\n- 육면체, 팔면체, 십이면체 주사위가 든 상자가 있다.\n- 이 중 임의로 하나를 집어 굴렸더니 1이 나왔다.\n- 이 주사위가 육면체일 확률은?\n\n::: {#b7ea958a .cell execution_count=2}\n``` {.python .cell-code}\ndef update(table):\n  table['unnorm'] = table['prior'] * table['likelihood']\n  prob_data = table['unnorm'].sum()\n  table['posterior'] = table['unnorm'] / prob_data\n  return prob_data\n\nfrom fractions import Fraction\n\ntable2 = pd.DataFrame(index=[6, 8, 12])\ntable2['prior'] = Fraction(1, 3)\ntable2['likelihood'] = Fraction(1, 6), Fraction(1, 8), Fraction(1, 12)\nprob_data = update(table2)\ntable2\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>6</th>\n      <td>1/3</td>\n      <td>1/6</td>\n      <td>1/18</td>\n      <td>4/9</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>1/3</td>\n      <td>1/8</td>\n      <td>1/24</td>\n      <td>1/3</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>1/3</td>\n      <td>1/12</td>\n      <td>1/36</td>\n      <td>2/9</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 몬티홀 문제\n\n- 1,2,3 번호가 붙은 세 개의 문 중 하나에 상품이 있다.\n- 참가자는 문 하나를 선택하고, 사회자는 나머지 두 문 중 상품이 없는 문을 열어 보여준다.\n- 참가자는 처음 선택한 문을 유지하거나 다른 문으로 바꿀 수 있다.\n- 당신은 1번 문을 선택했고, 사회자는 문 3을 열었다.\n- 다시 참가자가 문을 선택했을 때 상품이 있는 문을 선택할 확률은?\n\n::: {#a105b182 .cell execution_count=3}\n``` {.python .cell-code}\ntable3 = pd.DataFrame(index=[1, 2, 3])\ntable3['prior'] = Fraction(1, 3)\ntable3['likelihood'] = Fraction(1, 2), 1, 0\nprob_data = update(table3)\ntable3\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>1/3</td>\n      <td>1/2</td>\n      <td>1/6</td>\n      <td>1/3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1/3</td>\n      <td>1</td>\n      <td>1/3</td>\n      <td>2/3</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1/3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 연습문제\n\n### 2-1\n\n::: {#73dcefd2 .cell execution_count=4}\n``` {.python .cell-code}\ntable = pd.DataFrame(index=['normal', 'weird'])\ntable['prior'] = Fraction(1, 2)\ntable['likelihood'] = Fraction(1, 2), 1\nprob_data = update(table)\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>normal</th>\n      <td>1/2</td>\n      <td>1/2</td>\n      <td>1/4</td>\n      <td>1/3</td>\n    </tr>\n    <tr>\n      <th>weird</th>\n      <td>1/2</td>\n      <td>1</td>\n      <td>1/2</td>\n      <td>2/3</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 2-2\n\n::: {#5954e7b7 .cell execution_count=5}\n``` {.python .cell-code}\ntable = pd.DataFrame(index=['bb', 'bg', 'gb', 'gg'])\ntable['prior'] = Fraction(1, 4)\ntable['likelihood'] = 0, 1, 1, 1\nprob_data = update(table)\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>bb</th>\n      <td>1/4</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>bg</th>\n      <td>1/4</td>\n      <td>1</td>\n      <td>1/4</td>\n      <td>1/3</td>\n    </tr>\n    <tr>\n      <th>gb</th>\n      <td>1/4</td>\n      <td>1</td>\n      <td>1/4</td>\n      <td>1/3</td>\n    </tr>\n    <tr>\n      <th>gg</th>\n      <td>1/4</td>\n      <td>1</td>\n      <td>1/4</td>\n      <td>1/3</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 2-3\n\n::: {#c897d1b1 .cell execution_count=6}\n``` {.python .cell-code}\ntable = pd.DataFrame(index=[1, 2, 3])\ntable['prior'] = Fraction(1, 3)\ntable['likelihood'] = 1, 0, 1\nprob_data = update(table)\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>1/3</td>\n      <td>1</td>\n      <td>1/3</td>\n      <td>1/2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1/3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1/3</td>\n      <td>1</td>\n      <td>1/3</td>\n      <td>1/2</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5abc32f0 .cell execution_count=7}\n``` {.python .cell-code}\ntable = pd.DataFrame(index=[1, 2, 3])\ntable['prior'] = Fraction(1, 3)\ntable['likelihood'] = 0, 1, 0\nprob_data = update(table)\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1</th>\n      <td>1/3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1/3</td>\n      <td>1</td>\n      <td>1/3</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1/3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 2-4\n\n::: {#f9889b79 .cell execution_count=8}\n``` {.python .cell-code}\ntable = pd.DataFrame(index=['1994_1996', '1996_1994'])\ntable['prior'] = Fraction(1, 2)\ntable['likelihood'] = Fraction(2, 10) * Fraction(2, 10), Fraction(14, 100) * Fraction(1, 10)\nprob_data = update(table)\ntable\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>prior</th>\n      <th>likelihood</th>\n      <th>unnorm</th>\n      <th>posterior</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1994_1996</th>\n      <td>1/2</td>\n      <td>1/25</td>\n      <td>1/50</td>\n      <td>20/27</td>\n    </tr>\n    <tr>\n      <th>1996_1994</th>\n      <td>1/2</td>\n      <td>7/500</td>\n      <td>7/1000</td>\n      <td>7/27</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "01_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
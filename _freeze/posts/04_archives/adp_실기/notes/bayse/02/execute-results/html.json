{
  "hash": "435c7b40fab8f7f9fd815ec43ccf19e2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"분포\"\ndate: 2025-06-19\ncategories: [\"확률 통계\"]\n---\n\n\n\n\n![](/img/stat-thumb.jpg){.post-thumbnail}\n\n## Pmf를 이용한 확률\n\n### 쿠키 문제\n\n::: {#fff69004 .cell execution_count=1}\n``` {.python .cell-code}\nfrom empiricaldist import Pmf\nimport pandas as pd\n\nprior = Pmf.from_seq(['Bowl 1', 'Bowl 2'])\nlikelihood_vanilla = [0.75, 0.5]\nposterior = prior * likelihood_vanilla\nposterior.normalize()\nposterior\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Bowl 1</th>\n      <td>0.6</td>\n    </tr>\n    <tr>\n      <th>Bowl 2</th>\n      <td>0.4</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n- 만약 같은 그릇에서 한 번 더 쿠키를 꺼냈을 때 바닐라일 경우\n\n::: {#ca053e32 .cell execution_count=2}\n``` {.python .cell-code}\nposterior *= likelihood_vanilla\nposterior.normalize()\nposterior\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Bowl 1</th>\n      <td>0.692308</td>\n    </tr>\n    <tr>\n      <th>Bowl 2</th>\n      <td>0.307692</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n- 만약 같은 그릇에서 한 번 더 쿠키를 꺼냈을 때 초코쿠키일 경우\n\n::: {#860380c6 .cell execution_count=3}\n``` {.python .cell-code}\nlikelihood_chocolate = [0.25, 0.5]\nposterior *= likelihood_chocolate\nposterior.normalize()\nposterior\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Bowl 1</th>\n      <td>0.529412</td>\n    </tr>\n    <tr>\n      <th>Bowl 2</th>\n      <td>0.470588</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 101개의 쿠키 그릇\n\n- 그릇 i에는 바닐라 쿠키가 i% 있다.\n- 임의의 그릇을 골라 쿠키를 임의로 꺼냈을 때, 바닐라 쿠키라면 그릇 x에서 쿠키가 나왔을 확률은 얼마일까?\n\n::: {#fc18e2c3 .cell execution_count=4}\n``` {.python .cell-code}\nimport numpy as np\n\nhypos = np.arange(101)\nprior = Pmf(1, hypos)\nprior.normalize()\nprior\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>0.009901</td>\n    </tr>\n    <tr>\n      <th>100</th>\n      <td>0.009901</td>\n    </tr>\n  </tbody>\n</table>\n<p>101 rows × 1 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#a6e2c581 .cell execution_count=5}\n``` {.python .cell-code}\nlikelihood_vanilla = hypos / 100\nposterior1 = prior * likelihood_vanilla\nposterior1.normalize()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nnp.float64(0.5000000000000001)\n```\n:::\n:::\n\n\n::: {#7bd5e8ca .cell execution_count=6}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n\nplt.rcParams['font.family'] = 'Noto Sans KR'\nprior.plot(label='prior', color='C5')\nposterior1.plot(label='posterior', color='C4')\nplt.legend()\nplt.xlabel('그릇 번호')\nplt.ylabel('PMF')\nplt.title('바닐라 쿠키 하나 뽑은 후')\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\nText(0.5, 1.0, '바닐라 쿠키 하나 뽑은 후')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](02_files/figure-html/cell-7-output-2.png){width=609 height=451}\n:::\n:::\n\n\n- 한 번 더 뽑았을 때 바닐라 쿠키인 경우\n\n::: {#d2357f2e .cell execution_count=7}\n``` {.python .cell-code}\nposterior2 = posterior1 * likelihood_vanilla\nposterior2.normalize()\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nnp.float64(0.6699999999999999)\n```\n:::\n:::\n\n\n::: {#e2497b00 .cell execution_count=8}\n``` {.python .cell-code}\nposterior2.plot(label='posterior', color='C4')\nplt.xlabel('그릇 번호')\nplt.ylabel('PMF')\nplt.title('바닐라 쿠키 두 번 뽑은 후')\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nText(0.5, 1.0, '바닐라 쿠키 두 번 뽑은 후')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](02_files/figure-html/cell-9-output-2.png){width=601 height=451}\n:::\n:::\n\n\n- 한 번 더 뽑았는데 초코 쿠키인 경우\n\n::: {#27504a16 .cell execution_count=9}\n``` {.python .cell-code}\nlikelihood_chocolate = 1 - hypos / 100\nposterior3 = posterior2 * likelihood_chocolate\nposterior3.normalize()\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\nnp.float64(0.2462686567164179)\n```\n:::\n:::\n\n\n::: {#be69b79f .cell execution_count=10}\n``` {.python .cell-code}\nposterior3.plot(label='posterior', color='C4')\nplt.xlabel('그릇 번호')\nplt.ylabel('PMF')\nplt.title('바닐라 쿠키 두 번 뽑고 초코 쿠키 하나 뽑은 후')\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nText(0.5, 1.0, '바닐라 쿠키 두 번 뽑고 초코 쿠키 하나 뽑은 후')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](02_files/figure-html/cell-11-output-2.png){width=609 height=451}\n:::\n:::\n\n\n::: {#e6d23d59 .cell execution_count=11}\n``` {.python .cell-code}\nposterior3.max_prob()\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nnp.int64(67)\n```\n:::\n:::\n\n\n- MAP: 사후확률 분포에서 가장 큰 확률값\n\n### 주사위 문제\n\n::: {#db3147b2 .cell execution_count=12}\n``` {.python .cell-code}\ndef update_dice(pmf, data):\n  hypos = pmf.qs\n  likelihood = 1 / hypos\n  likelihood[data > hypos] = 0\n  pmf *= likelihood\n  pmf.normalize()\n```\n:::\n\n\n- 주사위를 굴려서 1이 나왔다.\n\n::: {#4849dda7 .cell execution_count=13}\n``` {.python .cell-code}\nhypos = [6, 8, 12]\npmf = Pmf(1/3, hypos)\nupdate_dice(pmf, 1)\npmf\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>6</th>\n      <td>0.444444</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>0.333333</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>0.222222</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n- 주사위를 한번 더 굴렸는데 7이 나왔다.\n\n::: {#c992d1a9 .cell execution_count=14}\n``` {.python .cell-code}\nupdate_dice(pmf, 7)\npmf\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>6</th>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>0.692308</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>0.307692</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 연습문제\n\n### 3-1\n\n::: {#263aef7a .cell execution_count=15}\n``` {.python .cell-code}\nhypos = [6, 8, 12]\npmf = Pmf(1/3, hypos)\nupdate_dice(pmf, 1)\nupdate_dice(pmf, 3)\nupdate_dice(pmf, 5)\nupdate_dice(pmf, 7)\npmf\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>6</th>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>0.835052</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>0.164948</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 3-2\n\n::: {#7750ada9 .cell execution_count=16}\n``` {.python .cell-code}\nhypos = [4, 6, 8, 12, 20]\npmf = Pmf([1/15, 2/15, 3/15, 4/15, 5/15], hypos)\nupdate_dice(pmf, 7)\npmf\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>4</th>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>0.391304</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>0.347826</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>0.260870</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 3-3\n\n::: {#1269b62d .cell execution_count=17}\n``` {.python .cell-code}\npmf = Pmf.from_seq(['서랍 1', '서랍 2'])\nlikelihood = [1/2, 1/9]\nposterior = pmf * likelihood\nposterior.normalize()\nposterior\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>probs</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>서랍 1</th>\n      <td>0.818182</td>\n    </tr>\n    <tr>\n      <th>서랍 2</th>\n      <td>0.181818</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "02_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
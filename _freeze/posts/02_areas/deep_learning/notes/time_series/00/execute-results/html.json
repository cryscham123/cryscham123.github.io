{
  "hash": "f08bea7f35c28f93013ea8dd894939cc",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"overview\"\ndate: 2025-12-18\ncategories: [\"deep learning\"]\n---\n\n\n\n\n![](/img/stat-thumb.jpg){.post-thumbnail}\n\n## 모델\n\n- 단일 단계 모델: 한 대상에 대한 한 시간 단계 예측\n- 다중 단계 모델: 한 대상에 대한 여러 시간 단계 예측을 생성\n- 다중 출력 모델: 여러 대상에 대한 여러 시간 단계 예측을 생성\n\n## Example\n\n::: {#5b5b7c2b .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\ndf = pd.read_csv(\"data/traffic.csv\")\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date_time</th>\n      <th>temp</th>\n      <th>rain_1h</th>\n      <th>snow_1h</th>\n      <th>clouds_all</th>\n      <th>traffic_volume</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2016-09-29 17:00:00</td>\n      <td>291.75</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>5551.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2016-09-29 18:00:00</td>\n      <td>290.36</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>4132.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2016-09-29 19:00:00</td>\n      <td>287.86</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3435.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2016-09-29 20:00:00</td>\n      <td>285.91</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2765.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2016-09-29 21:00:00</td>\n      <td>284.31</td>\n      <td>0.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2443.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#b25d14c2 .cell execution_count=2}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots()\n\nax.plot(df['traffic_volume'])\nax.set_xlabel('Time')\nax.set_ylabel('Traffic Volume')\n\nplt.xticks(np.arange(7, 400, 24), ['Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'])\nplt.xlim(0, 400)\nfig.autofmt_xdate()\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](00_files/figure-html/cell-3-output-1.png){width=662 height=470}\n:::\n:::\n\n\n- 일별 계절성: 하루의 시작과 긑에 교통량이 적음\n- 주간 계절성: 주말에 교통량이 적음\n- SARIMAX는 이러한 계절성이 여러개 있는 시계열 데이터를 모델링하는데 적합하지 않음\n\n::: {#9392cc10 .cell execution_count=3}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\n\nax.plot(df['temp'])\nax.set_xlabel('Time')\nax.set_ylabel('Temperature (K)')\n\nplt.xticks([2239, 10999], [2017, 2018])\n\nfig.autofmt_xdate()\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](00_files/figure-html/cell-4-output-1.png){width=662 height=470}\n:::\n:::\n\n\n- 기온 역시 연간 계절성을 가지고,\n\n::: {#6b1f3b0c .cell execution_count=4}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\n\nax.plot(df['temp'])\nax.set_xlabel('Time')\nax.set_ylabel('Temperature (K)')\n\nplt.xticks(np.arange(7, 400, 24), ['Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'])\nplt.xlim(0, 400)\nfig.autofmt_xdate()\nplt.tight_layout()\n```\n\n::: {.cell-output .cell-output-display}\n![](00_files/figure-html/cell-5-output-1.png){width=662 height=470}\n:::\n:::\n\n\n- 일별 계절성도 가지고 있다.\n\n::: {#64880a8b .cell execution_count=5}\n``` {.python .cell-code}\ndf.describe().transpose()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>count</th>\n      <th>mean</th>\n      <th>std</th>\n      <th>min</th>\n      <th>25%</th>\n      <th>50%</th>\n      <th>75%</th>\n      <th>max</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>temp</th>\n      <td>17551.0</td>\n      <td>281.416203</td>\n      <td>12.688262</td>\n      <td>243.39</td>\n      <td>272.22</td>\n      <td>282.41</td>\n      <td>291.89</td>\n      <td>310.07</td>\n    </tr>\n    <tr>\n      <th>rain_1h</th>\n      <td>17551.0</td>\n      <td>0.025523</td>\n      <td>0.259794</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>10.60</td>\n    </tr>\n    <tr>\n      <th>snow_1h</th>\n      <td>17551.0</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>0.00</td>\n    </tr>\n    <tr>\n      <th>clouds_all</th>\n      <td>17551.0</td>\n      <td>42.034129</td>\n      <td>39.065960</td>\n      <td>0.00</td>\n      <td>1.00</td>\n      <td>40.00</td>\n      <td>90.00</td>\n      <td>100.00</td>\n    </tr>\n    <tr>\n      <th>traffic_volume</th>\n      <td>17551.0</td>\n      <td>3321.484588</td>\n      <td>1969.223949</td>\n      <td>113.00</td>\n      <td>1298.00</td>\n      <td>3518.00</td>\n      <td>4943.00</td>\n      <td>7280.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n- 정보가 없는 강수량, 강설량은 제거\n\n::: {#a9e86ef1 .cell execution_count=6}\n``` {.python .cell-code}\nfrom datetime import datetime\n\ndf = df.drop(['rain_1h', 'snow_1h'], axis=1)\ndf['date_time'] = pd.to_datetime(df['date_time']).map(datetime.timestamp)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date_time</th>\n      <th>temp</th>\n      <th>clouds_all</th>\n      <th>traffic_volume</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1.475136e+09</td>\n      <td>291.75</td>\n      <td>0</td>\n      <td>5551.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.475140e+09</td>\n      <td>290.36</td>\n      <td>0</td>\n      <td>4132.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1.475143e+09</td>\n      <td>287.86</td>\n      <td>0</td>\n      <td>3435.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.475147e+09</td>\n      <td>285.91</td>\n      <td>0</td>\n      <td>2765.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.475150e+09</td>\n      <td>284.31</td>\n      <td>0</td>\n      <td>2443.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>17546</th>\n      <td>1.538302e+09</td>\n      <td>283.45</td>\n      <td>75</td>\n      <td>3543.0</td>\n    </tr>\n    <tr>\n      <th>17547</th>\n      <td>1.538305e+09</td>\n      <td>282.76</td>\n      <td>90</td>\n      <td>2781.0</td>\n    </tr>\n    <tr>\n      <th>17548</th>\n      <td>1.538309e+09</td>\n      <td>282.73</td>\n      <td>90</td>\n      <td>2159.0</td>\n    </tr>\n    <tr>\n      <th>17549</th>\n      <td>1.538312e+09</td>\n      <td>282.09</td>\n      <td>90</td>\n      <td>1450.0</td>\n    </tr>\n    <tr>\n      <th>17550</th>\n      <td>1.538316e+09</td>\n      <td>282.12</td>\n      <td>90</td>\n      <td>954.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>17551 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n- 시간을 초 단위로 변환.\n\n::: {#4888aade .cell execution_count=7}\n``` {.python .cell-code}\nday = 24 * 60 * 60\ndf['day_sin'] = np.sin(df['date_time'] * (2 * np.pi / day))\ndf['day_cos'] = np.cos(df['date_time'] * (2 * np.pi / day))\ndf = df.drop(['date_time'], axis=1)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>temp</th>\n      <th>clouds_all</th>\n      <th>traffic_volume</th>\n      <th>day_sin</th>\n      <th>day_cos</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>291.75</td>\n      <td>0</td>\n      <td>5551.0</td>\n      <td>8.660254e-01</td>\n      <td>-0.500000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>290.36</td>\n      <td>0</td>\n      <td>4132.0</td>\n      <td>7.071068e-01</td>\n      <td>-0.707107</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>287.86</td>\n      <td>0</td>\n      <td>3435.0</td>\n      <td>5.000000e-01</td>\n      <td>-0.866025</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>285.91</td>\n      <td>0</td>\n      <td>2765.0</td>\n      <td>2.588190e-01</td>\n      <td>-0.965926</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>284.31</td>\n      <td>0</td>\n      <td>2443.0</td>\n      <td>1.485292e-12</td>\n      <td>-1.000000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>17546</th>\n      <td>283.45</td>\n      <td>75</td>\n      <td>3543.0</td>\n      <td>5.000000e-01</td>\n      <td>-0.866025</td>\n    </tr>\n    <tr>\n      <th>17547</th>\n      <td>282.76</td>\n      <td>90</td>\n      <td>2781.0</td>\n      <td>2.588190e-01</td>\n      <td>-0.965926</td>\n    </tr>\n    <tr>\n      <th>17548</th>\n      <td>282.73</td>\n      <td>90</td>\n      <td>2159.0</td>\n      <td>2.467248e-12</td>\n      <td>-1.000000</td>\n    </tr>\n    <tr>\n      <th>17549</th>\n      <td>282.09</td>\n      <td>90</td>\n      <td>1450.0</td>\n      <td>-2.588190e-01</td>\n      <td>-0.965926</td>\n    </tr>\n    <tr>\n      <th>17550</th>\n      <td>282.12</td>\n      <td>90</td>\n      <td>954.0</td>\n      <td>-5.000000e-01</td>\n      <td>-0.866025</td>\n    </tr>\n  </tbody>\n</table>\n<p>17551 rows × 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n- 단순 초 단위 변환은 주기적 패턴을 포착하지 못하기 때문에 사인 및 코사인 변환을 사용하여 일별 주기를 인코딩\n\n::: {#231431b1 .cell execution_count=8}\n``` {.python .cell-code}\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler\n\ntrain, test = train_test_split(df, test_size=0.1, shuffle=False)\ntrain, val = train_test_split(train, test_size=0.2, shuffle=False)\n\nscaler = MinMaxScaler()\ntrain_scaled = scaler.fit_transform(train)\nval_scaled = scaler.transform(val)\ntest_scaled = scaler.transform(test)\n```\n:::\n\n\n::: {#f1374a94 .cell execution_count=9}\n``` {.python .cell-code}\ntrain.to_csv(\"data/traffic_train.csv\", index=False)\nval.to_csv(\"data/traffic_val.csv\", index=False)\ntest.to_csv(\"data/traffic_test.csv\", index=False)\n```\n:::\n\n\n",
    "supporting": [
      "00_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
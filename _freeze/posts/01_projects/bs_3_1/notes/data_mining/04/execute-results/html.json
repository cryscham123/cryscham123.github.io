{
  "hash": "b61d4cb06ffd8d0e9058066a4cd33c5b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"pandas\"\ndate: 2025-03-19\ncategories: [\"data mining\"]\n---\n\n\n\n\n![](/img/human-thumb.jpg){.post-thumbnail}\n\n::: {#a4784658 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\n\ndata = {\n    'name': ['John', 'Anna', 'Peter', 'Linda'],\n    'location': ['New York', 'Paris', 'Berlin', 'London'],\n    'age': [24, 13, 53, 33]\n}\ndf = pd.DataFrame(data)\n```\n:::\n\n\n::: {#f6729016 .cell execution_count=2}\n``` {.python .cell-code}\ndf.loc[(df['age'] > 20) & (df['age'] < 50), 'location']\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n0    New York\n3      London\nName: location, dtype: object\n```\n:::\n:::\n\n\n::: {#f37b3fda .cell execution_count=3}\n``` {.python .cell-code}\ndf = pd.DataFrame(np.random.randn(6, 4))\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.868450</td>\n      <td>-0.164946</td>\n      <td>0.917664</td>\n      <td>-1.945286</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.766692</td>\n      <td>0.123853</td>\n      <td>0.487815</td>\n      <td>-0.161050</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#7ea61d8a .cell execution_count=4}\n``` {.python .cell-code}\ndf.columns = ['A', 'B', 'C', 'D']\ndf.index = pd.date_range('20250101', periods=6)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-01</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n    </tr>\n    <tr>\n      <th>2025-01-02</th>\n      <td>0.868450</td>\n      <td>-0.164946</td>\n      <td>0.917664</td>\n      <td>-1.945286</td>\n    </tr>\n    <tr>\n      <th>2025-01-03</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n    </tr>\n    <tr>\n      <th>2025-01-04</th>\n      <td>0.766692</td>\n      <td>0.123853</td>\n      <td>0.487815</td>\n      <td>-0.161050</td>\n    </tr>\n    <tr>\n      <th>2025-01-05</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n    </tr>\n    <tr>\n      <th>2025-01-06</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#56fd0558 .cell execution_count=5}\n``` {.python .cell-code}\ndf['F'] = [1.0, np.nan, 3.5, 6.1, np.nan, 7.0]\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>F</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-01</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>2025-01-02</th>\n      <td>0.868450</td>\n      <td>-0.164946</td>\n      <td>0.917664</td>\n      <td>-1.945286</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2025-01-03</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>2025-01-04</th>\n      <td>0.766692</td>\n      <td>0.123853</td>\n      <td>0.487815</td>\n      <td>-0.161050</td>\n      <td>6.1</td>\n    </tr>\n    <tr>\n      <th>2025-01-05</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2025-01-06</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n      <td>7.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#9e58c3f8 .cell execution_count=6}\n``` {.python .cell-code}\ndf.dropna()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>F</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-01</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>2025-01-03</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>2025-01-04</th>\n      <td>0.766692</td>\n      <td>0.123853</td>\n      <td>0.487815</td>\n      <td>-0.161050</td>\n      <td>6.1</td>\n    </tr>\n    <tr>\n      <th>2025-01-06</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n      <td>7.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#2b02ccf2 .cell execution_count=7}\n``` {.python .cell-code}\ndf.dropna(axis=1, subset=['2025-01-02'])\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-01</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n    </tr>\n    <tr>\n      <th>2025-01-02</th>\n      <td>0.868450</td>\n      <td>-0.164946</td>\n      <td>0.917664</td>\n      <td>-1.945286</td>\n    </tr>\n    <tr>\n      <th>2025-01-03</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n    </tr>\n    <tr>\n      <th>2025-01-04</th>\n      <td>0.766692</td>\n      <td>0.123853</td>\n      <td>0.487815</td>\n      <td>-0.161050</td>\n    </tr>\n    <tr>\n      <th>2025-01-05</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n    </tr>\n    <tr>\n      <th>2025-01-06</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#3369f932 .cell execution_count=8}\n``` {.python .cell-code}\ndf['F'].dropna()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n2025-01-01    1.0\n2025-01-03    3.5\n2025-01-04    6.1\n2025-01-06    7.0\nName: F, dtype: float64\n```\n:::\n:::\n\n\n::: {#93965aeb .cell execution_count=9}\n``` {.python .cell-code}\ndf.loc[df.isnull()['F'], :]\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>F</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-02</th>\n      <td>0.868450</td>\n      <td>-0.164946</td>\n      <td>0.917664</td>\n      <td>-1.945286</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2025-01-05</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#d676baa5 .cell execution_count=10}\n``` {.python .cell-code}\ndf.drop([pd.to_datetime('2025-01-02'), pd.to_datetime('2025-01-04')])\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>F</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2025-01-01</th>\n      <td>1.204059</td>\n      <td>-0.335996</td>\n      <td>-0.818220</td>\n      <td>0.861070</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>2025-01-03</th>\n      <td>0.291923</td>\n      <td>-0.328159</td>\n      <td>1.166051</td>\n      <td>-0.479075</td>\n      <td>3.5</td>\n    </tr>\n    <tr>\n      <th>2025-01-05</th>\n      <td>-1.695214</td>\n      <td>-0.001611</td>\n      <td>-0.631717</td>\n      <td>-0.148206</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2025-01-06</th>\n      <td>-0.354958</td>\n      <td>0.263346</td>\n      <td>-0.822940</td>\n      <td>0.523039</td>\n      <td>7.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "04_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
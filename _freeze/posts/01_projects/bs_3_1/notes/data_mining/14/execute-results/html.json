{
  "hash": "db03a35a4c270cd7cc9ec602f4d5ac02",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"test\"\ndate: 2025-05-07\ncategories: [\"data mining\"]\n---\n\n\n\n\n![](/img/human-thumb.jpg){.post-thumbnail}\n\n## Data Load\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 데이터 로드 및 필요 패키지 불러오기\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\n# CSV 파일 읽기 (row.names=1은 첫 번째 열을 행 이름으로 사용)\ndf_origin <- read.csv('_data/student_1.csv', row.names=1)\n\n# 원본 데이터 복사\ndf <- df_origin\n\n# 필요한 열만 선택\ndf <- df[, c('q48a01','q48a02','q48a03','q48a04','q48a05','q48a06','q48a07',\n              'q48a08','q48a09','q48a10','q48a11','q48a12','q48b1','q48b2',\n              'q48b3','q48c1','q48c2','q48c3','q48c4','q48c5','q48c6','q48c7',\n              'q48c8','q48c9','q48d1','q48d2','q48d3','q48d4','q48d5','q48d6',\n              'q49a01','q49a02','q49a03','q49a04','q49a05','q49a06','q49a07',\n              'q49a08','q49a09','q49a10','q49a11','q49a12','q49a13','q49a14',\n              'q49a15','q49a16','q49a17','q50')]\n```\n:::\n\n\n\n\n## CFA (Confirmatory Factor Analysis)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThis is lavaan 0.6-19\nlavaan is FREE software! Please report any bugs.\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(semPlot)\n\n# 결측치 확인\nsum(is.na(df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# 결측치가 있는 경우 처리 (필요 시)\ndf_clean <- na.omit(df)\n\n# CFA 모델 지정\n# 13개의 잠재 요인을 정의 (위에서 지정한 요인 구조에 맞춰 설정)\n\ncfa_model <- '\n  # 측정 모델 정의\n  # 자아존중감 관련 요인\n  pos_esteem =~ q48a01 + q48a02 + q48a03\n  neg_esteem =~ q48a04 + q48a05 + q48a06\n  deviant_esteem =~ q48a07 + q48a08 + q48a10\n  \n  # 자기 신뢰감 관련 요인\n  self_confidence =~ q48b1 + q48b2 + q48b3\n  \n  # 정서 관련 요인\n  aggression =~ q48c1 + q48c3 + q48c4 + q48c5 + q48c6\n  emotional_regulation =~ q48c7 + q48c8 + q48c9\n  \n  # 성역할 정체감 요인\n  female_identity =~ q48d1 + q48d2 + q48d3\n  male_identity =~ q48d4 + q48d5 + q48d6\n  \n  # 스트레스 관련 요인\n  parent_stress =~ q49a01 + q49a02 + q49a03 + q49a04\n  academic_stress =~ q49a05 + q49a06 + q49a07 + q49a08\n  friend_stress =~ q49a09 + q49a10 + q49a11\n  appearance_stress =~ q49a12 + q49a13 + q49a14\n  desire_stress =~ q49a15 + q49a16 + q49a17\n'\n\n# CFA 모델 실행\ncfa_fit <- cfa(cfa_model, data = df_clean)\n\n# 모델 적합도 지수 확인\nsummary(cfa_fit, fit.measures = TRUE, standardized = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlavaan 0.6-19 ended normally after 90 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                       164\n\n  Number of observations                          3449\n\nModel Test User Model:\n                                                      \n  Test statistic                              5493.561\n  Degrees of freedom                               782\n  P-value (Chi-square)                           0.000\n\nModel Test Baseline Model:\n\n  Test statistic                             57632.400\n  Degrees of freedom                               903\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.917\n  Tucker-Lewis Index (TLI)                       0.904\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)            -187941.896\n  Loglikelihood unrestricted model (H1)    -185195.115\n                                                      \n  Akaike (AIC)                              376211.791\n  Bayesian (BIC)                            377219.709\n  Sample-size adjusted Bayesian (SABIC)     376698.603\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.042\n  90 Percent confidence interval - lower         0.041\n  90 Percent confidence interval - upper         0.043\n  P-value H_0: RMSEA <= 0.050                    1.000\n  P-value H_0: RMSEA >= 0.080                    0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.041\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                          Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  pos_esteem =~                                                                \n    q48a01                   1.000                               0.517    0.607\n    q48a02                   1.411    0.041   34.460    0.000    0.730    0.830\n    q48a03                   1.460    0.042   34.457    0.000    0.755    0.829\n  neg_esteem =~                                                                \n    q48a04                   1.000                               0.708    0.681\n    q48a05                   0.944    0.031   30.784    0.000    0.668    0.656\n    q48a06                   1.090    0.033   33.378    0.000    0.772    0.764\n  deviant_esteem =~                                                            \n    q48a07                   1.000                               0.691    0.720\n    q48a08                   1.066    0.023   45.519    0.000    0.737    0.895\n    q48a10                   0.919    0.021   43.202    0.000    0.636    0.794\n  self_confidence =~                                                           \n    q48b1                    1.000                               0.618    0.727\n    q48b2                    1.140    0.027   41.651    0.000    0.704    0.823\n    q48b3                    1.119    0.027   41.089    0.000    0.692    0.797\n  aggression =~                                                                \n    q48c1                    1.000                               0.543    0.525\n    q48c3                    0.915    0.039   23.590    0.000    0.497    0.579\n    q48c4                    1.235    0.055   22.418    0.000    0.671    0.533\n    q48c5                    1.377    0.053   25.996    0.000    0.748    0.697\n    q48c6                    1.416    0.053   26.474    0.000    0.769    0.731\n  emotional_regulation =~                                                      \n    q48c7                    1.000                               0.499    0.456\n    q48c8                    1.549    0.078   19.839    0.000    0.772    0.754\n    q48c9                    1.310    0.064   20.424    0.000    0.653    0.676\n  female_identity =~                                                           \n    q48d1                    1.000                               0.527    0.480\n    q48d2                    1.410    0.062   22.904    0.000    0.743    0.793\n    q48d3                    1.437    0.062   23.224    0.000    0.758    0.713\n  male_identity =~                                                             \n    q48d4                    1.000                               0.722    0.648\n    q48d5                    1.025    0.037   27.880    0.000    0.740    0.726\n    q48d6                    0.988    0.036   27.581    0.000    0.713    0.673\n  parent_stress =~                                                             \n    q49a01                   1.000                               0.775    0.706\n    q49a02                   1.188    0.026   46.033    0.000    0.921    0.857\n    q49a03                   1.216    0.026   46.086    0.000    0.942    0.859\n    q49a04                   1.080    0.026   41.604    0.000    0.837    0.764\n  academic_stress =~                                                           \n    q49a05                   1.000                               0.789    0.719\n    q49a06                   0.955    0.027   35.525    0.000    0.753    0.707\n    q49a07                   0.887    0.029   31.021    0.000    0.699    0.604\n    q49a08                   0.958    0.028   34.785    0.000    0.755    0.689\n  friend_stress =~                                                             \n    q49a09                   1.000                               0.772    0.777\n    q49a10                   1.091    0.023   47.211    0.000    0.843    0.897\n    q49a11                   0.925    0.023   40.845    0.000    0.715    0.701\n  appearance_stress =~                                                         \n    q49a12                   1.000                               0.802    0.652\n    q49a13                   0.902    0.032   28.509    0.000    0.724    0.608\n    q49a14                   1.107    0.034   32.839    0.000    0.888    0.785\n  desire_stress =~                                                             \n    q49a15                   1.000                               0.810    0.707\n    q49a16                   1.213    0.029   42.187    0.000    0.983    0.832\n    q49a17                   1.206    0.029   41.741    0.000    0.977    0.815\n\nCovariances:\n                          Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  pos_esteem ~~                                                                \n    neg_esteem              -0.121    0.009  -13.552    0.000   -0.331   -0.331\n    deviant_esteem          -0.082    0.008  -10.756    0.000   -0.231   -0.231\n    self_confidenc           0.173    0.009   19.817    0.000    0.542    0.542\n    aggression              -0.009    0.006   -1.554    0.120   -0.033   -0.033\n    emotionl_rgltn           0.059    0.006    9.245    0.000    0.230    0.230\n    female_identty          -0.004    0.006   -0.725    0.469   -0.016   -0.016\n    male_identity            0.072    0.009    8.411    0.000    0.194    0.194\n    parent_stress           -0.042    0.008   -5.172    0.000   -0.104   -0.104\n    academic_strss          -0.042    0.009   -4.848    0.000   -0.104   -0.104\n    friend_stress           -0.038    0.008   -4.658    0.000   -0.094   -0.094\n    appearnc_strss          -0.072    0.009   -7.715    0.000   -0.173   -0.173\n    desire_stress           -0.062    0.009   -7.073    0.000   -0.148   -0.148\n  neg_esteem ~~                                                                \n    deviant_esteem           0.245    0.013   19.153    0.000    0.501    0.501\n    self_confidenc          -0.097    0.010   -9.818    0.000   -0.222   -0.222\n    aggression               0.142    0.010   13.824    0.000    0.370    0.370\n    emotionl_rgltn          -0.027    0.008   -3.236    0.001   -0.076   -0.076\n    female_identty           0.035    0.009    4.108    0.000    0.095    0.095\n    male_identity            0.036    0.012    3.058    0.002    0.071    0.071\n    parent_stress            0.204    0.013   15.618    0.000    0.372    0.372\n    academic_strss           0.259    0.015   17.578    0.000    0.463    0.463\n    friend_stress            0.195    0.013   15.090    0.000    0.357    0.357\n    appearnc_strss           0.233    0.015   15.436    0.000    0.410    0.410\n    desire_stress            0.217    0.014   15.481    0.000    0.379    0.379\n  deviant_esteem ~~                                                            \n    self_confidenc          -0.067    0.009   -7.659    0.000   -0.157   -0.157\n    aggression               0.160    0.010   16.070    0.000    0.426    0.426\n    emotionl_rgltn          -0.052    0.008   -6.633    0.000   -0.151   -0.151\n    female_identty           0.086    0.009   10.133    0.000    0.237    0.237\n    male_identity            0.002    0.011    0.196    0.845    0.004    0.004\n    parent_stress            0.159    0.011   13.928    0.000    0.296    0.296\n    academic_strss           0.108    0.012    9.262    0.000    0.199    0.199\n    friend_stress            0.128    0.011   11.581    0.000    0.240    0.240\n    appearnc_strss           0.099    0.012    8.133    0.000    0.178    0.178\n    desire_stress            0.184    0.012   14.825    0.000    0.329    0.329\n  self_confidence ~~                                                           \n    aggression               0.003    0.007    0.414    0.679    0.009    0.009\n    emotionl_rgltn           0.095    0.008   11.655    0.000    0.308    0.308\n    female_identty          -0.038    0.007   -5.301    0.000   -0.117   -0.117\n    male_identity            0.060    0.010    6.031    0.000    0.135    0.135\n    parent_stress           -0.034    0.010   -3.580    0.000   -0.071   -0.071\n    academic_strss          -0.045    0.010   -4.289    0.000   -0.091   -0.091\n    friend_stress           -0.075    0.010   -7.698    0.000   -0.158   -0.158\n    appearnc_strss          -0.096    0.011   -8.640    0.000   -0.194   -0.194\n    desire_stress           -0.075    0.010   -7.142    0.000   -0.149   -0.149\n  aggression ~~                                                                \n    emotionl_rgltn          -0.029    0.006   -4.528    0.000   -0.107   -0.107\n    female_identty           0.027    0.007    4.077    0.000    0.093    0.093\n    male_identity            0.060    0.009    6.471    0.000    0.153    0.153\n    parent_stress            0.153    0.010   14.572    0.000    0.363    0.363\n    academic_strss           0.133    0.011   12.442    0.000    0.311    0.311\n    friend_stress            0.104    0.010   10.877    0.000    0.248    0.248\n    appearnc_strss           0.124    0.011   11.242    0.000    0.284    0.284\n    desire_stress            0.154    0.011   13.885    0.000    0.349    0.349\n  emotional_regulation ~~                                                      \n    female_identty          -0.023    0.006   -3.641    0.000   -0.087   -0.087\n    male_identity            0.039    0.009    4.423    0.000    0.108    0.108\n    parent_stress           -0.018    0.008   -2.145    0.032   -0.046   -0.046\n    academic_strss           0.013    0.009    1.399    0.162    0.032    0.032\n    friend_stress           -0.035    0.009   -4.071    0.000   -0.090   -0.090\n    appearnc_strss          -0.031    0.009   -3.285    0.001   -0.078   -0.078\n    desire_stress           -0.025    0.009   -2.733    0.006   -0.061   -0.061\n  female_identity ~~                                                           \n    male_identity            0.131    0.011   12.315    0.000    0.344    0.344\n    parent_stress            0.036    0.009    4.211    0.000    0.089    0.089\n    academic_strss           0.031    0.009    3.346    0.001    0.075    0.075\n    friend_stress            0.088    0.009    9.424    0.000    0.217    0.217\n    appearnc_strss           0.002    0.010    0.170    0.865    0.004    0.004\n    desire_stress            0.008    0.009    0.906    0.365    0.019    0.019\n  male_identity ~~                                                             \n    parent_stress            0.061    0.012    5.108    0.000    0.110    0.110\n    academic_strss           0.097    0.013    7.287    0.000    0.170    0.170\n    friend_stress            0.014    0.012    1.181    0.238    0.025    0.025\n    appearnc_strss          -0.003    0.013   -0.229    0.819   -0.005   -0.005\n    desire_stress            0.060    0.013    4.623    0.000    0.102    0.102\n  parent_stress ~~                                                             \n    academic_strss           0.388    0.017   23.001    0.000    0.635    0.635\n    friend_stress            0.147    0.012   11.899    0.000    0.245    0.245\n    appearnc_strss           0.191    0.014   13.281    0.000    0.307    0.307\n    desire_stress            0.295    0.015   19.425    0.000    0.470    0.470\n  academic_stress ~~                                                           \n    friend_stress            0.206    0.014   14.867    0.000    0.338    0.338\n    appearnc_strss           0.292    0.017   17.297    0.000    0.462    0.462\n    desire_stress            0.302    0.016   18.762    0.000    0.473    0.473\n  friend_stress ~~                                                             \n    appearnc_strss           0.306    0.016   18.853    0.000    0.493    0.493\n    desire_stress            0.216    0.014   15.484    0.000    0.345    0.345\n  appearance_stress ~~                                                         \n    desire_stress            0.418    0.019   21.500    0.000    0.643    0.643\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .q48a01            0.459    0.012   36.925    0.000    0.459    0.632\n   .q48a02            0.241    0.011   21.897    0.000    0.241    0.311\n   .q48a03            0.259    0.012   21.965    0.000    0.259    0.312\n   .q48a04            0.581    0.018   31.434    0.000    0.581    0.537\n   .q48a05            0.592    0.018   32.777    0.000    0.592    0.570\n   .q48a06            0.424    0.017   25.147    0.000    0.424    0.416\n   .q48a07            0.444    0.013   34.604    0.000    0.444    0.482\n   .q48a08            0.135    0.008   16.865    0.000    0.135    0.199\n   .q48a10            0.237    0.008   29.557    0.000    0.237    0.370\n   .q48b1             0.341    0.011   32.337    0.000    0.341    0.472\n   .q48b2             0.237    0.010   23.965    0.000    0.237    0.323\n   .q48b3             0.275    0.010   26.709    0.000    0.275    0.365\n   .q48c1             0.775    0.021   37.261    0.000    0.775    0.724\n   .q48c3             0.489    0.014   35.841    0.000    0.489    0.665\n   .q48c4             1.133    0.031   37.075    0.000    1.133    0.716\n   .q48c5             0.591    0.019   30.681    0.000    0.591    0.514\n   .q48c6             0.517    0.018   28.457    0.000    0.517    0.466\n   .q48c7             0.946    0.026   36.973    0.000    0.946    0.792\n   .q48c8             0.452    0.027   16.948    0.000    0.452    0.431\n   .q48c9             0.508    0.021   23.723    0.000    0.508    0.543\n   .q48d1             0.928    0.025   37.484    0.000    0.928    0.770\n   .q48d2             0.327    0.019   17.144    0.000    0.327    0.372\n   .q48d3             0.555    0.023   24.532    0.000    0.555    0.492\n   .q48d4             0.720    0.024   30.294    0.000    0.720    0.580\n   .q48d5             0.492    0.020   24.207    0.000    0.492    0.473\n   .q48d6             0.615    0.022   28.557    0.000    0.615    0.548\n   .q49a01            0.606    0.017   36.649    0.000    0.606    0.502\n   .q49a02            0.306    0.011   27.371    0.000    0.306    0.265\n   .q49a03            0.316    0.012   27.215    0.000    0.316    0.263\n   .q49a04            0.498    0.014   34.529    0.000    0.498    0.416\n   .q49a05            0.581    0.019   31.292    0.000    0.581    0.483\n   .q49a06            0.567    0.018   31.977    0.000    0.567    0.500\n   .q49a07            0.849    0.024   36.099    0.000    0.849    0.635\n   .q49a08            0.632    0.019   32.921    0.000    0.632    0.525\n   .q49a09            0.392    0.013   29.695    0.000    0.392    0.397\n   .q49a10            0.173    0.011   15.162    0.000    0.173    0.196\n   .q49a11            0.528    0.015   34.747    0.000    0.528    0.509\n   .q49a12            0.869    0.026   33.115    0.000    0.869    0.575\n   .q49a13            0.892    0.026   34.955    0.000    0.892    0.630\n   .q49a14            0.490    0.021   23.254    0.000    0.490    0.383\n   .q49a15            0.658    0.019   34.371    0.000    0.658    0.500\n   .q49a16            0.431    0.017   24.878    0.000    0.431    0.308\n   .q49a17            0.481    0.018   26.666    0.000    0.481    0.335\n    pos_esteem        0.267    0.015   18.195    0.000    1.000    1.000\n    neg_esteem        0.501    0.025   19.983    0.000    1.000    1.000\n    deviant_esteem    0.478    0.021   23.073    0.000    1.000    1.000\n    self_confidenc    0.382    0.017   22.842    0.000    1.000    1.000\n    aggression        0.295    0.020   14.756    0.000    1.000    1.000\n    emotionl_rgltn    0.249    0.021   11.791    0.000    1.000    1.000\n    female_identty    0.278    0.021   12.992    0.000    1.000    1.000\n    male_identity     0.521    0.029   17.798    0.000    1.000    1.000\n    parent_stress     0.600    0.026   22.839    0.000    1.000    1.000\n    academic_strss    0.622    0.028   22.103    0.000    1.000    1.000\n    friend_stress     0.597    0.024   25.143    0.000    1.000    1.000\n    appearnc_strss    0.644    0.034   19.063    0.000    1.000    1.000\n    desire_stress     0.657    0.029   22.308    0.000    1.000    1.000\n```\n\n\n:::\n\n```{.r .cell-code}\n# 요인 부하량 표시\nparameterEstimates(cfa_fit, standardized = TRUE) %>%\n  filter(op == \"=~\") %>%\n  select(lhs, rhs, est, std.all, pvalue)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    lhs    rhs   est std.all pvalue\n1            pos_esteem q48a01 1.000   0.607     NA\n2            pos_esteem q48a02 1.411   0.830      0\n3            pos_esteem q48a03 1.460   0.829      0\n4            neg_esteem q48a04 1.000   0.681     NA\n5            neg_esteem q48a05 0.944   0.656      0\n6            neg_esteem q48a06 1.090   0.764      0\n7        deviant_esteem q48a07 1.000   0.720     NA\n8        deviant_esteem q48a08 1.066   0.895      0\n9        deviant_esteem q48a10 0.919   0.794      0\n10      self_confidence  q48b1 1.000   0.727     NA\n11      self_confidence  q48b2 1.140   0.823      0\n12      self_confidence  q48b3 1.119   0.797      0\n13           aggression  q48c1 1.000   0.525     NA\n14           aggression  q48c3 0.915   0.579      0\n15           aggression  q48c4 1.235   0.533      0\n16           aggression  q48c5 1.377   0.697      0\n17           aggression  q48c6 1.416   0.731      0\n18 emotional_regulation  q48c7 1.000   0.456     NA\n19 emotional_regulation  q48c8 1.549   0.754      0\n20 emotional_regulation  q48c9 1.310   0.676      0\n21      female_identity  q48d1 1.000   0.480     NA\n22      female_identity  q48d2 1.410   0.793      0\n23      female_identity  q48d3 1.437   0.713      0\n24        male_identity  q48d4 1.000   0.648     NA\n25        male_identity  q48d5 1.025   0.726      0\n26        male_identity  q48d6 0.988   0.673      0\n27        parent_stress q49a01 1.000   0.706     NA\n28        parent_stress q49a02 1.188   0.857      0\n29        parent_stress q49a03 1.216   0.859      0\n30        parent_stress q49a04 1.080   0.764      0\n31      academic_stress q49a05 1.000   0.719     NA\n32      academic_stress q49a06 0.955   0.707      0\n33      academic_stress q49a07 0.887   0.604      0\n34      academic_stress q49a08 0.958   0.689      0\n35        friend_stress q49a09 1.000   0.777     NA\n36        friend_stress q49a10 1.091   0.897      0\n37        friend_stress q49a11 0.925   0.701      0\n38    appearance_stress q49a12 1.000   0.652     NA\n39    appearance_stress q49a13 0.902   0.608      0\n40    appearance_stress q49a14 1.107   0.785      0\n41        desire_stress q49a15 1.000   0.707     NA\n42        desire_stress q49a16 1.213   0.832      0\n43        desire_stress q49a17 1.206   0.815      0\n```\n\n\n:::\n\n```{.r .cell-code}\n# 수정 지수 확인 (모델 개선에 필요)\nmi <- modificationIndices(cfa_fit)\nhead(mi[order(mi$mi, decreasing = TRUE), ], 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   lhs op    rhs      mi    epc sepc.lv sepc.all sepc.nox\n221         neg_esteem =~ q48a07 505.452  0.556   0.393    0.410    0.410\n651  appearance_stress =~ q49a15 485.793  0.726   0.582    0.508    0.508\n967             q48a08 ~~ q48a10 339.669  0.236   0.236    1.319    1.319\n561    academic_stress =~ q49a01 259.532  0.467   0.368    0.335    0.335\n1596            q49a16 ~~ q49a17 250.686  0.362   0.362    0.794    0.794\n1464            q49a01 ~~ q49a05 233.312  0.182   0.182    0.307    0.307\n932             q48a07 ~~ q48a10 168.745 -0.132  -0.132   -0.407   -0.407\n1463            q49a01 ~~ q49a04 160.052 -0.145  -0.145   -0.265   -0.265\n1591            q49a14 ~~ q49a15 150.792  0.160   0.160    0.282    0.282\n268     deviant_esteem =~  q48c3 147.307  0.282   0.195    0.227    0.227\n```\n\n\n:::\n\n```{.r .cell-code}\n# 시각화. 변수가 너무 많아서 잘 안보이긴 함\nsemPaths(cfa_fit, what = \"std\", edge.label.cex = 0.5, \n         layout = \"tree2\", rotation = 2, \n         edge.color = \"black\", edge.width = 0.5,\n         label.cex = 0.8, node.width = 1.5, node.height = 0.8,\n         curvePivot = TRUE)\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n## 군집 분석\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 요인 점수 추출\nfactor_scores <- lavPredict(cfa_fit)\nfactor_scores_df <- as.data.frame(factor_scores)\n\n# 원본 데이터에서 필요한 변수 추출 (성별과 삶의 만족도)\nadditional_vars <- df_origin[rownames(factor_scores_df), c(\"sex\", \"q50\")]\n\n# 군집 분석을 위한 데이터셋 준비\ncluster_data <- factor_scores_df\n\n# 최적의 군집 수 결정 (엘보우 방법)\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n\n\n:::\n\n```{.r .cell-code}\n# WSS (Within-Cluster Sum of Squares) 계산\nwss <- fviz_nbclust(cluster_data, kmeans, method = \"wss\", k.max = 10)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: did not converge in 10 iterations\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(wss)\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 실루엣 방법으로 최적 군집 수 확인\nsilhouette <- fviz_nbclust(cluster_data, kmeans, method = \"silhouette\", k.max = 10)\nprint(silhouette)\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 군집 수를 2개로 결정 (필요에 따라 조정)\nk <- 2\nkmeans_result <- kmeans(cluster_data, centers = k, nstart = 25)\n\n# 군집 할당 결과 추가\ncluster_data$cluster <- as.factor(kmeans_result$cluster)\nadditional_vars$cluster <- as.factor(kmeans_result$cluster)\n\n# 군집별 특성 확인\ncluster_means <- aggregate(. ~ cluster, data = cluster_data, mean)\nprint(cluster_means)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  cluster pos_esteem neg_esteem deviant_esteem self_confidence aggression\n1       1 -0.1136445  0.3556459      0.2654662      -0.1270054  0.2075937\n2       2  0.1234758 -0.3864126     -0.2884315       0.1379926 -0.2255525\n  emotional_regulation female_identity male_identity parent_stress\n1          -0.04923108      0.05516774    0.04974770     0.3988247\n2           0.05349003     -0.05994027   -0.05405134    -0.4333268\n  academic_stress friend_stress appearance_stress desire_stress\n1       0.4187225     0.3539727         0.4470258     0.4792681\n2      -0.4549459    -0.3845947        -0.4856977    -0.5207293\n```\n\n\n:::\n\n```{.r .cell-code}\n# 각 군집별 요인 점수 시각화 (레이더 차트)\nlibrary(fmsb)\n\n# 레이더 차트를 위한 데이터 준비\nradar_data <- cluster_means[, -which(names(cluster_means) == \"cluster\")]\n# 데이터 정규화 (Min-Max 스케일링)\nnormalize <- function(x) {\n  return((x - min(x)) / (max(x) - min(x)))\n}\nradar_data_norm <- as.data.frame(lapply(radar_data, normalize))\n\n# 최대값과 최소값 행 추가 (fmsb 패키지 요구사항)\nradar_data_plot <- rbind(rep(1, ncol(radar_data_norm)), \n                         rep(0, ncol(radar_data_norm)),\n                         radar_data_norm)\nrownames(radar_data_plot) <- c(\"max\", \"min\", paste(\"Cluster\", 1:k))\n\n# 레이더 차트 그리기\ncolors <- c(\"#FF5733\", \"#33FF57\", \"#3357FF\", \"#F3FF33\")\npar(mar = c(1, 1, 1, 1))\nfor (i in 1:k) {\n  if (i == 1) {\n    radarchart(radar_data_plot[c(1, 2, i + 2), ], \n               pcol = colors[i], pfcol = scales::alpha(colors[i], 0.3),\n               plwd = 2, cglcol = \"grey\", cglty = 1, \n               title = paste(\"Clusters' Factor Profiles\"))\n  } else {\n    radarchart(radar_data_plot[c(1, 2, i + 2), ], \n               pcol = colors[i], pfcol = scales::alpha(colors[i], 0.3), \n               plwd = 2, add = TRUE)\n  }\n}\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in plot.window(...): \"add\" is not a graphical parameter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in plot.xy(xy, type, ...): \"add\" is not a graphical parameter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in title(...): \"add\" is not a graphical parameter\n```\n\n\n:::\n\n```{.r .cell-code}\nlegend(\"topright\", legend = paste(\"Cluster\", 1:k), \n       col = colors, lty = 1, lwd = 2, pch = 16, \n       pt.cex = 1.5, bty = \"n\")\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# 군집별 성별 분포 시각화\nlibrary(ggplot2)\n\n# 성별과 군집에 따른 빈도 계산\nsex_cluster <- table(additional_vars$sex, additional_vars$cluster)\nsex_cluster_df <- as.data.frame(sex_cluster)\nnames(sex_cluster_df) <- c(\"Sex\", \"Cluster\", \"Count\")\n\n# 상대적 비율로 변환\nsex_cluster_df <- sex_cluster_df %>%\n  group_by(Cluster) %>%\n  mutate(Percentage = Count / sum(Count) * 100)\n\n# 성별 분포 시각화. 1이 남성 2가 여성\nggplot(sex_cluster_df, aes(x = Cluster, y = Percentage, fill = Sex)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  geom_text(aes(label = sprintf(\"%.1f%%\", Percentage)), \n            position = position_stack(vjust = 0.5)) +\n  labs(title = \"Gender Distribution by Cluster\",\n       x = \"Cluster\", y = \"Percentage\", fill = \"Gender\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# 삶의 만족도(q50) 분포 시각화\n# q50의 분포를 확인\ntable(additional_vars$q50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   1    2    3    4    5 \n  54  421 1072 1626  276 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 군집별 삶의 만족도 평균 비교\nlife_satisfaction <- aggregate(q50 ~ cluster, data = additional_vars, mean)\nprint(life_satisfaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  cluster      q50\n1       1 3.175390\n2       2 3.807018\n```\n\n\n:::\n\n```{.r .cell-code}\n# 군집별 삶의 만족도 분포 시각화 (박스플롯)\nggplot(additional_vars, aes(x = cluster, y = q50, fill = cluster)) +\n  geom_boxplot() +\n  labs(title = \"Life Satisfaction Distribution by Cluster\",\n       x = \"Cluster\", y = \"Life Satisfaction Score\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# 군집별 삶의 만족도 분포 시각화 (바이올린 플롯)\nggplot(additional_vars, aes(x = cluster, y = q50, fill = cluster)) +\n  geom_violin(trim = FALSE) +\n  geom_boxplot(width = 0.1, fill = \"white\") +\n  labs(title = \"Life Satisfaction Distribution by Cluster\",\n       x = \"Cluster\", y = \"Life Satisfaction Score\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# 군집별 특성 요약\ncluster_summary <- data.frame(\n  Cluster = 1:k,\n  Size = as.vector(table(cluster_data$cluster)),\n  LifeSatisfaction = life_satisfaction$q50\n)\n\n# 군집별 요인 점수 평균 추가\ncluster_summary <- cbind(cluster_summary, cluster_means[, -which(names(cluster_means) == \"cluster\")])\n\n# 군집별 특성 출력\nprint(cluster_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Cluster Size LifeSatisfaction pos_esteem neg_esteem deviant_esteem\n1       1 1796         3.175390 -0.1136445  0.3556459      0.2654662\n2       2 1653         3.807018  0.1234758 -0.3864126     -0.2884315\n  self_confidence aggression emotional_regulation female_identity male_identity\n1      -0.1270054  0.2075937          -0.04923108      0.05516774    0.04974770\n2       0.1379926 -0.2255525           0.05349003     -0.05994027   -0.05405134\n  parent_stress academic_stress friend_stress appearance_stress desire_stress\n1     0.3988247       0.4187225     0.3539727         0.4470258     0.4792681\n2    -0.4333268      -0.4549459    -0.3845947        -0.4856977    -0.5207293\n```\n\n\n:::\n\n```{.r .cell-code}\n# 군집별 프로파일 해석\n# 각 군집의 주요 특징을 파악하여 프로파일 작성\ncluster_profiles <- list()\n\nfor (i in 1:k) {\n  # 현재 군집의 요인 점수\n  curr_scores <- as.numeric(cluster_means[i, -which(names(cluster_means) == \"cluster\")])\n  \n  # 가장 높은 요인 3개와 가장 낮은 요인 3개 찾기\n  factor_names <- names(cluster_means)[-which(names(cluster_means) == \"cluster\")]\n  sorted_idx <- order(curr_scores, decreasing = TRUE)\n  \n  high_factors <- factor_names[sorted_idx[1:3]]\n  low_factors <- factor_names[sorted_idx[(length(curr_scores)-2):length(curr_scores)]]\n  \n  # 군집 프로파일 작성\n  cluster_profiles[[i]] <- list(\n    cluster = i,\n    size = as.vector(table(cluster_data$cluster))[i],\n    high_factors = high_factors,\n    low_factors = low_factors,\n    life_satisfaction = life_satisfaction$q50[i]\n  )\n}\n\n# 군집 프로파일 출력\nfor (i in 1:k) {\n  cat(paste0(\"\\nCluster \", i, \" Profile:\\n\"))\n  cat(paste0(\"Size: \", cluster_profiles[[i]]$size, \" (\", \n             round(cluster_profiles[[i]]$size / nrow(cluster_data) * 100, 1), \"%)\\n\"))\n  cat(\"Prominent Characteristics:\\n\")\n  for (j in 1:3) {\n    factor_name <- cluster_profiles[[i]]$high_factors[j]\n    factor_value <- cluster_means[i, factor_name]\n    cat(paste0(\" - High \", factor_name, \": \", round(factor_value, 2), \"\\n\"))\n  }\n  cat(\"Less Prominent Characteristics:\\n\")\n  for (j in 1:3) {\n    factor_name <- cluster_profiles[[i]]$low_factors[j]\n    factor_value <- cluster_means[i, factor_name]\n    cat(paste0(\" - Low \", factor_name, \": \", round(factor_value, 2), \"\\n\"))\n  }\n  cat(paste0(\"Average Life Satisfaction: \", round(cluster_profiles[[i]]$life_satisfaction, 2), \"\\n\"))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCluster 1 Profile:\nSize: 1796 (52.1%)\nProminent Characteristics:\n - High desire_stress: 0.48\n - High appearance_stress: 0.45\n - High academic_stress: 0.42\nLess Prominent Characteristics:\n - Low emotional_regulation: -0.05\n - Low pos_esteem: -0.11\n - Low self_confidence: -0.13\nAverage Life Satisfaction: 3.18\n\nCluster 2 Profile:\nSize: 1653 (47.9%)\nProminent Characteristics:\n - High self_confidence: 0.14\n - High pos_esteem: 0.12\n - High emotional_regulation: 0.05\nLess Prominent Characteristics:\n - Low academic_stress: -0.45\n - Low appearance_stress: -0.49\n - Low desire_stress: -0.52\nAverage Life Satisfaction: 3.81\n```\n\n\n:::\n:::\n",
    "supporting": [
      "14_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
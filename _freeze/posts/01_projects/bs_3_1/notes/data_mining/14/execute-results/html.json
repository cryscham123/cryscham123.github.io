{
  "hash": "c4418ba4b2714cafcb025b48bb3479ee",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"preprocessing\"\ndate: 2025-05-22\ncategories: [\"data mining\"]\n---\n\n\n\n\n![](/img/human-thumb.jpg){.post-thumbnail}\n\n## Data Load\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThis is lavaan 0.6-19\nlavaan is FREE software! Please report any bugs.\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(survey)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: grid\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nLoading required package: survival\n\nAttaching package: 'survey'\n\nThe following object is masked from 'package:graphics':\n\n    dotchart\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(semPlot)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lattice\n\nAttaching package: 'caret'\n\nThe following object is masked from 'package:survival':\n\n    cluster\n\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(randomForest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nrandomForest 4.7-1.2\nType rfNews() to see new features/changes/bug fixes.\n\nAttaching package: 'randomForest'\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\nThe following object is masked from 'package:ggplot2':\n\n    margin\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(pROC)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nType 'citation(\"pROC\")' for a citation.\n\nAttaching package: 'pROC'\n\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ROSE) # ROSE 패키지 추가 (불균형 데이터 처리)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoaded ROSE 0.0-4\n```\n\n\n:::\n\n```{.r .cell-code}\nID_VAR <- \"id\"\nWEIGHT_VAR <- \"wt2\"\nOUTCOME_VAR <- \"status_category\"\n\ntarget_pred_var <- c(ID_VAR, \"wt1\", \"q33a01\", \"q33a02\", \"q33a03\", \"q33a04\", \"q33a05\", \"q33a06\",\n                    \"q48a07\", \"q48a08\", \"q48a09\", \"q48a10\",\n                    \"q49a01\", \"q49a02\", \"q49a03\", \"q49a04\",\n                    \"q33a07\", \"q33a08\", \"q33a09\",\n                    \"q49a15\", \"q49a16\", \"q49a17\",\n                    \"q49a09\", \"q49a10\", \"q49a11\",\n                    \"q48b1\", \"q48b2\", \"q48b3\",\n                    \"q12a01\", \"q12a02\", \"q12a03\",\n                    \"q48a04\", \"q48a05\", \"q48a06\",\n                    \"q49a05\", \"q49a06\", \"q49a08\")\n\ncfa_model <- '\n  # 1. 부모애착\n  parent_attachment =~ q33a01 + q33a02 + q33a03 + q33a04 + q33a05 + q33a06\n  # 2. 일탈적 자아 낙인\n  deviant_esteem =~ q48a07 + q48a08 + q48a09 + q48a10\n  # 3. 부모에 의한 스트레스\n  parent_stress =~ q49a01 + q49a02 + q49a03 + q49a04\n  # 4. 부모감독\n  parent_monitoring =~ q33a07 + q33a08 + q33a09\n  # 5. 물질적 요인으로 인한 스트레스\n  desire_stress =~ q49a15 + q49a16 + q49a17\n  # 6. 친구로 인한 스트레스\n  friend_stress =~ q49a09 + q49a10 + q49a11\n  # 7. 자기신뢰감\n  self_confidence =~ q48b1 + q48b2 + q48b3\n  # 8. 상급학교 의존도\n  higher_school_dependence =~ q12a01 + q12a02 + q12a03\n  # 9. 부정적 자아존중감\n  neg_esteem =~ q48a04 + q48a05 + q48a06\n  # 10. 학업으로 인한 스트레스\n  academic_stress =~ q49a05 + q49a06 + q49a08\n'\n\ndf1_origin <- read.csv('_data/student_1.csv')\ndf2_origin <- read.csv('_data/student_2.csv')\ndf3_origin <- read.csv('_data/student_3.csv')\ndf4_origin <- read.csv('_data/student_4.csv')\ndf5_origin <- read.csv('_data/student_5.csv')\ndf6_origin <- read.csv('_data/student_6.csv')\n```\n:::\n\n\n\n\n## CFA (Confirmatory Factor Analysis)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_df <- data.frame()\nfor (i in 1:5) {\n  ID_VAR <- \"id\"\n  df <- get(paste0(\"df\", i, \"_origin\"))\n  df_analysis <- df[target_pred_var]\n  df_clean <- na.omit(df_analysis)\n  cfa_fit <- cfa(\n    cfa_model,\n    data = df_clean,\n    sampling.weights = \"wt1\",\n    estimator = \"MLR\",\n    se = \"robust.cluster\",\n    test = \"satorra.bentler\")\n  factor_scores <- lavPredict(cfa_fit)\n  factor_scores_df <- cbind(df_clean[ID_VAR], as.data.frame(factor_scores))\n  names(factor_scores_df)[-1] <- paste0(names(factor_scores_df)[-1], \"_w\", i)\n  if (i == 1) {\n    merged_df <- factor_scores_df\n  } else {\n    merged_df <- merge(merged_df, factor_scores_df, by = ID_VAR, all = TRUE)\n  }\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\n```\n\n\n:::\n\n```{.r .cell-code}\nclassify_status <- function(q11_value) {\n  if (q11_value %in% c(1, 5, 6, 7, 8, 71, 81, 91, 10, 101, 11, 111)) {\n    return(\"active\")\n  } else if (q11_value %in% c(2, 3, 4, 9, 12, 13, 14)) {\n    return(\"passive\")\n  } else {\n    return(NA)\n  }\n}\n\nextra_df <- df6_origin[, c(\"id\", \"q11\", \"wt2\", \"sex\", \"yy\", \"area\")]\nextra_df$status_category <- mapply(classify_status, extra_df$q11)\nmerged_df <- merge(merged_df, extra_df, by = \"id\", all.x = TRUE)\n```\n:::\n\n\n\n\n## 인구통계학적 분포 분석\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_df_clean <- merged_df %>%\n  filter(complete.cases(.))\n\nsex_dist <- merged_df_clean %>%\n  count(sex) %>%\n  mutate(percentage = n / sum(n) * 100)\n\nbirth_year_dist <- merged_df_clean %>%\n  count(yy) %>%\n  mutate(percentage = n / sum(n) * 100)\n\narea_dist <- merged_df_clean %>%\n  count(area) %>%\n  mutate(percentage = n / sum(n) * 100)\n\nstatus_dist <- merged_df_clean %>%\n  count(status_category) %>%\n  mutate(percentage = n / sum(n) * 100)\n\n# 표 출력\nkable(sex_dist, caption = \"성별 분포 (결측치 제거 후)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>성별 분포 (결측치 제거 후)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> sex </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1157 </td>\n   <td style=\"text-align:right;\"> 47.47641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1280 </td>\n   <td style=\"text-align:right;\"> 52.52359 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nkable(birth_year_dist, caption = \"출생년도 분포 (결측치 제거 후)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>출생년도 분포 (결측치 제거 후)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> yy </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 88 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 1884 </td>\n   <td style=\"text-align:right;\"> 77.3081658 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 551 </td>\n   <td style=\"text-align:right;\"> 22.6097661 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nkable(area_dist, caption = \"거주 지역 분포 (결측치 제거 후)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>거주 지역 분포 (결측치 제거 후)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> area </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 100 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 0.5744768 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 120 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.6155109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 121 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 122 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1231022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 131 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.4924087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 132 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.2872384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 133 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0.8206812 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 134 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 135 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.4924087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 136 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 0.7386130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 137 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 138 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 0.6565449 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 139 </td>\n   <td style=\"text-align:right;\"> 37 </td>\n   <td style=\"text-align:right;\"> 1.5182602 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 140 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.1641362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 142 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.2462043 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 143 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.6155109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 151 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 0.7796471 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 152 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 153 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.1641362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 156 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 0.7386130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 157 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 0.7796471 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 158 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 0.6565449 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 210 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1231022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0.8617152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 225 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.6155109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 232 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 235 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 240 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 0.9848174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 300 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.3282725 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 301 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0.8206812 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 302 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 1.5592942 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 305 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 0.9848174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 306 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.1641362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 314 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 320 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 321 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 0.5334428 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 330 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 336 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.2051703 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 339 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 340 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 350 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 355 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 356 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 360 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 0.5334428 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 361 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 1.3951580 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 363 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 367 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 369 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 370 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 1.1489536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 373 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 380 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 390 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 400 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 402 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 1.1899877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 403 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 1.0258515 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 404 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 405 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 1.1489536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 406 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 407 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 0.5744768 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 411 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 0.9848174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 412 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 0.4103406 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 413 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0.8617152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 415 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 420 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 1.1899877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 421 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 0.5334428 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 422 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 423 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 425 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 426 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 427 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 429 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.4924087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 430 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 0.9848174 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 431 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 435 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 1.1489536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 440 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0.3282725 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 441 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 442 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 1.2310217 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 443 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0.2462043 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 445 </td>\n   <td style=\"text-align:right;\"> 38 </td>\n   <td style=\"text-align:right;\"> 1.5592942 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 447 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1231022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 449 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 1.3541239 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 456 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 459 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 461 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 0.3693065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 462 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 0.4103406 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 463 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.6155109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 464 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 465 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 471 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 472 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 480 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 481 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 500 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:right;\"> 1.3951580 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 502 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 1.1899877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 503 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 506 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 1.1489536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 517 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0.8206812 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 525 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 530 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 534 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 536 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 540 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 1.0258515 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 560 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 561 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.2872384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 565 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 570 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 573 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 0.8206812 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 576 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 579 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 595 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.2872384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 600 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 601 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 602 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 0.6155109 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 604 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 607 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 608 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 609 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 611 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.2872384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 612 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0.8617152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 613 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 614 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 616 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1231022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 617 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0.1231022 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 619 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 621 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 0.9027493 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 626 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 1.2310217 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 631 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 1.2310217 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 637 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 638 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 641 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 1.2310217 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 645 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 650 </td>\n   <td style=\"text-align:right;\"> 26 </td>\n   <td style=\"text-align:right;\"> 1.0668855 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 656 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 660 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 1.3541239 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 676 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 0.7386130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 680 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 0.9437833 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 681 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 1.1489536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 682 </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:right;\"> 1.1079196 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 689 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 700 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 0.5334428 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 701 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 1.3130899 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 702 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0.2872384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 703 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 704 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 1.8875667 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 705 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 0.4924087 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 706 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 1.3130899 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 711 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0.0820681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 712 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0.8617152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 718 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 730 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 1.2720558 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 742 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 750 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0.8617152 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 757 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 0.7386130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 760 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.1641362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 764 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 770 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.0410341 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 780 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 0.6975790 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 790 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 0.3693065 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 791 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 0.6565449 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\nkable(status_dist, caption = \"종속변수(Active vs Passive) 분포 (결측치 제거 후)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>종속변수(Active vs Passive) 분포 (결측치 제거 후)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> status_category </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> active </td>\n   <td style=\"text-align:right;\"> 1680 </td>\n   <td style=\"text-align:right;\"> 68.93722 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> passive </td>\n   <td style=\"text-align:right;\"> 757 </td>\n   <td style=\"text-align:right;\"> 31.06278 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## 분포 시각화\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 성별 분포 시각화\nggplot(sex_dist, aes(x = sex, y = n, fill = sex)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), vjust = -0.5) +\n  labs(title = \"성별 분포\", x = \"성별\", y = \"빈도\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 출생년도 분포 시각화\nggplot(birth_year_dist, aes(x = yy, y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), vjust = -0.5) +\n  labs(title = \"출생년도 분포\", x = \"출생년도\", y = \"빈도\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 종속변수 분포 시각화\nggplot(status_dist, aes(x = status_category, y = n, fill = status_category)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), vjust = -0.5) +\n  labs(title = \"Active vs Passive 분포\", x = \"상태 카테고리\", y = \"빈도\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\n\n\n## 지역 분포\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 한국 지도 데이터 패키지 설치 및 로드\nif(!require(kormaps2014)) {\n  install.packages(\"stringi\")\n  install.packages(\"devtools\")\n  devtools::install_github(\"cardiomoon/kormaps2014\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: kormaps2014\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(kormaps2014)\nlibrary(ggplot2)\nlibrary(stringi)\nlibrary(mapproj)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: maps\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'maps'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    map\n```\n\n\n:::\n\n```{.r .cell-code}\n# 대한민국 지역 시각화를 위한 준비\nlibrary(ggplot2)\n\n# 지역 코드와 merged_df의 area 코드 매핑 함수\nmap_area_code <- function(area_code) {\n  area_mapping <- c(\n      \"100\" = \"서울\",\n      \"110\" = \"서울\",\n      \"120\" = \"서울\",\n      \"121\" = \"서울\",\n      \"122\" = \"서울\",\n      \"130\" = \"서울\",\n      \"131\" = \"서울\",\n      \"132\" = \"서울\",\n      \"133\" = \"서울\",\n      \"134\" = \"서울\",\n      \"135\" = \"서울\",\n      \"136\" = \"서울\",\n      \"137\" = \"서울\",\n      \"138\" = \"서울\",\n      \"139\" = \"서울\",\n      \"140\" = \"서울\",\n      \"142\" = \"서울\",\n      \"143\" = \"서울\",\n      \"150\" = \"서울\",\n      \"151\" = \"서울\",\n      \"152\" = \"서울\",\n      \"153\" = \"서울\",\n      \"156\" = \"서울\",\n      \"157\" = \"서울\",\n      \"158\" = \"서울\",\n      \"200\" = \"강원\",\n      \"209\" = \"강원\",\n      \"210\" = \"강원\",\n      \"215\" = \"강원\",\n      \"217\" = \"강원\",\n      \"219\" = \"강원\",\n      \"220\" = \"강원\",\n      \"225\" = \"강원\",\n      \"230\" = \"강원\",\n      \"232\" = \"강원\",\n      \"233\" = \"강원\",\n      \"235\" = \"강원\",\n      \"240\" = \"강원\",\n      \"245\" = \"강원\",\n      \"250\" = \"강원\",\n      \"252\" = \"강원\",\n      \"255\" = \"강원\",\n      \"269\" = \"강원\",\n      \"300\" = \"대전\",\n      \"301\" = \"대전\",\n      \"302\" = \"대전\",\n      \"305\" = \"대전\",\n      \"306\" = \"대전\",\n      \"312\" = \"충남\",\n      \"314\" = \"충남\",\n      \"320\" = \"충남\",\n      \"321\" = \"충남\",\n      \"323\" = \"충남\",\n      \"325\" = \"충남\",\n      \"330\" = \"충남\",\n      \"336\" = \"충남\",\n      \"339\" = \"충남\",\n      \"340\" = \"충남\",\n      \"343\" = \"충남\",\n      \"345\" = \"충남\",\n      \"350\" = \"충남\",\n      \"355\" = \"충남\",\n      \"356\" = \"충남\",\n      \"357\" = \"충남\",\n      \"360\" = \"충북\",\n      \"361\" = \"충북\",\n      \"363\" = \"충북\",\n      \"365\" = \"충북\",\n      \"367\" = \"충북\",\n      \"368\" = \"충북\",\n      \"369\" = \"충북\",\n      \"370\" = \"충북\",\n      \"373\" = \"충북\",\n      \"376\" = \"충북\",\n      \"380\" = \"충북\",\n      \"390\" = \"충북\",\n      \"395\" = \"충북\",\n      \"400\" = \"인천\",\n      \"401\" = \"인천\",\n      \"402\" = \"인천\",\n      \"403\" = \"인천\",\n      \"404\" = \"인천\",\n      \"405\" = \"인천\",\n      \"406\" = \"인천\",\n      \"407\" = \"인천\",\n      \"409\" = \"인천\",\n      \"411\" = \"경기\",\n      \"412\" = \"경기\",\n      \"413\" = \"경기\",\n      \"415\" = \"경기\",\n      \"417\" = \"인천\",\n      \"420\" = \"경기\",\n      \"421\" = \"경기\",\n      \"422\" = \"경기\",\n      \"423\" = \"경기\",\n      \"425\" = \"경기\",\n      \"426\" = \"경기\",\n      \"427\" = \"경기\",\n      \"429\" = \"경기\",\n      \"430\" = \"경기\",\n      \"431\" = \"경기\",\n      \"435\" = \"경기\",\n      \"437\" = \"경기\",\n      \"440\" = \"경기\",\n      \"441\" = \"경기\",\n      \"442\" = \"경기\",\n      \"443\" = \"경기\",\n      \"445\" = \"경기\",\n      \"447\" = \"경기\",\n      \"449\" = \"경기\",\n      \"456\" = \"경기\",\n      \"459\" = \"경기\",\n      \"461\" = \"경기\",\n      \"462\" = \"경기\",\n      \"463\" = \"경기\",\n      \"464\" = \"경기\",\n      \"465\" = \"경기\",\n      \"467\" = \"경기\",\n      \"469\" = \"경기\",\n      \"471\" = \"경기\",\n      \"472\" = \"경기\",\n      \"476\" = \"경기\",\n      \"477\" = \"경기\",\n      \"480\" = \"경기\",\n      \"481\" = \"경기\",\n      \"482\" = \"경기\",\n      \"483\" = \"경기\",\n      \"487\" = \"경기\",\n      \"500\" = \"광주\",\n      \"501\" = \"광주\",\n      \"502\" = \"광주\",\n      \"503\" = \"광주\",\n      \"506\" = \"광주\",\n      \"513\" = \"전남\",\n      \"515\" = \"전남\",\n      \"516\" = \"전남\",\n      \"517\" = \"전남\",\n      \"519\" = \"전남\",\n      \"520\" = \"전남\",\n      \"525\" = \"전남\",\n      \"526\" = \"전남\",\n      \"527\" = \"전남\",\n      \"529\" = \"전남\",\n      \"530\" = \"전남\",\n      \"534\" = \"전남\",\n      \"535\" = \"전남\",\n      \"536\" = \"전남\",\n      \"537\" = \"전남\",\n      \"539\" = \"전남\",\n      \"540\" = \"전남\",\n      \"542\" = \"전남\",\n      \"545\" = \"전남\",\n      \"546\" = \"전남\",\n      \"548\" = \"전남\",\n      \"550\" = \"전남\",\n      \"560\" = \"전북\",\n      \"561\" = \"전북\",\n      \"565\" = \"전북\",\n      \"566\" = \"전북\",\n      \"567\" = \"전북\",\n      \"568\" = \"전북\",\n      \"570\" = \"전북\",\n      \"573\" = \"전북\",\n      \"576\" = \"전북\",\n      \"579\" = \"전북\",\n      \"580\" = \"전북\",\n      \"585\" = \"전북\",\n      \"590\" = \"전북\",\n      \"595\" = \"전북\",\n      \"597\" = \"전북\",\n      \"600\" = \"부산\",\n      \"601\" = \"부산\",\n      \"602\" = \"부산\",\n      \"604\" = \"부산\",\n      \"606\" = \"부산\",\n      \"607\" = \"부산\",\n      \"608\" = \"부산\",\n      \"609\" = \"부산\",\n      \"611\" = \"부산\",\n      \"612\" = \"부산\",\n      \"613\" = \"부산\",\n      \"614\" = \"부산\",\n      \"616\" = \"부산\",\n      \"617\" = \"부산\",\n      \"618\" = \"부산\",\n      \"619\" = \"부산\",\n      \"621\" = \"경남\",\n      \"626\" = \"경남\",\n      \"627\" = \"경남\",\n      \"631\" = \"경남\",\n      \"635\" = \"경남\",\n      \"636\" = \"경남\",\n      \"637\" = \"경남\",\n      \"638\" = \"경남\",\n      \"641\" = \"경남\",\n      \"645\" = \"경남\",\n      \"650\" = \"경남\",\n      \"656\" = \"경남\",\n      \"660\" = \"경남\",\n      \"664\" = \"경남\",\n      \"666\" = \"경남\",\n      \"667\" = \"경남\",\n      \"668\" = \"경남\",\n      \"670\" = \"경남\",\n      \"676\" = \"경남\",\n      \"678\" = \"경남\",\n      \"680\" = \"울산\",\n      \"681\" = \"울산\",\n      \"682\" = \"울산\",\n      \"683\" = \"울산\",\n      \"689\" = \"울산\",\n      \"690\" = \"제주\",\n      \"695\" = \"제주\",\n      \"697\" = \"제주\",\n      \"699\" = \"제주\",\n      \"700\" = \"대구\",\n      \"701\" = \"대구\",\n      \"702\" = \"대구\",\n      \"703\" = \"대구\",\n      \"704\" = \"대구\",\n      \"705\" = \"대구\",\n      \"706\" = \"대구\",\n      \"711\" = \"대구\",\n      \"712\" = \"경북\",\n      \"714\" = \"경북\",\n      \"716\" = \"경북\",\n      \"717\" = \"경북\",\n      \"718\" = \"경북\",\n      \"719\" = \"경북\",\n      \"730\" = \"경북\",\n      \"740\" = \"경북\",\n      \"742\" = \"경북\",\n      \"745\" = \"경북\",\n      \"750\" = \"경북\",\n      \"755\" = \"경북\",\n      \"757\" = \"경북\",\n      \"760\" = \"경북\",\n      \"763\" = \"경북\",\n      \"764\" = \"경북\",\n      \"766\" = \"경북\",\n      \"767\" = \"경북\",\n      \"769\" = \"경북\",\n      \"770\" = \"경북\",\n      \"780\" = \"경북\",\n      \"790\" = \"경북\",\n      \"791\" = \"경북\",\n      \"799\" = \"경북\",\n      \"999\" = \"국외\"\n  )\n  return(area_mapping[as.character(area_code)])\n}\n\n# area 코드를 지역명으로 변환\nmerged_df_clean$area_name <- sapply(merged_df_clean$area, function(x) map_area_code(x))\n\n# 지역별 집계\nregion_counts <- merged_df_clean %>%\n  count(area_name) %>%\n  mutate(percentage = n / sum(n) * 100)\n\n# 지역 분포 시각화 - 막대 그래프로 표현\nggplot(region_counts, aes(x = reorder(area_name, -percentage), y = percentage, fill = area_name)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(round(percentage, 1), \"%\")), vjust = -0.5, size = 3) +\n  labs(title = \"지역별 분포 (결측치 제거 후)\",\n       x = \"지역\", \n       y = \"비율 (%)\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## 데이터 전처리 및 train test split\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_vars <- names(merged_df)[grep(\"_w[1-5]$\", names(merged_df))]\nmodel_df <- merged_df %>%\n  select(!!sym(ID_VAR), !!sym(OUTCOME_VAR), !!sym(WEIGHT_VAR), all_of(pred_vars))\nmodel_df <- model_df %>%\n  filter(complete.cases(.))\nmodel_df[[OUTCOME_VAR]] <- factor(model_df[[OUTCOME_VAR]])\nlevels(model_df[[OUTCOME_VAR]]) <- make.names(levels(model_df[[OUTCOME_VAR]]))\n\nX <- model_df[, pred_vars]\ny <- model_df[[OUTCOME_VAR]]\nweights <- model_df[[WEIGHT_VAR]]\n\nset.seed(1234)\ntrain_index <- createDataPartition(y, p = 0.7, list = FALSE, times = 1)\n\nX_train <- X[train_index, , drop = FALSE]\nX_test <- X[-train_index, , drop = FALSE]\ny_train <- y[train_index]\ny_test <- y[-train_index]\nweights_train <- weights[train_index]\nweights_test <- weights[-train_index]\n```\n:::\n\n\n\n\n## 오버샘플링\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_data <- cbind(X_train, y = y_train)\nrose_train_data <- ROSE(y ~ ., data = train_data, N = nrow(train_data) * 2)$data\n\nX_train <- rose_train_data[, setdiff(names(rose_train_data), \"y\")]\ny_train <- rose_train_data$y\n```\n:::\n\n\n\n\n## 데이터 저장\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_data_to_save <- data.frame(\n  y = y_train,\n  weights = weights_train,\n  X_train\n)\nwrite.csv(train_data_to_save, \"_data/train_data.csv\", row.names = FALSE)\ntest_data_to_save <- data.frame(\n  y = y_test,\n  weights = weights_test,\n  X_test\n)\nwrite.csv(test_data_to_save, \"_data/test_data.csv\", row.names = FALSE)\n```\n:::\n",
    "supporting": [
      "14_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
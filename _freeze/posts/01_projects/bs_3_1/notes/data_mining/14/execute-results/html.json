{
  "hash": "23569d2d1fc107f86a928f2629bc7b6c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"test\"\ndate: 2025-05-07\ncategories: [\"data mining\"]\n---\n\n\n\n\n![](/img/human-thumb.jpg){.post-thumbnail}\n\n## Data Load\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 데이터 로드 및 필요 패키지 불러오기\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(survey)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: grid\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nLoading required package: survival\n\nAttaching package: 'survey'\n\nThe following object is masked from 'package:graphics':\n\n    dotchart\n```\n\n\n:::\n\n```{.r .cell-code}\n# 데이터 파일 불러오기\ndf1_origin <- read.csv('_data/student_1.csv')\ndf2_origin <- read.csv('_data/student_2.csv')\ndf3_origin <- read.csv('_data/student_3.csv')\ndf4_origin <- read.csv('_data/student_4.csv')\ndf5_origin <- read.csv('_data/student_5.csv')\ndf6_origin <- read.csv('_data/student_6.csv')\n```\n:::\n\n\n\n\n## CFA (Confirmatory Factor Analysis)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThis is lavaan 0.6-19\nlavaan is FREE software! Please report any bugs.\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(semPlot)\n\ncfa_model <- '\n  # 측정 모델 정의\n  # 1. 부모애착\n  parent_attachment =~ q33a01 + q33a02 + q33a03 + q33a04 + q33a05 + q33a06\n  \n  # 2. 일탈적 자아 낙인\n  deviant_esteem =~ q48a07 + q48a08 + q48a09 + q48a10\n  \n  # 3. 부모에 의한 스트레스\n  parent_stress =~ q49a01 + q49a02 + q49a03 + q49a04\n  \n  # 4. 부모감독\n  parent_monitoring =~ q33a07 + q33a08 + q33a09\n  \n  # 5. 원하는거 못 사는 스트레스\n  desire_stress =~ q49a15 + q49a16 + q49a17\n  \n  # 6. 친구로 인한 스트레스\n  friend_stress =~ q49a09 + q49a10 + q49a11\n  \n  # 7. 자기신뢰감\n  self_confidence =~ q48b1 + q48b2 + q48b3\n  \n  # 8. 상급학교 의존도\n  higher_school_dependence =~ q12a01 + q12a02 + q12a03\n  \n  # 9. 부정적 자아존중감\n  neg_esteem =~ q48a04 + q48a05 + q48a06\n  \n  # 10. 학업으로 인한 스트레스\n  academic_stress =~ q49a05 + q49a06 + q49a08\n'\n# 각 웨이브별 요인 점수 계산 및 병합을 위한 데이터프레임 생성\nmerged_df <- data.frame()\n\n# 모든 웨이브에서 사용할 ID 변수 식별\nfor (i in 1:6) {\n  # 각 웨이브 데이터셋에서 ID 변수가 무엇인지 확인해야 합니다\n  # 여기서는 'id'라고 가정합니다. 실제 데이터셋의 ID 변수명으로 바꿔주세요\n  id_var <- \"id\"\n  \n  # 원본 데이터프레임에서 ID 변수와 분석에 필요한 변수들을 추출\n  df <- get(paste0(\"df\", i, \"_origin\"))\n  \n  # ID 변수가 있는지 확인\n  if(!id_var %in% names(df)) {\n    stop(paste0(\"ID 변수 '\", id_var, \"'가 df\", i, \"_origin에 없습니다. 올바른 ID 변수명을 지정해주세요.\"))\n  }\n  \n  # 가중치 변수가 있는지 확인\n  if(!\"wt1\" %in% names(df)) {\n    warning(paste0(\"가중치 변수 'wt1'이 df\", i, \"_origin에 없습니다. 가중치 없이 분석을 진행합니다.\"))\n    has_weights <- FALSE\n  } else {\n    has_weights <- TRUE\n  }\n  \n  # 분석에 필요한 변수 추출 (ID, 가중치, 문항)\n  if(has_weights) {\n    df_analysis <- df[c(id_var, \"wt1\", \"q33a01\", \"q33a02\", \"q33a03\", \"q33a04\", \"q33a05\", \"q33a06\", \n                      \"q48a07\", \"q48a08\", \"q48a09\", \"q48a10\",\n                      \"q49a01\", \"q49a02\", \"q49a03\", \"q49a04\",\n                      \"q33a07\", \"q33a08\", \"q33a09\",\n                      \"q49a15\", \"q49a16\", \"q49a17\",\n                      \"q49a09\", \"q49a10\", \"q49a11\",\n                      \"q48b1\", \"q48b2\", \"q48b3\",\n                      \"q12a01\", \"q12a02\", \"q12a03\",\n                      \"q48a04\", \"q48a05\", \"q48a06\",\n                      \"q49a05\", \"q49a06\", \"q49a08\")]\n  } else {\n    df_analysis <- df[c(id_var, \"q33a01\", \"q33a02\", \"q33a03\", \"q33a04\", \"q33a05\", \"q33a06\", \n                      \"q48a07\", \"q48a08\", \"q48a09\", \"q48a10\",\n                      \"q49a01\", \"q49a02\", \"q49a03\", \"q49a04\",\n                      \"q33a07\", \"q33a08\", \"q33a09\",\n                      \"q49a15\", \"q49a16\", \"q49a17\",\n                      \"q49a09\", \"q49a10\", \"q49a11\",\n                      \"q48b1\", \"q48b2\", \"q48b3\",\n                      \"q12a01\", \"q12a02\", \"q12a03\",\n                      \"q48a04\", \"q48a05\", \"q48a06\",\n                      \"q49a05\", \"q49a06\", \"q49a08\")]\n  }\n  \n  # 결측치가 있는 경우 처리 (요인 점수 계산에 사용될 관측치만 유지)\n  df_clean <- na.omit(df_analysis)\n  \n  # CFA 모형 적용 (가중치가 있는 경우와 없는 경우 구분)\n  if(has_weights) {\n    cfa_fit <- cfa(\n      cfa_model,\n      data = df_clean,\n      sampling.weights = \"wt1\",\n      estimator = \"MLR\",\n      se = \"robust.cluster\",\n      test = \"satorra.bentler\")\n  } else {\n    cfa_fit <- cfa(\n      cfa_model,\n      data = df_clean,\n      se = \"robust.huber.white\",\n      estimator = \"MLR\")\n  }\n \n\n  # 요인 점수 추출\n  factor_scores <- lavPredict(cfa_fit)\n  \n  # 요인 점수와 ID 변수 결합\n  factor_scores_df <- cbind(df_clean[id_var], as.data.frame(factor_scores))\n  \n  # 열 이름에 웨이브 번호 추가 (ID 변수 제외)\n  names(factor_scores_df)[-1] <- paste0(names(factor_scores_df)[-1], \"_w\", i)\n  \n  # 첫 번째 웨이브인 경우 병합 데이터프레임 초기화\n  if (i == 1) {\n    merged_df <- factor_scores_df\n  } else {\n    # ID 변수를 기준으로 병합\n    merged_df <- merge(merged_df, factor_scores_df, by = id_var, all = TRUE)\n  }\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\nWarning: lavaan->lav_options_set():  \n   observed.information for ALL test statistics is set to h1.\n```\n\n\n:::\n\n```{.r .cell-code}\n# df6_origin의 q11 칼럼 값을 기준으로 상태 분류하기 (가중치 반영)\nif(\"q11\" %in% names(df6_origin)) {\n  # 상태 분류 함수 정의\n  classify_status <- function(q11_value) {\n    if(is.na(q11_value)) return(NA)\n    \n    if(q11_value %in% c(7, 8, 9, 71, 81, 91)) {\n      return(\"생산적활동참여\")\n    } else {\n      return(\"비경제활동및학업관련상태\")\n    }\n  }\n  \n  # 숫자형 상태 코드 함수 정의\n  status_code <- function(q11_value) {\n    if(is.na(q11_value)) return(NA)\n    \n    if(q11_value %in% c(7, 8, 9, 71, 81, 91)) {\n      return(1)\n    } else {\n      return(2)\n    }\n  }\n  \n  # ID, q11 칼럼 및 가중치 변수 추출\n  if(\"wt1\" %in% names(df6_origin)) {\n    status_df <- df6_origin[, c(\"id\", \"q11\", \"wt1\")]\n    has_weight <- TRUE\n  } else {\n    status_df <- df6_origin[, c(\"id\", \"q11\")]\n    has_weight <- FALSE\n    warning(\"df6_origin에 가중치 변수 'wt1'이 없습니다. 가중치 없이 상태 분류를 진행합니다.\")\n  }\n  \n  # 상태 분류 칼럼 추가\n  status_df$status_category <- sapply(status_df$q11, classify_status)\n  status_df$status_code <- sapply(status_df$q11, status_code)\n  \n  # 최종 데이터프레임과 병합\n  merged_df <- merge(merged_df, status_df, by = \"id\", all.x = TRUE)\n  \n  # 상태별 가중 인원수 확인 (가중치가 있는 경우)\n  if(has_weight) {\n    # 가중치를 이용한 상태별 인원수 계산\n    weighted_status <- aggregate(wt1 ~ status_category, data = status_df, FUN = sum, na.rm = TRUE)\n    print(\"가중치를 반영한 상태별 인원수:\")\n    print(weighted_status)\n    \n    # 가중 비율 계산\n    total_weight <- sum(status_df$wt1, na.rm = TRUE)\n    weighted_status$proportion <- weighted_status$wt1 / total_weight * 100\n    weighted_status$proportion <- round(weighted_status$proportion, 2)\n    print(\"가중치를 반영한 상태별 비율(%):\")\n    print(weighted_status)\n  }\n  \n  # 일반 빈도수도 함께 확인\n  status_summary <- table(status_df$status_category, useNA = \"ifany\")\n  print(\"단순 상태별 인원수:\")\n  print(status_summary)\n} else {\n  warning(\"df6_origin에 q11 칼럼이 없습니다.\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"가중치를 반영한 상태별 인원수:\"\n           status_category       wt1\n1 비경제활동및학업관련상태 588538.34\n2           생산적활동참여  25876.55\n[1] \"가중치를 반영한 상태별 비율(%):\"\n           status_category       wt1 proportion\n1 비경제활동및학업관련상태 588538.34      95.79\n2           생산적활동참여  25876.55       4.21\n[1] \"단순 상태별 인원수:\"\n\n비경제활동및학업관련상태           생산적활동참여                     <NA> \n                    2709                      124                      616 \n```\n\n\n:::\n\n```{.r .cell-code}\n# knitr 테이블로 깔끔하게 출력 (처음 10개 행만)\nlibrary(knitr)\nkable(head(merged_df, 10), caption = \"ID 기준으로 병합된 각 웨이브별 요인 점수 및 상태 분류\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"format\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\nTable: ID 기준으로 병합된 각 웨이브별 요인 점수 및 상태 분류\n\n| id| parent_attachment_w1| deviant_esteem_w1| parent_stress_w1| parent_monitoring_w1| desire_stress_w1| friend_stress_w1| self_confidence_w1| higher_school_dependence_w1| neg_esteem_w1| academic_stress_w1| parent_attachment_w2| deviant_esteem_w2| parent_stress_w2| parent_monitoring_w2| desire_stress_w2| friend_stress_w2| self_confidence_w2| higher_school_dependence_w2| neg_esteem_w2| academic_stress_w2| parent_attachment_w3| deviant_esteem_w3| parent_stress_w3| parent_monitoring_w3| desire_stress_w3| friend_stress_w3| self_confidence_w3| higher_school_dependence_w3| neg_esteem_w3| academic_stress_w3| parent_attachment_w4| deviant_esteem_w4| parent_stress_w4| parent_monitoring_w4| desire_stress_w4| friend_stress_w4| self_confidence_w4| higher_school_dependence_w4| neg_esteem_w4| academic_stress_w4| parent_attachment_w5| deviant_esteem_w5| parent_stress_w5| parent_monitoring_w5| desire_stress_w5| friend_stress_w5| self_confidence_w5| higher_school_dependence_w5| neg_esteem_w5| academic_stress_w5| parent_attachment_w6| deviant_esteem_w6| parent_stress_w6| parent_monitoring_w6| desire_stress_w6| friend_stress_w6| self_confidence_w6| higher_school_dependence_w6| neg_esteem_w6| academic_stress_w6| q11|      wt1|status_category          | status_code|\n|--:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|---:|--------:|:------------------------|-----------:|\n|  1|           -0.3243760|        -0.6700334|       -1.2888828|            0.2098581|       -1.1479672|       -0.9679036|         -0.5181739|                  -1.3493773|    -1.3505307|         -1.0795734|           -0.7717384|        -0.6608967|       -1.2873237|            0.1752713|       -1.3479280|       -1.0981877|          0.9866218|                  -0.0788236|    -1.5193669|         -1.8610246|           -0.9311720|        -0.6152373|       -1.2140462|           -1.5436095|       -1.2503476|       -0.9502919|          0.3673777|                  -0.3732779|    -1.3781198|         -0.9008001|           -0.5798640|         0.1783698|       -0.2387830|           -0.6908478|       -0.4636099|       -0.0413946|          0.1207334|                   0.3355747|    -0.5167127|         -0.9937320|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n|  2|            0.6349327|         0.5078849|       -0.6326399|            0.5857777|        0.6890856|        0.8483740|         -1.3939955|                  -2.1440818|     1.0662063|          1.1280352|            0.4435336|         0.7122611|        0.6440219|            0.4937155|        1.7929318|        1.3199990|         -1.0001538|                  -1.6933149|     1.2570575|          1.4418152|            1.0696413|         0.2130112|        0.1599488|            1.4126496|        0.4489725|        0.2113223|         -1.9579161|                   0.5174786|     0.8858351|          0.2300922|            0.6543609|         0.1237724|       -0.9971190|            1.3299474|        0.8889380|       -0.7968937|         -0.4261106|                   0.5622499|     0.7099544|         -0.4950669|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|            0.0878639|        -0.4472891|       -0.6385196|           -0.4664906|        1.7078860|       -0.5528991|         -0.7586426|                   0.5135167|    -0.4511040|          5.7459025|  10| 233.8748|비경제활동및학업관련상태 |           2|\n|  3|           -0.7809465|        -0.0166743|        0.7078669|           -1.5936087|        0.0378940|        2.4200705|         -0.7899177|                  -1.5955832|     1.3739398|          0.8704824|           -0.6797844|         1.1007698|        0.2518074|           -0.6809594|        0.3220202|        0.7479033|         -0.4248311|                  -0.2402486|     0.3309781|          0.0258417|           -0.3291563|         0.1933929|        0.2233276|           -0.3657959|       -0.4189284|       -0.0693630|          0.3788134|                   0.4026163|    -0.5024279|         -0.1697338|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n|  4|            0.6436699|        -0.6421588|        0.0242399|            0.4453401|       -1.0724730|       -0.9450051|          1.1691664|                  -0.0256387|    -0.6101497|         -0.2697050|            0.1573604|         2.0339976|        0.6807335|            0.7333340|        0.7702179|        0.8767723|          0.2170404|                   0.6781302|     1.1728679|          0.6151071|            0.3351118|        -0.5767252|        0.6114324|            0.5091317|        1.3026412|        1.1266224|          1.1701190|                  -0.1266456|    -1.2634651|          0.2803782|            0.3504499|        -0.6063579|       -0.2704015|            0.4948656|        0.7481144|       -0.0073121|         -0.2853379|                  -0.4945815|     0.2446132|          0.5366802|            0.8579771|        -0.5856958|       -1.1659969|            0.5309801|       -0.6643839|       -0.7792066|          0.3363446|                   0.1843949|    -1.0593317|         -0.5945483|            1.0995457|        -0.4542865|       -1.0573944|            1.4148616|       -1.1848740|       -0.6635298|          1.0803961|                  -1.9931622|    -1.3099327|         -0.6677850|   1| 233.8748|비경제활동및학업관련상태 |           2|\n|  5|           -0.7786221|        -0.5026183|        0.7248930|            0.4563090|        1.5256802|       -0.5918456|          0.1564706|                   0.7983283|    -0.3153969|          0.3000924|           -0.6357079|         0.2416801|        0.8883073|            0.3789199|        1.0186509|        0.0811139|          0.4118378|                   0.7111523|     0.0216058|          0.8504237|           -0.0247071|         0.2140332|        0.8200684|            0.4834856|        1.0228134|        0.0108804|          0.3729191|                  -0.4004439|     0.1030242|          0.7780767|           -0.2673306|         0.2046595|        0.4564784|           -0.1485734|       -0.3767996|        0.6990650|         -0.2464312|                  -0.6059234|     0.2931288|         -0.0854562|            0.4023182|         0.2384645|        0.3655976|            0.4735592|        0.9419757|        0.1230735|          0.2740617|                   0.4626529|     0.4377669|          1.0282849|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n|  6|           -0.2616468|         0.1869781|        0.2997714|            0.5294106|        0.0392171|       -0.8750320|          0.3901616|                  -0.4525781|    -0.2751278|          0.4176892|           -0.8776761|         0.2641328|        1.0020023|            0.0966726|        0.7497405|       -0.0632333|         -0.0388798|                  -0.4169322|     0.7677319|          0.4856846|           -0.8986397|         0.2162657|        0.8931712|           -0.4298323|       -0.3384704|       -0.0197437|         -0.2899004|                  -1.1685440|     0.1074575|          0.6448577|            0.1900717|         0.9994914|        0.1249140|            0.2032521|       -0.3580494|        1.4261212|         -0.0918471|                   0.1173927|     0.7096159|         -0.1158515|           -0.6342974|         0.2695303|        0.3208028|           -0.7911686|        0.2521361|        0.1085246|         -0.5881712|                  -1.3260014|     0.7892800|          0.1507139|           -0.6104382|         0.4398948|        0.6348187|           -0.7642335|       -0.2634948|        0.1973443|          0.1518934|                  -0.9670501|     1.1776027|          1.0512801|   1| 233.8748|비경제활동및학업관련상태 |           2|\n|  7|           -0.5408175|         0.2523240|       -0.4313444|           -0.3783468|        0.6405140|       -0.0517304|         -0.4292349|                  -2.6430093|     0.1632027|         -0.4364927|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|            0.3843186|        -0.2481197|       -0.5768664|            0.5230629|        0.1361516|       -0.8669614|          0.4218457|                  -0.3468249|    -1.3621626|         -1.0342696|            0.4512337|        -0.5130748|       -0.5195532|            0.5220635|        0.0484822|       -0.8573413|          0.3927901|                   0.0408460|    -1.3388198|         -0.8038027|           -0.0077806|        -0.4886081|       -0.4178665|            0.4047954|        0.8351892|        0.0570391|          0.2960418|                  -0.3402458|    -0.6672525|         -0.6653289|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n|  8|           -1.0502562|         0.2317607|        0.5519268|           -1.1218820|       -0.2843416|       -0.0749740|          0.3263402|                  -0.9384948|     0.1152129|          0.3103126|           -0.5506358|        -0.3001664|       -0.4151837|            1.1571540|       -0.4975303|       -0.1780864|          0.3884519|                  -1.0249550|    -0.5935373|         -0.2288118|           -0.2719411|        -0.3053143|       -0.2078521|            0.7104419|        0.0703080|       -0.0875390|          0.3664008|                  -1.0719693|    -0.4311163|         -0.7735693|           -0.1128749|         1.0585230|        0.3916526|           -0.1407098|        0.2832931|        0.9142588|          0.2989234|                  -0.6043243|     0.1791726|          0.1101383|           -0.3405896|        -0.5681611|       -0.2264837|            0.3740992|       -0.6018936|       -0.7676773|          0.3161520|                   0.4071649|    -0.8186107|         -0.7239188|            0.2829181|        -0.4336312|       -0.1282184|            0.4871271|       -0.3782641|       -0.4093819|          0.2562614|                   0.4932576|    -0.2287523|         -0.8666315|   1| 174.5172|비경제활동및학업관련상태 |           2|\n|  9|           -0.0059274|         0.2124912|       -0.3170536|            0.0846398|        0.2628792|        0.0716865|          0.3921754|                   1.2859230|     0.1637573|         -0.2065772|            0.0016577|         0.5970234|        1.1351952|            0.0180174|        1.7590902|        0.2782930|          0.8009823|                   1.4761170|     1.3405641|          1.0744254|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n| 10|            0.4607676|         0.1844344|       -0.5208128|            0.6432839|       -0.3097233|       -0.7587713|          0.1796129|                   0.5998440|    -0.0935134|         -0.3568470|            0.1787284|         0.6446895|        0.5819081|            0.2787203|        0.2711662|       -0.0859862|          0.2642869|                   1.4365160|    -0.0659922|          0.1131703|           -0.3537643|         0.2130045|        0.7150524|           -0.3729380|        0.7417109|       -0.0013972|          0.3666087|                   0.5352998|     0.0940116|          0.4734057|           -0.0012252|         0.9284294|        0.4595521|           -0.3752634|       -0.2296067|        0.7273991|         -0.6290352|                  -0.3051167|     0.4029807|         -0.0897260|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|                   NA|                NA|               NA|                   NA|               NA|               NA|                 NA|                          NA|            NA|                 NA|  NA|       NA|NA                       |          NA|\n\n\n:::\n:::\n\n\n\n\n## 독립변수간 상관관계 분석\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 필요한 패키지 로드\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.95 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(reshape2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'reshape2'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:tidyr':\n\n    smiths\n```\n\n\n:::\n\n```{.r .cell-code}\n# 상관관계 분석을 위한 독립변수 선택 (요인 점수만 선택)\nfactor_vars <- names(merged_df)[grep(\"_w[1-6]$\", names(merged_df))]\ncorrelation_df <- merged_df[, factor_vars]\n\n# 결측치가 있는 행은 제외\ncorrelation_df <- correlation_df[complete.cases(correlation_df), ]\n\n# 상관행렬 계산\ncorr_matrix <- cor(correlation_df, use = \"pairwise.complete.obs\")\n\n# 상관행렬 확인 (크기가 크므로 첫 10x10만 출력)\ncat(\"상관행렬 (처음 10x10):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n상관행렬 (처음 10x10):\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(corr_matrix[1:10, 1:10], 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            parent_attachment_w1 deviant_esteem_w1\nparent_attachment_w1                        1.00             -0.27\ndeviant_esteem_w1                          -0.27              1.00\nparent_stress_w1                           -0.49              0.31\nparent_monitoring_w1                        0.66             -0.26\ndesire_stress_w1                           -0.35              0.36\nfriend_stress_w1                           -0.14              0.26\nself_confidence_w1                          0.29             -0.18\nhigher_school_dependence_w1                 0.16             -0.08\nneg_esteem_w1                              -0.29              0.52\nacademic_stress_w1                         -0.26              0.20\n                            parent_stress_w1 parent_monitoring_w1\nparent_attachment_w1                   -0.49                 0.66\ndeviant_esteem_w1                       0.31                -0.26\nparent_stress_w1                        1.00                -0.26\nparent_monitoring_w1                   -0.26                 1.00\ndesire_stress_w1                        0.53                -0.28\nfriend_stress_w1                        0.26                -0.12\nself_confidence_w1                     -0.08                 0.26\nhigher_school_dependence_w1             0.08                 0.17\nneg_esteem_w1                           0.42                -0.23\nacademic_stress_w1                      0.72                -0.16\n                            desire_stress_w1 friend_stress_w1\nparent_attachment_w1                   -0.35            -0.14\ndeviant_esteem_w1                       0.36             0.26\nparent_stress_w1                        0.53             0.26\nparent_monitoring_w1                   -0.28            -0.12\ndesire_stress_w1                        1.00             0.38\nfriend_stress_w1                        0.38             1.00\nself_confidence_w1                     -0.18            -0.18\nhigher_school_dependence_w1             0.04             0.04\nneg_esteem_w1                           0.45             0.41\nacademic_stress_w1                      0.56             0.38\n                            self_confidence_w1 higher_school_dependence_w1\nparent_attachment_w1                      0.29                        0.16\ndeviant_esteem_w1                        -0.18                       -0.08\nparent_stress_w1                         -0.08                        0.08\nparent_monitoring_w1                      0.26                        0.17\ndesire_stress_w1                         -0.18                        0.04\nfriend_stress_w1                         -0.18                        0.04\nself_confidence_w1                        1.00                        0.23\nhigher_school_dependence_w1               0.23                        1.00\nneg_esteem_w1                            -0.26                        0.01\nacademic_stress_w1                       -0.12                        0.11\n                            neg_esteem_w1 academic_stress_w1\nparent_attachment_w1                -0.29              -0.26\ndeviant_esteem_w1                    0.52               0.20\nparent_stress_w1                     0.42               0.72\nparent_monitoring_w1                -0.23              -0.16\ndesire_stress_w1                     0.45               0.56\nfriend_stress_w1                     0.41               0.38\nself_confidence_w1                  -0.26              -0.12\nhigher_school_dependence_w1          0.01               0.11\nneg_esteem_w1                        1.00               0.55\nacademic_stress_w1                   0.55               1.00\n```\n\n\n:::\n\n```{.r .cell-code}\n# kable로 더 보기 좋게 출력\nkable(round(corr_matrix, 2), caption = \"요인 점수 간 상관관계\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"format\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\nTable: 요인 점수 간 상관관계\n\n|                            | parent_attachment_w1| deviant_esteem_w1| parent_stress_w1| parent_monitoring_w1| desire_stress_w1| friend_stress_w1| self_confidence_w1| higher_school_dependence_w1| neg_esteem_w1| academic_stress_w1| parent_attachment_w2| deviant_esteem_w2| parent_stress_w2| parent_monitoring_w2| desire_stress_w2| friend_stress_w2| self_confidence_w2| higher_school_dependence_w2| neg_esteem_w2| academic_stress_w2| parent_attachment_w3| deviant_esteem_w3| parent_stress_w3| parent_monitoring_w3| desire_stress_w3| friend_stress_w3| self_confidence_w3| higher_school_dependence_w3| neg_esteem_w3| academic_stress_w3| parent_attachment_w4| deviant_esteem_w4| parent_stress_w4| parent_monitoring_w4| desire_stress_w4| friend_stress_w4| self_confidence_w4| higher_school_dependence_w4| neg_esteem_w4| academic_stress_w4| parent_attachment_w5| deviant_esteem_w5| parent_stress_w5| parent_monitoring_w5| desire_stress_w5| friend_stress_w5| self_confidence_w5| higher_school_dependence_w5| neg_esteem_w5| academic_stress_w5| parent_attachment_w6| deviant_esteem_w6| parent_stress_w6| parent_monitoring_w6| desire_stress_w6| friend_stress_w6| self_confidence_w6| higher_school_dependence_w6| neg_esteem_w6| academic_stress_w6|\n|:---------------------------|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|--------------------:|-----------------:|----------------:|--------------------:|----------------:|----------------:|------------------:|---------------------------:|-------------:|------------------:|\n|parent_attachment_w1        |                 1.00|             -0.27|            -0.49|                 0.66|            -0.35|            -0.14|               0.29|                        0.16|         -0.29|              -0.26|                 0.59|             -0.20|            -0.29|                 0.44|            -0.23|            -0.19|               0.17|                        0.11|         -0.18|              -0.19|                 0.53|             -0.19|            -0.22|                 0.38|            -0.17|            -0.11|               0.19|                        0.10|         -0.15|              -0.03|                 0.45|             -0.16|            -0.18|                 0.35|            -0.18|            -0.11|               0.17|                        0.13|         -0.13|               0.00|                 0.45|             -0.16|            -0.16|                 0.34|            -0.16|            -0.09|               0.16|                        0.11|         -0.14|               0.01|                 0.41|             -0.18|            -0.17|                 0.33|            -0.10|            -0.08|               0.11|                        0.04|         -0.15|              -0.06|\n|deviant_esteem_w1           |                -0.27|              1.00|             0.31|                -0.26|             0.36|             0.26|              -0.18|                       -0.08|          0.52|               0.20|                -0.18|              0.40|             0.18|                -0.19|             0.23|             0.20|              -0.13|                       -0.13|          0.22|               0.13|                -0.19|              0.40|             0.12|                -0.19|             0.20|             0.16|              -0.10|                       -0.12|          0.19|              -0.01|                -0.13|              0.33|             0.11|                -0.15|             0.15|             0.14|              -0.10|                       -0.13|          0.13|              -0.07|                -0.15|              0.33|             0.09|                -0.14|             0.17|             0.12|              -0.09|                       -0.16|          0.18|              -0.05|                -0.12|              0.31|             0.10|                -0.11|             0.13|             0.11|              -0.11|                       -0.06|          0.18|               0.02|\n|parent_stress_w1            |                -0.49|              0.31|             1.00|                -0.26|             0.53|             0.26|              -0.08|                        0.08|          0.42|               0.72|                -0.28|              0.20|             0.48|                -0.16|             0.32|             0.20|              -0.06|                        0.04|          0.22|               0.37|                -0.28|              0.19|             0.40|                -0.18|             0.28|             0.16|              -0.06|                        0.04|          0.20|               0.22|                -0.21|              0.17|             0.33|                -0.13|             0.26|             0.15|              -0.06|                        0.02|          0.20|               0.20|                -0.21|              0.13|             0.28|                -0.13|             0.22|             0.08|              -0.07|                        0.01|          0.19|               0.14|                -0.17|              0.12|             0.27|                -0.11|             0.20|             0.09|              -0.08|                        0.03|          0.18|               0.11|\n|parent_monitoring_w1        |                 0.66|             -0.26|            -0.26|                 1.00|            -0.28|            -0.12|               0.26|                        0.17|         -0.23|              -0.16|                 0.42|             -0.17|            -0.16|                 0.51|            -0.18|            -0.15|               0.17|                        0.14|         -0.15|              -0.12|                 0.39|             -0.17|            -0.12|                 0.46|            -0.13|            -0.09|               0.15|                        0.12|         -0.12|               0.01|                 0.31|             -0.15|            -0.09|                 0.38|            -0.13|            -0.08|               0.14|                        0.15|         -0.08|               0.04|                 0.33|             -0.14|            -0.09|                 0.39|            -0.14|            -0.08|               0.12|                        0.13|         -0.10|               0.03|                 0.30|             -0.17|            -0.09|                 0.38|            -0.09|            -0.07|               0.09|                        0.07|         -0.12|              -0.01|\n|desire_stress_w1            |                -0.35|              0.36|             0.53|                -0.28|             1.00|             0.38|              -0.18|                        0.04|          0.45|               0.56|                -0.22|              0.22|             0.31|                -0.17|             0.48|             0.25|              -0.08|                       -0.01|          0.22|               0.32|                -0.21|              0.18|             0.25|                -0.17|             0.43|             0.17|              -0.10|                       -0.01|          0.22|               0.19|                -0.14|              0.13|             0.18|                -0.11|             0.36|             0.14|              -0.09|                       -0.01|          0.17|               0.17|                -0.16|              0.14|             0.18|                -0.15|             0.36|             0.11|              -0.08|                       -0.01|          0.18|               0.12|                -0.16|              0.11|             0.21|                -0.12|             0.35|             0.16|              -0.11|                        0.01|          0.20|               0.07|\n|friend_stress_w1            |                -0.14|              0.26|             0.26|                -0.12|             0.38|             1.00|              -0.18|                        0.04|          0.41|               0.38|                -0.13|              0.12|             0.18|                -0.12|             0.20|             0.33|              -0.12|                        0.04|          0.22|               0.23|                -0.14|              0.13|             0.18|                -0.13|             0.19|             0.29|              -0.14|                        0.02|          0.20|               0.15|                -0.09|              0.11|             0.15|                -0.08|             0.17|             0.27|              -0.14|                       -0.01|          0.20|               0.13|                -0.12|              0.09|             0.13|                -0.11|             0.17|             0.23|              -0.12|                       -0.02|          0.20|               0.11|                -0.12|              0.10|             0.20|                -0.06|             0.20|             0.25|              -0.17|                        0.01|          0.22|               0.10|\n|self_confidence_w1          |                 0.29|             -0.18|            -0.08|                 0.26|            -0.18|            -0.18|               1.00|                        0.23|         -0.26|              -0.12|                 0.20|             -0.16|            -0.09|                 0.16|            -0.11|            -0.17|               0.44|                        0.17|         -0.19|              -0.09|                 0.17|             -0.15|            -0.05|                 0.15|            -0.12|            -0.13|               0.39|                        0.17|         -0.16|               0.00|                 0.12|             -0.10|             0.00|                 0.11|            -0.11|            -0.08|               0.37|                        0.15|         -0.15|               0.00|                 0.12|             -0.13|            -0.01|                 0.09|            -0.13|            -0.09|               0.37|                        0.16|         -0.17|               0.02|                 0.10|             -0.11|            -0.05|                 0.08|            -0.10|            -0.10|               0.30|                        0.10|         -0.17|              -0.04|\n|higher_school_dependence_w1 |                 0.16|             -0.08|             0.08|                 0.17|             0.04|             0.04|               0.23|                        1.00|          0.01|               0.11|                 0.11|             -0.09|             0.07|                 0.11|             0.02|             0.00|               0.16|                        0.38|         -0.04|               0.10|                 0.11|             -0.09|             0.10|                 0.10|             0.04|             0.03|               0.13|                        0.35|          0.00|               0.17|                 0.07|             -0.07|             0.11|                 0.07|             0.05|             0.05|               0.10|                        0.31|          0.05|               0.22|                 0.08|             -0.08|             0.12|                 0.07|             0.04|             0.04|               0.11|                        0.30|          0.00|               0.20|                 0.09|             -0.05|             0.09|                 0.07|             0.08|             0.07|               0.10|                        0.20|          0.01|               0.04|\n|neg_esteem_w1               |                -0.29|              0.52|             0.42|                -0.23|             0.45|             0.41|              -0.26|                        0.01|          1.00|               0.55|                -0.17|              0.23|             0.25|                -0.14|             0.28|             0.22|              -0.18|                       -0.01|          0.38|               0.29|                -0.20|              0.22|             0.23|                -0.16|             0.27|             0.22|              -0.17|                        0.00|          0.37|               0.20|                -0.12|              0.18|             0.17|                -0.11|             0.24|             0.21|              -0.17|                       -0.03|          0.30|               0.15|                -0.13|              0.18|             0.15|                -0.12|             0.25|             0.17|              -0.15|                       -0.04|          0.34|               0.12|                -0.14|              0.17|             0.19|                -0.10|             0.23|             0.15|              -0.17|                        0.01|          0.32|               0.08|\n|academic_stress_w1          |                -0.26|              0.20|             0.72|                -0.16|             0.56|             0.38|              -0.12|                        0.11|          0.55|               1.00|                -0.14|              0.13|             0.38|                -0.09|             0.32|             0.20|              -0.09|                        0.07|          0.26|               0.45|                -0.17|              0.12|             0.33|                -0.11|             0.30|             0.16|              -0.10|                        0.06|          0.25|               0.31|                -0.11|              0.10|             0.26|                -0.06|             0.27|             0.16|              -0.08|                        0.03|          0.23|               0.28|                -0.12|              0.08|             0.21|                -0.07|             0.24|             0.08|              -0.08|                        0.01|          0.22|               0.19|                -0.09|              0.08|             0.22|                -0.05|             0.23|             0.13|              -0.10|                        0.05|          0.22|               0.10|\n|parent_attachment_w2        |                 0.59|             -0.18|            -0.28|                 0.42|            -0.22|            -0.13|               0.20|                        0.11|         -0.17|              -0.14|                 1.00|             -0.25|            -0.43|                 0.68|            -0.28|            -0.22|               0.27|                        0.15|         -0.21|              -0.23|                 0.59|             -0.20|            -0.25|                 0.41|            -0.18|            -0.14|               0.21|                        0.13|         -0.19|              -0.03|                 0.52|             -0.18|            -0.20|                 0.37|            -0.18|            -0.12|               0.20|                        0.11|         -0.15|               0.01|                 0.50|             -0.19|            -0.19|                 0.38|            -0.19|            -0.12|               0.18|                        0.10|         -0.19|              -0.01|                 0.44|             -0.18|            -0.18|                 0.33|            -0.13|            -0.09|               0.15|                        0.05|         -0.18|              -0.07|\n|deviant_esteem_w2           |                -0.20|              0.40|             0.20|                -0.17|             0.22|             0.12|              -0.16|                       -0.09|          0.23|               0.13|                -0.25|              1.00|             0.34|                -0.21|             0.38|             0.41|              -0.07|                       -0.12|          0.35|               0.24|                -0.19|              0.41|             0.13|                -0.18|             0.19|             0.20|              -0.10|                       -0.10|          0.19|               0.02|                -0.14|              0.34|             0.13|                -0.15|             0.16|             0.16|              -0.10|                       -0.11|          0.18|              -0.02|                -0.14|              0.35|             0.10|                -0.13|             0.15|             0.14|              -0.09|                       -0.09|          0.17|              -0.05|                -0.11|              0.31|             0.09|                -0.10|             0.11|             0.13|              -0.10|                       -0.04|          0.17|              -0.01|\n|parent_stress_w2            |                -0.29|              0.18|             0.48|                -0.16|             0.31|             0.18|              -0.09|                        0.07|          0.25|               0.38|                -0.43|              0.34|             1.00|                -0.24|             0.58|             0.47|              -0.04|                        0.06|          0.33|               0.77|                -0.30|              0.17|             0.43|                -0.18|             0.30|             0.22|              -0.10|                        0.06|          0.22|               0.28|                -0.25|              0.14|             0.37|                -0.16|             0.26|             0.18|              -0.10|                        0.06|          0.23|               0.24|                -0.25|              0.15|             0.35|                -0.16|             0.25|             0.17|              -0.08|                        0.04|          0.21|               0.20|                -0.20|              0.13|             0.31|                -0.13|             0.21|             0.15|              -0.07|                        0.06|          0.19|               0.09|\n|parent_monitoring_w2        |                 0.44|             -0.19|            -0.16|                 0.51|            -0.17|            -0.12|               0.16|                        0.11|         -0.14|              -0.09|                 0.68|             -0.21|            -0.24|                 1.00|            -0.21|            -0.17|               0.21|                        0.20|         -0.14|              -0.16|                 0.43|             -0.17|            -0.13|                 0.52|            -0.13|            -0.11|               0.18|                        0.14|         -0.12|               0.01|                 0.37|             -0.15|            -0.11|                 0.44|            -0.16|            -0.10|               0.15|                        0.14|         -0.10|               0.04|                 0.39|             -0.15|            -0.11|                 0.45|            -0.15|            -0.10|               0.13|                        0.15|         -0.11|               0.04|                 0.33|             -0.16|            -0.10|                 0.38|            -0.10|            -0.06|               0.12|                        0.07|         -0.13|              -0.01|\n|desire_stress_w2            |                -0.23|              0.23|             0.32|                -0.18|             0.48|             0.20|              -0.11|                        0.02|          0.28|               0.32|                -0.28|              0.38|             0.58|                -0.21|             1.00|             0.54|              -0.03|                        0.01|          0.33|               0.59|                -0.19|              0.19|             0.27|                -0.16|             0.46|             0.23|              -0.11|                       -0.01|          0.25|               0.24|                -0.16|              0.16|             0.23|                -0.11|             0.40|             0.19|              -0.12|                        0.03|          0.22|               0.20|                -0.16|              0.15|             0.22|                -0.13|             0.37|             0.18|              -0.07|                        0.00|          0.19|               0.15|                -0.16|              0.15|             0.22|                -0.14|             0.35|             0.18|              -0.11|                        0.02|          0.19|               0.06|\n|friend_stress_w2            |                -0.19|              0.20|             0.20|                -0.15|             0.25|             0.33|              -0.17|                        0.00|          0.22|               0.20|                -0.22|              0.41|             0.47|                -0.17|             0.54|             1.00|              -0.11|                       -0.01|          0.33|               0.48|                -0.17|              0.20|             0.20|                -0.14|             0.22|             0.33|              -0.16|                        0.00|          0.22|               0.14|                -0.13|              0.17|             0.20|                -0.11|             0.21|             0.29|              -0.14|                        0.00|          0.21|               0.12|                -0.15|              0.17|             0.18|                -0.11|             0.20|             0.28|              -0.14|                        0.00|          0.21|               0.12|                -0.13|              0.20|             0.20|                -0.09|             0.20|             0.26|              -0.13|                        0.04|          0.21|               0.06|\n|self_confidence_w2          |                 0.17|             -0.13|            -0.06|                 0.17|            -0.08|            -0.12|               0.44|                        0.16|         -0.18|              -0.09|                 0.27|             -0.07|            -0.04|                 0.21|            -0.03|            -0.11|               1.00|                        0.21|         -0.26|              -0.06|                 0.15|             -0.16|            -0.03|                 0.13|            -0.08|            -0.13|               0.41|                        0.17|         -0.21|               0.00|                 0.12|             -0.12|            -0.02|                 0.11|            -0.10|            -0.11|               0.36|                        0.19|         -0.16|              -0.02|                 0.10|             -0.14|            -0.01|                 0.07|            -0.10|            -0.13|               0.36|                        0.16|         -0.17|              -0.01|                 0.09|             -0.13|            -0.06|                 0.06|            -0.08|            -0.09|               0.34|                        0.07|         -0.17|              -0.04|\n|higher_school_dependence_w2 |                 0.11|             -0.13|             0.04|                 0.14|            -0.01|             0.04|               0.17|                        0.38|         -0.01|               0.07|                 0.15|             -0.12|             0.06|                 0.20|             0.01|            -0.01|               0.21|                        1.00|         -0.01|               0.12|                 0.11|             -0.10|             0.08|                 0.12|             0.01|             0.02|               0.12|                        0.43|         -0.02|               0.17|                 0.07|             -0.10|             0.09|                 0.10|             0.00|             0.02|               0.11|                        0.41|          0.04|               0.22|                 0.09|             -0.11|             0.11|                 0.08|             0.02|             0.04|               0.11|                        0.38|          0.00|               0.22|                 0.06|             -0.06|             0.08|                 0.06|             0.06|             0.04|               0.08|                        0.27|          0.01|               0.06|\n|neg_esteem_w2               |                -0.18|              0.22|             0.22|                -0.15|             0.22|             0.22|              -0.19|                       -0.04|          0.38|               0.26|                -0.21|              0.35|             0.33|                -0.14|             0.33|             0.33|              -0.26|                       -0.01|          1.00|               0.38|                -0.20|              0.19|             0.17|                -0.16|             0.22|             0.21|              -0.20|                        0.00|          0.36|               0.14|                -0.15|              0.19|             0.17|                -0.16|             0.23|             0.21|              -0.20|                       -0.04|          0.34|               0.15|                -0.17|              0.18|             0.15|                -0.11|             0.22|             0.19|              -0.18|                       -0.05|          0.33|               0.09|                -0.14|              0.17|             0.16|                -0.10|             0.15|             0.16|              -0.15|                       -0.02|          0.28|               0.08|\n|academic_stress_w2          |                -0.19|              0.13|             0.37|                -0.12|             0.32|             0.23|              -0.09|                        0.10|          0.29|               0.45|                -0.23|              0.24|             0.77|                -0.16|             0.59|             0.48|              -0.06|                        0.12|          0.38|               1.00|                -0.18|              0.09|             0.34|                -0.12|             0.31|             0.22|              -0.12|                        0.09|          0.25|               0.37|                -0.14|              0.09|             0.29|                -0.10|             0.28|             0.21|              -0.13|                        0.09|          0.27|               0.35|                -0.16|              0.09|             0.28|                -0.10|             0.27|             0.18|              -0.10|                        0.07|          0.23|               0.28|                -0.13|              0.08|             0.25|                -0.09|             0.25|             0.15|              -0.08|                        0.08|          0.19|               0.12|\n|parent_attachment_w3        |                 0.53|             -0.19|            -0.28|                 0.39|            -0.21|            -0.14|               0.17|                        0.11|         -0.20|              -0.17|                 0.59|             -0.19|            -0.30|                 0.43|            -0.19|            -0.17|               0.15|                        0.11|         -0.20|              -0.18|                 1.00|             -0.27|            -0.43|                 0.66|            -0.26|            -0.21|               0.29|                        0.13|         -0.27|              -0.09|                 0.61|             -0.22|            -0.28|                 0.42|            -0.20|            -0.17|               0.19|                        0.13|         -0.18|              -0.01|                 0.55|             -0.20|            -0.24|                 0.38|            -0.21|            -0.15|               0.18|                        0.13|         -0.22|              -0.03|                 0.49|             -0.18|            -0.24|                 0.37|            -0.14|            -0.12|               0.15|                        0.06|         -0.21|              -0.09|\n|deviant_esteem_w3           |                -0.19|              0.40|             0.19|                -0.17|             0.18|             0.13|              -0.15|                       -0.09|          0.22|               0.12|                -0.20|              0.41|             0.17|                -0.17|             0.19|             0.20|              -0.16|                       -0.10|          0.19|               0.09|                -0.27|              1.00|             0.27|                -0.21|             0.30|             0.34|              -0.18|                       -0.13|          0.41|               0.06|                -0.18|              0.47|             0.19|                -0.16|             0.19|             0.22|              -0.15|                       -0.12|          0.23|              -0.01|                -0.16|              0.42|             0.13|                -0.13|             0.15|             0.16|              -0.12|                       -0.12|          0.21|              -0.04|                -0.14|              0.39|             0.12|                -0.13|             0.13|             0.16|              -0.14|                       -0.08|          0.21|              -0.01|\n|parent_stress_w3            |                -0.22|              0.12|             0.40|                -0.12|             0.25|             0.18|              -0.05|                        0.10|          0.23|               0.33|                -0.25|              0.13|             0.43|                -0.13|             0.27|             0.20|              -0.03|                        0.08|          0.17|               0.34|                -0.43|              0.27|             1.00|                -0.21|             0.50|             0.40|              -0.12|                        0.10|          0.32|               0.60|                -0.29|              0.17|             0.52|                -0.17|             0.28|             0.21|              -0.07|                        0.09|          0.23|               0.31|                -0.28|              0.13|             0.43|                -0.16|             0.28|             0.18|              -0.06|                        0.08|          0.23|               0.28|                -0.20|              0.13|             0.36|                -0.10|             0.20|             0.15|              -0.06|                        0.05|          0.19|               0.10|\n|parent_monitoring_w3        |                 0.38|             -0.19|            -0.18|                 0.46|            -0.17|            -0.13|               0.15|                        0.10|         -0.16|              -0.11|                 0.41|             -0.18|            -0.18|                 0.52|            -0.16|            -0.14|               0.13|                        0.12|         -0.16|              -0.12|                 0.66|             -0.21|            -0.21|                 1.00|            -0.22|            -0.16|               0.24|                        0.14|         -0.18|               0.00|                 0.41|             -0.18|            -0.17|                 0.51|            -0.19|            -0.14|               0.15|                        0.13|         -0.13|               0.02|                 0.39|             -0.18|            -0.14|                 0.47|            -0.18|            -0.13|               0.12|                        0.15|         -0.15|               0.02|                 0.34|             -0.19|            -0.14|                 0.44|            -0.13|            -0.10|               0.13|                        0.06|         -0.16|              -0.05|\n|desire_stress_w3            |                -0.17|              0.20|             0.28|                -0.13|             0.43|             0.19|              -0.12|                        0.04|          0.27|               0.30|                -0.18|              0.19|             0.30|                -0.13|             0.46|             0.22|              -0.08|                        0.01|          0.22|               0.31|                -0.26|              0.30|             0.50|                -0.22|             1.00|             0.43|              -0.18|                        0.00|          0.37|               0.44|                -0.20|              0.19|             0.31|                -0.14|             0.52|             0.24|              -0.16|                        0.01|          0.27|               0.27|                -0.18|              0.17|             0.26|                -0.14|             0.47|             0.20|              -0.10|                        0.01|          0.25|               0.20|                -0.16|              0.15|             0.26|                -0.12|             0.40|             0.18|              -0.13|                        0.03|          0.25|               0.10|\n|friend_stress_w3            |                -0.11|              0.16|             0.16|                -0.09|             0.17|             0.29|              -0.13|                        0.03|          0.22|               0.16|                -0.14|              0.20|             0.22|                -0.11|             0.23|             0.33|              -0.13|                        0.02|          0.21|               0.22|                -0.21|              0.34|             0.40|                -0.16|             0.43|             1.00|              -0.26|                        0.00|          0.38|               0.28|                -0.16|              0.22|             0.23|                -0.12|             0.23|             0.43|              -0.20|                        0.00|          0.26|               0.16|                -0.15|              0.19|             0.22|                -0.10|             0.21|             0.35|              -0.17|                        0.00|          0.27|               0.20|                -0.14|              0.18|             0.22|                -0.10|             0.22|             0.30|              -0.18|                        0.02|          0.27|               0.05|\n|self_confidence_w3          |                 0.19|             -0.10|            -0.06|                 0.15|            -0.10|            -0.14|               0.39|                        0.13|         -0.17|              -0.10|                 0.21|             -0.10|            -0.10|                 0.18|            -0.11|            -0.16|               0.41|                        0.12|         -0.20|              -0.12|                 0.29|             -0.18|            -0.12|                 0.24|            -0.18|            -0.26|               1.00|                        0.18|         -0.30|              -0.07|                 0.20|             -0.13|            -0.08|                 0.18|            -0.17|            -0.18|               0.48|                        0.13|         -0.24|              -0.06|                 0.18|             -0.11|            -0.06|                 0.12|            -0.15|            -0.17|               0.42|                        0.13|         -0.23|              -0.06|                 0.17|             -0.12|            -0.07|                 0.14|            -0.11|            -0.12|               0.40|                        0.08|         -0.23|              -0.04|\n|higher_school_dependence_w3 |                 0.10|             -0.12|             0.04|                 0.12|            -0.01|             0.02|               0.17|                        0.35|          0.00|               0.06|                 0.13|             -0.10|             0.06|                 0.14|            -0.01|             0.00|               0.17|                        0.43|          0.00|               0.09|                 0.13|             -0.13|             0.10|                 0.14|             0.00|             0.00|               0.18|                        1.00|          0.04|               0.26|                 0.10|             -0.11|             0.12|                 0.08|            -0.02|             0.04|               0.14|                        0.47|          0.04|               0.25|                 0.08|             -0.12|             0.14|                 0.06|             0.03|             0.04|               0.12|                        0.40|          0.00|               0.24|                 0.07|             -0.08|             0.09|                 0.06|             0.04|             0.05|               0.12|                        0.26|          0.01|               0.07|\n|neg_esteem_w3               |                -0.15|              0.19|             0.20|                -0.12|             0.22|             0.20|              -0.16|                        0.00|          0.37|               0.25|                -0.19|              0.19|             0.22|                -0.12|             0.25|             0.22|              -0.21|                       -0.02|          0.36|               0.25|                -0.27|              0.41|             0.32|                -0.18|             0.37|             0.38|              -0.30|                        0.04|          1.00|               0.38|                -0.19|              0.19|             0.22|                -0.14|             0.22|             0.27|              -0.24|                        0.03|          0.44|               0.22|                -0.17|              0.18|             0.19|                -0.09|             0.24|             0.24|              -0.20|                        0.00|          0.39|               0.18|                -0.17|              0.19|             0.21|                -0.10|             0.23|             0.24|              -0.23|                        0.00|          0.38|               0.07|\n|academic_stress_w3          |                -0.03|             -0.01|             0.22|                 0.01|             0.19|             0.15|               0.00|                        0.17|          0.20|               0.31|                -0.03|              0.02|             0.28|                 0.01|             0.24|             0.14|               0.00|                        0.17|          0.14|               0.37|                -0.09|              0.06|             0.60|                 0.00|             0.44|             0.28|              -0.07|                        0.26|          0.38|               1.00|                -0.06|             -0.03|             0.32|                -0.02|             0.23|             0.16|              -0.07|                        0.22|          0.24|               0.52|                -0.05|             -0.04|             0.28|                -0.01|             0.26|             0.16|              -0.04|                        0.18|          0.19|               0.41|                -0.04|             -0.01|             0.23|                 0.00|             0.21|             0.13|              -0.05|                        0.12|          0.16|               0.13|\n|parent_attachment_w4        |                 0.45|             -0.13|            -0.21|                 0.31|            -0.14|            -0.09|               0.12|                        0.07|         -0.12|              -0.11|                 0.52|             -0.14|            -0.25|                 0.37|            -0.16|            -0.13|               0.12|                        0.07|         -0.15|              -0.14|                 0.61|             -0.18|            -0.29|                 0.41|            -0.20|            -0.16|               0.20|                        0.10|         -0.19|              -0.06|                 1.00|             -0.20|            -0.44|                 0.69|            -0.25|            -0.19|               0.27|                        0.12|         -0.21|              -0.05|                 0.62|             -0.19|            -0.28|                 0.45|            -0.21|            -0.15|               0.19|                        0.12|         -0.22|              -0.07|                 0.52|             -0.18|            -0.24|                 0.38|            -0.12|            -0.11|               0.14|                        0.07|         -0.19|              -0.08|\n|deviant_esteem_w4           |                -0.16|              0.33|             0.17|                -0.15|             0.13|             0.11|              -0.10|                       -0.07|          0.18|               0.10|                -0.18|              0.34|             0.14|                -0.15|             0.16|             0.17|              -0.12|                       -0.10|          0.19|               0.09|                -0.22|              0.47|             0.17|                -0.18|             0.19|             0.22|              -0.13|                       -0.11|          0.19|              -0.03|                -0.20|              1.00|             0.26|                -0.22|             0.28|             0.36|              -0.15|                       -0.15|          0.46|              -0.04|                -0.19|              0.43|             0.15|                -0.16|             0.16|             0.16|              -0.12|                       -0.14|          0.21|              -0.04|                -0.14|              0.39|             0.12|                -0.12|             0.12|             0.17|              -0.12|                       -0.07|          0.22|               0.01|\n|parent_stress_w4            |                -0.18|              0.11|             0.33|                -0.09|             0.18|             0.15|               0.00|                        0.11|          0.17|               0.26|                -0.20|              0.13|             0.37|                -0.11|             0.23|             0.20|              -0.02|                        0.09|          0.17|               0.29|                -0.28|              0.19|             0.52|                -0.17|             0.31|             0.23|              -0.08|                        0.12|          0.22|               0.32|                -0.44|              0.26|             1.00|                -0.26|             0.45|             0.41|              -0.13|                        0.14|          0.39|               0.56|                -0.32|              0.16|             0.49|                -0.18|             0.31|             0.20|              -0.08|                        0.08|          0.27|               0.30|                -0.23|              0.18|             0.39|                -0.12|             0.24|             0.20|              -0.09|                        0.05|          0.24|               0.15|\n|parent_monitoring_w4        |                 0.35|             -0.15|            -0.13|                 0.38|            -0.11|            -0.08|               0.11|                        0.07|         -0.11|              -0.06|                 0.37|             -0.15|            -0.16|                 0.44|            -0.11|            -0.11|               0.11|                        0.10|         -0.16|              -0.10|                 0.42|             -0.16|            -0.17|                 0.51|            -0.14|            -0.12|               0.18|                        0.08|         -0.14|              -0.02|                 0.69|             -0.22|            -0.26|                 1.00|            -0.21|            -0.17|               0.22|                        0.13|         -0.18|              -0.01|                 0.46|             -0.18|            -0.19|                 0.54|            -0.15|            -0.12|               0.14|                        0.12|         -0.16|              -0.03|                 0.37|             -0.16|            -0.14|                 0.45|            -0.07|            -0.06|               0.09|                        0.05|         -0.14|              -0.04|\n|desire_stress_w4            |                -0.18|              0.15|             0.26|                -0.13|             0.36|             0.17|              -0.11|                        0.05|          0.24|               0.27|                -0.18|              0.16|             0.26|                -0.16|             0.40|             0.21|              -0.10|                        0.00|          0.23|               0.28|                -0.20|              0.19|             0.28|                -0.19|             0.52|             0.23|              -0.17|                       -0.02|          0.22|               0.23|                -0.25|              0.28|             0.45|                -0.21|             1.00|             0.40|              -0.23|                        0.01|          0.42|               0.44|                -0.22|              0.16|             0.27|                -0.17|             0.49|             0.19|              -0.14|                        0.01|          0.28|               0.22|                -0.16|              0.18|             0.23|                -0.13|             0.43|             0.17|              -0.15|                        0.02|          0.28|               0.10|\n|friend_stress_w4            |                -0.11|              0.14|             0.15|                -0.08|             0.14|             0.27|              -0.08|                        0.05|          0.21|               0.16|                -0.12|              0.16|             0.18|                -0.10|             0.19|             0.29|              -0.11|                        0.02|          0.21|               0.21|                -0.17|              0.22|             0.21|                -0.14|             0.24|             0.43|              -0.18|                        0.04|          0.27|               0.16|                -0.19|              0.36|             0.41|                -0.17|             0.40|             1.00|              -0.25|                        0.01|          0.45|               0.32|                -0.17|              0.23|             0.24|                -0.11|             0.24|             0.40|              -0.16|                       -0.01|          0.31|               0.20|                -0.13|              0.21|             0.26|                -0.09|             0.22|             0.36|              -0.17|                        0.05|          0.29|               0.11|\n|self_confidence_w4          |                 0.17|             -0.10|            -0.06|                 0.14|            -0.09|            -0.14|               0.37|                        0.10|         -0.17|              -0.08|                 0.20|             -0.10|            -0.10|                 0.15|            -0.12|            -0.14|               0.36|                        0.11|         -0.20|              -0.13|                 0.19|             -0.15|            -0.07|                 0.15|            -0.16|            -0.20|               0.48|                        0.14|         -0.24|              -0.07|                 0.27|             -0.15|            -0.13|                 0.22|            -0.23|            -0.25|               1.00|                        0.16|         -0.36|              -0.18|                 0.19|             -0.13|            -0.09|                 0.12|            -0.18|            -0.19|               0.51|                        0.14|         -0.30|              -0.10|                 0.17|             -0.12|            -0.10|                 0.12|            -0.12|            -0.14|               0.44|                        0.06|         -0.24|              -0.07|\n|higher_school_dependence_w4 |                 0.13|             -0.13|             0.02|                 0.15|            -0.01|            -0.01|               0.15|                        0.31|         -0.03|               0.03|                 0.11|             -0.11|             0.06|                 0.14|             0.03|             0.00|               0.19|                        0.41|         -0.04|               0.09|                 0.13|             -0.12|             0.09|                 0.13|             0.01|             0.00|               0.13|                        0.47|          0.03|               0.22|                 0.12|             -0.15|             0.14|                 0.13|             0.01|             0.01|               0.16|                        1.00|          0.07|               0.33|                 0.09|             -0.13|             0.14|                 0.08|             0.03|             0.04|               0.11|                        0.47|         -0.02|               0.25|                 0.09|             -0.07|             0.07|                 0.08|             0.05|             0.02|               0.10|                        0.30|          0.00|               0.04|\n|neg_esteem_w4               |                -0.13|              0.13|             0.20|                -0.08|             0.17|             0.20|              -0.15|                        0.05|          0.30|               0.23|                -0.15|              0.18|             0.23|                -0.10|             0.22|             0.21|              -0.16|                        0.04|          0.34|               0.27|                -0.18|              0.23|             0.23|                -0.13|             0.27|             0.26|              -0.24|                        0.04|          0.44|               0.24|                -0.21|              0.46|             0.39|                -0.18|             0.42|             0.45|              -0.36|                        0.07|          1.00|               0.44|                -0.19|              0.19|             0.23|                -0.12|             0.27|             0.24|              -0.22|                       -0.01|          0.43|               0.19|                -0.13|              0.18|             0.20|                -0.09|             0.22|             0.22|              -0.22|                        0.03|          0.38|               0.10|\n|academic_stress_w4          |                 0.00|             -0.07|             0.20|                 0.04|             0.17|             0.13|               0.00|                        0.22|          0.15|               0.28|                 0.01|             -0.02|             0.24|                 0.04|             0.20|             0.12|              -0.02|                        0.22|          0.15|               0.35|                -0.01|             -0.01|             0.31|                 0.02|             0.27|             0.16|              -0.06|                        0.25|          0.22|               0.52|                -0.05|             -0.04|             0.56|                -0.01|             0.44|             0.32|              -0.18|                        0.33|          0.44|               1.00|                -0.04|             -0.05|             0.31|                 0.00|             0.28|             0.17|              -0.11|                        0.21|          0.24|               0.47|                -0.02|             -0.01|             0.23|                 0.01|             0.25|             0.14|              -0.11|                        0.16|          0.22|               0.17|\n|parent_attachment_w5        |                 0.45|             -0.15|            -0.21|                 0.33|            -0.16|            -0.12|               0.12|                        0.08|         -0.13|              -0.12|                 0.50|             -0.14|            -0.25|                 0.39|            -0.16|            -0.15|               0.10|                        0.09|         -0.17|              -0.16|                 0.55|             -0.16|            -0.28|                 0.39|            -0.18|            -0.15|               0.18|                        0.08|         -0.17|              -0.05|                 0.62|             -0.19|            -0.32|                 0.46|            -0.22|            -0.17|               0.19|                        0.09|         -0.19|              -0.04|                 1.00|             -0.24|            -0.45|                 0.71|            -0.32|            -0.21|               0.26|                        0.13|         -0.32|              -0.14|                 0.59|             -0.21|            -0.30|                 0.43|            -0.16|            -0.12|               0.18|                        0.08|         -0.24|              -0.09|\n|deviant_esteem_w5           |                -0.16|              0.33|             0.13|                -0.14|             0.14|             0.09|              -0.13|                       -0.08|          0.18|               0.08|                -0.19|              0.35|             0.15|                -0.15|             0.15|             0.17|              -0.14|                       -0.11|          0.18|               0.09|                -0.20|              0.42|             0.13|                -0.18|             0.17|             0.19|              -0.11|                       -0.12|          0.18|              -0.04|                -0.19|              0.43|             0.16|                -0.18|             0.16|             0.23|              -0.13|                       -0.13|          0.19|              -0.05|                -0.24|              1.00|             0.23|                -0.20|             0.24|             0.33|              -0.17|                       -0.16|          0.44|              -0.03|                -0.18|              0.47|             0.15|                -0.16|             0.13|             0.20|              -0.13|                       -0.08|          0.24|               0.02|\n|parent_stress_w5            |                -0.16|              0.09|             0.28|                -0.09|             0.18|             0.13|              -0.01|                        0.12|          0.15|               0.21|                -0.19|              0.10|             0.35|                -0.11|             0.22|             0.18|              -0.01|                        0.11|          0.15|               0.28|                -0.24|              0.13|             0.43|                -0.14|             0.26|             0.22|              -0.06|                        0.14|          0.19|               0.28|                -0.28|              0.15|             0.49|                -0.19|             0.27|             0.24|              -0.09|                        0.14|          0.23|               0.31|                -0.45|              0.23|             1.00|                -0.26|             0.50|             0.41|              -0.13|                        0.18|          0.41|               0.66|                -0.29|              0.18|             0.48|                -0.17|             0.29|             0.22|              -0.11|                        0.08|          0.27|               0.15|\n|parent_monitoring_w5        |                 0.34|             -0.14|            -0.13|                 0.39|            -0.15|            -0.11|               0.09|                        0.07|         -0.12|              -0.07|                 0.38|             -0.13|            -0.16|                 0.45|            -0.13|            -0.11|               0.07|                        0.08|         -0.11|              -0.10|                 0.38|             -0.13|            -0.16|                 0.47|            -0.14|            -0.10|               0.12|                        0.06|         -0.09|              -0.01|                 0.45|             -0.16|            -0.18|                 0.54|            -0.17|            -0.11|               0.12|                        0.08|         -0.12|               0.00|                 0.71|             -0.20|            -0.26|                 1.00|            -0.23|            -0.13|               0.16|                        0.12|         -0.17|              -0.05|                 0.43|             -0.17|            -0.18|                 0.51|            -0.12|            -0.06|               0.12|                        0.05|         -0.16|              -0.07|\n|desire_stress_w5            |                -0.16|              0.17|             0.22|                -0.14|             0.36|             0.17|              -0.13|                        0.04|          0.25|               0.24|                -0.19|              0.15|             0.25|                -0.15|             0.37|             0.20|              -0.10|                        0.02|          0.22|               0.27|                -0.21|              0.15|             0.28|                -0.18|             0.47|             0.21|              -0.15|                        0.03|          0.24|               0.26|                -0.21|              0.16|             0.31|                -0.15|             0.49|             0.24|              -0.18|                        0.03|          0.27|               0.28|                -0.32|              0.24|             0.50|                -0.23|             1.00|             0.43|              -0.19|                        0.04|          0.45|               0.44|                -0.25|              0.19|             0.33|                -0.18|             0.50|             0.23|              -0.18|                        0.02|          0.32|               0.14|\n|friend_stress_w5            |                -0.09|              0.12|             0.08|                -0.08|             0.11|             0.23|              -0.09|                        0.04|          0.17|               0.08|                -0.12|              0.14|             0.17|                -0.10|             0.18|             0.28|              -0.13|                        0.04|          0.19|               0.18|                -0.15|              0.16|             0.18|                -0.13|             0.20|             0.35|              -0.17|                        0.04|          0.24|               0.16|                -0.15|              0.16|             0.20|                -0.12|             0.19|             0.40|              -0.19|                        0.04|          0.24|               0.17|                -0.21|              0.33|             0.41|                -0.13|             0.43|             1.00|              -0.27|                        0.06|          0.42|               0.40|                -0.17|              0.20|             0.27|                -0.09|             0.22|             0.37|              -0.20|                        0.02|          0.27|               0.07|\n|self_confidence_w5          |                 0.16|             -0.09|            -0.07|                 0.12|            -0.08|            -0.12|               0.37|                        0.11|         -0.15|              -0.08|                 0.18|             -0.09|            -0.08|                 0.13|            -0.07|            -0.14|               0.36|                        0.11|         -0.18|              -0.10|                 0.18|             -0.12|            -0.06|                 0.12|            -0.10|            -0.17|               0.42|                        0.12|         -0.20|              -0.04|                 0.19|             -0.12|            -0.08|                 0.14|            -0.14|            -0.16|               0.51|                        0.11|         -0.22|              -0.11|                 0.26|             -0.17|            -0.13|                 0.16|            -0.19|            -0.27|               1.00|                        0.15|         -0.39|              -0.15|                 0.19|             -0.15|            -0.12|                 0.11|            -0.14|            -0.18|               0.50|                        0.06|         -0.30|              -0.09|\n|higher_school_dependence_w5 |                 0.11|             -0.16|             0.01|                 0.13|            -0.01|            -0.02|               0.16|                        0.30|         -0.04|               0.01|                 0.10|             -0.09|             0.04|                 0.15|             0.00|             0.00|               0.16|                        0.38|         -0.05|               0.07|                 0.13|             -0.12|             0.08|                 0.15|             0.01|             0.00|               0.13|                        0.40|          0.00|               0.18|                 0.12|             -0.14|             0.08|                 0.12|             0.01|            -0.01|               0.14|                        0.47|         -0.01|               0.21|                 0.13|             -0.16|             0.18|                 0.12|             0.04|             0.06|               0.15|                        1.00|         -0.02|               0.34|                 0.07|             -0.10|             0.10|                 0.08|             0.07|             0.04|               0.11|                        0.36|          0.00|               0.09|\n|neg_esteem_w5               |                -0.14|              0.18|             0.19|                -0.10|             0.18|             0.20|              -0.17|                        0.00|          0.34|               0.22|                -0.19|              0.17|             0.21|                -0.11|             0.19|             0.21|              -0.17|                        0.00|          0.33|               0.23|                -0.22|              0.21|             0.23|                -0.15|             0.25|             0.27|              -0.23|                        0.00|          0.39|               0.19|                -0.22|              0.21|             0.27|                -0.16|             0.28|             0.31|              -0.30|                       -0.02|          0.43|               0.24|                -0.32|              0.44|             0.41|                -0.17|             0.45|             0.42|              -0.39|                       -0.02|          1.00|               0.38|                -0.24|              0.25|             0.30|                -0.14|             0.26|             0.26|              -0.28|                        0.01|          0.49|               0.14|\n|academic_stress_w5          |                 0.01|             -0.05|             0.14|                 0.03|             0.12|             0.11|               0.02|                        0.20|          0.12|               0.19|                -0.01|             -0.05|             0.20|                 0.04|             0.15|             0.12|              -0.01|                        0.22|          0.09|               0.28|                -0.03|             -0.04|             0.28|                 0.02|             0.20|             0.20|              -0.06|                        0.24|          0.18|               0.41|                -0.07|             -0.04|             0.30|                -0.03|             0.22|             0.20|              -0.10|                        0.25|          0.19|               0.47|                -0.14|             -0.03|             0.66|                -0.05|             0.44|             0.40|              -0.15|                        0.34|          0.38|               1.00|                -0.09|              0.00|             0.32|                -0.04|             0.29|             0.19|              -0.10|                        0.18|          0.23|               0.18|\n|parent_attachment_w6        |                 0.41|             -0.12|            -0.17|                 0.30|            -0.16|            -0.12|               0.10|                        0.09|         -0.14|              -0.09|                 0.44|             -0.11|            -0.20|                 0.33|            -0.16|            -0.13|               0.09|                        0.06|         -0.14|              -0.13|                 0.49|             -0.14|            -0.20|                 0.34|            -0.16|            -0.14|               0.17|                        0.07|         -0.17|              -0.04|                 0.52|             -0.14|            -0.23|                 0.37|            -0.16|            -0.13|               0.17|                        0.09|         -0.13|              -0.02|                 0.59|             -0.18|            -0.29|                 0.43|            -0.25|            -0.17|               0.19|                        0.07|         -0.24|              -0.09|                 1.00|             -0.22|            -0.50|                 0.68|            -0.28|            -0.20|               0.24|                        0.05|         -0.32|              -0.13|\n|deviant_esteem_w6           |                -0.18|              0.31|             0.12|                -0.17|             0.11|             0.10|              -0.11|                       -0.05|          0.17|               0.08|                -0.18|              0.31|             0.13|                -0.16|             0.15|             0.20|              -0.13|                       -0.06|          0.17|               0.08|                -0.18|              0.39|             0.13|                -0.19|             0.15|             0.18|              -0.12|                       -0.08|          0.19|              -0.01|                -0.18|              0.39|             0.18|                -0.16|             0.18|             0.21|              -0.12|                       -0.07|          0.18|              -0.01|                -0.21|              0.47|             0.18|                -0.17|             0.19|             0.20|              -0.15|                       -0.10|          0.25|               0.00|                -0.22|              1.00|             0.24|                -0.19|             0.22|             0.35|              -0.23|                       -0.04|          0.48|               0.01|\n|parent_stress_w6            |                -0.17|              0.10|             0.27|                -0.09|             0.21|             0.20|              -0.05|                        0.09|          0.19|               0.22|                -0.18|              0.09|             0.31|                -0.10|             0.22|             0.20|              -0.06|                        0.08|          0.16|               0.25|                -0.24|              0.12|             0.36|                -0.14|             0.26|             0.22|              -0.07|                        0.09|          0.21|               0.23|                -0.24|              0.12|             0.39|                -0.14|             0.23|             0.26|              -0.10|                        0.07|          0.20|               0.23|                -0.30|              0.15|             0.48|                -0.18|             0.33|             0.27|              -0.12|                        0.10|          0.30|               0.32|                -0.50|              0.24|             1.00|                -0.24|             0.49|             0.43|              -0.19|                        0.10|          0.41|               0.34|\n|parent_monitoring_w6        |                 0.33|             -0.11|            -0.11|                 0.38|            -0.12|            -0.06|               0.08|                        0.07|         -0.10|              -0.05|                 0.33|             -0.10|            -0.13|                 0.38|            -0.14|            -0.09|               0.06|                        0.06|         -0.10|              -0.09|                 0.37|             -0.13|            -0.10|                 0.44|            -0.12|            -0.10|               0.14|                        0.06|         -0.10|               0.00|                 0.38|             -0.12|            -0.12|                 0.45|            -0.13|            -0.09|               0.12|                        0.08|         -0.09|               0.01|                 0.43|             -0.16|            -0.17|                 0.51|            -0.18|            -0.09|               0.11|                        0.08|         -0.14|              -0.04|                 0.68|             -0.19|            -0.24|                 1.00|            -0.23|            -0.11|               0.15|                        0.04|         -0.19|              -0.11|\n|desire_stress_w6            |                -0.10|              0.13|             0.20|                -0.09|             0.35|             0.20|              -0.10|                        0.08|          0.23|               0.23|                -0.13|              0.11|             0.21|                -0.10|             0.35|             0.20|              -0.08|                        0.06|          0.15|               0.25|                -0.14|              0.13|             0.20|                -0.13|             0.40|             0.22|              -0.11|                        0.04|          0.23|               0.21|                -0.12|              0.12|             0.24|                -0.07|             0.43|             0.22|              -0.12|                        0.05|          0.22|               0.25|                -0.16|              0.13|             0.29|                -0.12|             0.50|             0.22|              -0.14|                        0.07|          0.26|               0.29|                -0.28|              0.22|             0.49|                -0.23|             1.00|             0.44|              -0.24|                        0.09|          0.43|               0.24|\n|friend_stress_w6            |                -0.08|              0.11|             0.09|                -0.07|             0.16|             0.25|              -0.10|                        0.07|          0.15|               0.13|                -0.09|              0.13|             0.15|                -0.06|             0.18|             0.26|              -0.09|                        0.04|          0.16|               0.15|                -0.12|              0.16|             0.15|                -0.10|             0.18|             0.30|              -0.12|                        0.05|          0.24|               0.13|                -0.11|              0.17|             0.20|                -0.06|             0.17|             0.36|              -0.14|                        0.02|          0.22|               0.14|                -0.12|              0.20|             0.22|                -0.06|             0.23|             0.37|              -0.18|                        0.04|          0.26|               0.19|                -0.20|              0.35|             0.43|                -0.11|             0.44|             1.00|              -0.30|                        0.08|          0.40|               0.18|\n|self_confidence_w6          |                 0.11|             -0.11|            -0.08|                 0.09|            -0.11|            -0.17|               0.30|                        0.10|         -0.17|              -0.10|                 0.15|             -0.10|            -0.07|                 0.12|            -0.11|            -0.13|               0.34|                        0.08|         -0.15|              -0.08|                 0.15|             -0.14|            -0.06|                 0.13|            -0.13|            -0.18|               0.40|                        0.12|         -0.23|              -0.05|                 0.14|             -0.12|            -0.09|                 0.09|            -0.15|            -0.17|               0.44|                        0.10|         -0.22|              -0.11|                 0.18|             -0.13|            -0.11|                 0.12|            -0.18|            -0.20|               0.50|                        0.11|         -0.28|              -0.10|                 0.24|             -0.23|            -0.19|                 0.15|            -0.24|            -0.30|               1.00|                        0.03|         -0.44|              -0.14|\n|higher_school_dependence_w6 |                 0.04|             -0.06|             0.03|                 0.07|             0.01|             0.01|               0.10|                        0.20|          0.01|               0.05|                 0.05|             -0.04|             0.06|                 0.07|             0.02|             0.04|               0.07|                        0.27|         -0.02|               0.08|                 0.06|             -0.08|             0.05|                 0.06|             0.03|             0.02|               0.08|                        0.26|          0.00|               0.12|                 0.07|             -0.07|             0.05|                 0.05|             0.02|             0.05|               0.06|                        0.30|          0.03|               0.16|                 0.08|             -0.08|             0.08|                 0.05|             0.02|             0.02|               0.06|                        0.36|          0.01|               0.18|                 0.05|             -0.04|             0.10|                 0.04|             0.09|             0.08|               0.03|                        1.00|          0.08|               0.13|\n|neg_esteem_w6               |                -0.15|              0.18|             0.18|                -0.12|             0.20|             0.22|              -0.17|                        0.01|          0.32|               0.22|                -0.18|              0.17|             0.19|                -0.13|             0.19|             0.21|              -0.17|                        0.01|          0.28|               0.19|                -0.21|              0.21|             0.19|                -0.16|             0.25|             0.27|              -0.23|                        0.01|          0.38|               0.16|                -0.19|              0.22|             0.24|                -0.14|             0.28|             0.29|              -0.24|                        0.00|          0.38|               0.22|                -0.24|              0.24|             0.27|                -0.16|             0.32|             0.27|              -0.30|                        0.00|          0.49|               0.23|                -0.32|              0.48|             0.41|                -0.19|             0.43|             0.40|              -0.44|                        0.08|          1.00|               0.19|\n|academic_stress_w6          |                -0.06|              0.02|             0.11|                -0.01|             0.07|             0.10|              -0.04|                        0.04|          0.08|               0.10|                -0.07|             -0.01|             0.09|                -0.01|             0.06|             0.06|              -0.04|                        0.06|          0.08|               0.12|                -0.09|             -0.01|             0.10|                -0.05|             0.10|             0.05|              -0.04|                        0.07|          0.07|               0.13|                -0.08|              0.01|             0.15|                -0.04|             0.10|             0.11|              -0.07|                        0.04|          0.10|               0.17|                -0.09|              0.02|             0.15|                -0.07|             0.14|             0.07|              -0.09|                        0.09|          0.14|               0.18|                -0.13|              0.01|             0.34|                -0.11|             0.24|             0.18|              -0.14|                        0.13|          0.19|               1.00|\n\n\n:::\n\n```{.r .cell-code}\n# corrplot을 사용하여 상관관계 히트맵 생성\ncorrplot(corr_matrix, \n         method = \"color\",\n         type = \"upper\", \n         order = \"hclust\",\n         tl.col = \"black\",\n         tl.cex = 0.7,\n         diag = FALSE,\n         title = \"요인 점수 간 상관관계\",\n         mar = c(0, 0, 1, 0))\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# ggplot2를 사용하여 상관관계 히트맵 생성\n# 데이터 구조 변환\ncorr_df <- melt(corr_matrix)\nnames(corr_df) <- c(\"Var1\", \"Var2\", \"value\")\n\n# 히트맵 생성\ncorrelation_heatmap_plot <- ggplot(corr_df, aes(Var1, Var2, fill = value)) +\n  geom_tile() +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 6),\n        axis.text.y = element_text(size = 6),\n        plot.title = element_text(hjust = 0.5)) +\n  labs(title = \"요인 점수 간 상관관계 히트맵\", x = \"\", y = \"\", fill = \"상관계수\") +\n  coord_fixed()\n\noutput_filename <- \"correlation_heatmap.png\"\n\n# ggsave 함수를 사용하여 저장\n# plot 인자에 저장할 플롯 객체를 지정합니다.\n# width와 height 인자로 그림의 크기를 조절할 수 있습니다 (인치 단위).\n# dpi 인자로 해상도를 조절합니다 (dots per inch). 보고서용은 300dpi 이상 권장.\nggsave(filename = output_filename,\n       plot = correlation_heatmap_plot, # 저장할 플롯 객체 지정\n       width = 8, # 너비 (인치)\n       height = 8, # 높이 (인치)\n       dpi = 300) # 해상도\n\n# 추가 분석: 높은 상관관계를 가진 변수 쌍 확인\n# 대각선 위쪽만 사용하여 중복 피함\nhigh_corr <- which(abs(corr_matrix) > 0.7 & upper.tri(corr_matrix), arr.ind = TRUE)\n\nif(nrow(high_corr) > 0) {\n  high_corr_pairs <- data.frame(\n    Var1 = rownames(corr_matrix)[high_corr[, 1]],\n    Var2 = colnames(corr_matrix)[high_corr[, 2]],\n    Correlation = corr_matrix[high_corr]\n  )\n  \n  # 상관계수 크기순으로 정렬\n  high_corr_pairs <- high_corr_pairs[order(abs(high_corr_pairs$Correlation), decreasing = TRUE), ]\n  \n  cat(\"\\n높은 상관관계(|r| > 0.7)를 가진 변수 쌍:\\n\")\n  print(high_corr_pairs)\n  kable(high_corr_pairs, caption = \"높은 상관관계를 가진 변수 쌍 (|r| > 0.7)\")\n} else {\n  cat(\"\\n상관계수 절댓값이 0.7을 초과하는 변수 쌍이 없습니다.\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n높은 상관관계(|r| > 0.7)를 가진 변수 쌍:\n                  Var1                 Var2 Correlation\n2     parent_stress_w2   academic_stress_w2   0.7699974\n1     parent_stress_w1   academic_stress_w1   0.7205420\n3 parent_attachment_w5 parent_monitoring_w5   0.7079990\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\nTable: 높은 상관관계를 가진 변수 쌍 (|r| > 0.7)\n\n|   |Var1                 |Var2                 | Correlation|\n|:--|:--------------------|:--------------------|-----------:|\n|2  |parent_stress_w2     |academic_stress_w2   |   0.7699974|\n|1  |parent_stress_w1     |academic_stress_w1   |   0.7205420|\n|3  |parent_attachment_w5 |parent_monitoring_w5 |   0.7079990|\n\n\n:::\n:::\n\n\n\n\n## 가중치 및 층화 정보 추가\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# df6_origin에서 가중치와 층화 정보를 추출\nif(\"wt2\" %in% names(df6_origin) && \"area\" %in% names(df6_origin)) {\n  # ID, wt2, area 칼럼 추출\n  weight_strata_df <- df6_origin[, c(\"id\", \"wt2\", \"area\")]\n  \n  # merged_df와 병합\n  merged_df <- merge(merged_df, weight_strata_df, by = \"id\", all.x = TRUE)\n  \n  # 가중치와 층화 정보가 제대로 추가되었는지 확인\n  print(\"가중치(wt2)와 층화정보(area) 확인:\")\n  print(summary(merged_df[, c(\"wt2\", \"area\")]))\n} else {\n  warning(\"df6_origin에 wt2 또는 area 칼럼이 없습니다.\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"가중치(wt2)와 층화정보(area) 확인:\"\n      wt2             area      \n Min.   :108.1   Min.   :100.0  \n 1st Qu.:185.5   1st Qu.:330.0  \n Median :223.2   Median :442.0  \n Mean   :239.6   Mean   :447.8  \n 3rd Qu.:275.7   3rd Qu.:612.0  \n Max.   :899.0   Max.   :791.0  \n NA's   :990     NA's   :616    \n```\n\n\n:::\n:::\n\n\n\n## 데이터 전처리 및 train test split\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 필요한 패키지 로드\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lattice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'caret'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:survival':\n\n    cluster\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(randomForest)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nrandomForest 4.7-1.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nType rfNews() to see new features/changes/bug fixes.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'randomForest'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    combine\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:ggplot2':\n\n    margin\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(pROC)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nType 'citation(\"pROC\")' for a citation.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'pROC'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr) # 데이터 전처리 및 변수 선택에 유용\nlibrary(stringr) # 변수 이름 처리에 유용 (grep 대신 사용 가능)\nlibrary(kableExtra) # 표 출력을 위해 추가 (kable 함수 사용 시 필요)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# 데이터 불러오기 (실제 데이터 불러오는 코드로 대체하세요)\n# merged_df <- read.csv(\"your_merged_panel_data.csv\")\n\n# --- 실제 데이터 변수명에 맞게 수정 ---\n# 아래 변수명 문자열들을 실제 데이터프레임의 컬럼 이름과 일치하도록 수정해야 합니다.\nID_VAR <- \"id\" # 개인 식별자 변수 이름\nWEIGHT_VAR <- \"wt2\" # 6차년도 종단면 가중치 변수 이름 (wt2가 6차년도 종단면 가중치 이름이라고 확인됨)\nOUTCOME_VAR <- \"status_category\" # 6차년도 진로 상황 변수 이름 (종속 변수 - 문자열 범주 컬럼 이름)\nSTRATA_VAR <- \"area\" # 6차년도 지역 변수 이름 (층화 변수)\n\n# 예측에 필요한 변수 선택\npred_vars <- names(merged_df)[grep(\"_w[1-6]$\", names(merged_df))] # W1부터 W6까지 변수 선택\n\nmodel_df <- merged_df %>%\n  select(!!sym(ID_VAR), !!sym(OUTCOME_VAR), !!sym(WEIGHT_VAR), !!sym(STRATA_VAR), all_of(pred_vars))\n\nmodel_df <- model_df %>%\n  filter(complete.cases(.)) # 선택된 모든 컬럼에 대해 결측치 없는 행만 남김\n\nprint(paste(\"전처리 후 결측치 없는 행 수:\", nrow(model_df)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"전처리 후 결측치 없는 행 수: 2451\"\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_df[[OUTCOME_VAR]] <- factor(model_df[[OUTCOME_VAR]])\n\nlevels(model_df[[OUTCOME_VAR]]) <- make.names(levels(model_df[[OUTCOME_VAR]]))\n\nprint(paste0(OUTCOME_VAR, \"의 팩터 레벨 (make.names 적용):\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"status_category의 팩터 레벨 (make.names 적용):\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(levels(model_df[[OUTCOME_VAR]]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"비경제활동및학업관련상태\" \"생산적활동참여\"          \n```\n\n\n:::\n\n```{.r .cell-code}\n# 예측 변수와 대상 변수 분리\nX <- model_df[, pred_vars]\ny <- model_df[[OUTCOME_VAR]] # status_category 사용\nweights <- model_df[[WEIGHT_VAR]] # wt2 사용\nstrata <- model_df[[STRATA_VAR]] # area 사용\n\n# 층화 추출을 사용한 훈련/테스트 데이터 분할 (70/30)\n# 종속변수 (y = status_category)를 기준으로 층화 분할\nset.seed(123) # 재현성을 위한 시드 설정\ntrain_index <- createDataPartition(y, p = 0.7, list = FALSE, times = 1)\n\n# 인덱스를 사용하여 X, y, weights, strata 분할\nX_train <- X[train_index, , drop = FALSE] # 변수가 하나일 경우 벡터가 아닌 데이터프레임 유지\nX_test <- X[-train_index, , drop = FALSE] # 변수가 하나일 경우 벡터가 아닌 데이터프레임 유지\ny_train <- y[train_index]\ny_test <- y[-train_index]\nweights_train <- weights[train_index]\nweights_test <- weights[-train_index]\nstrata_train <- strata[train_index]\nstrata_test <- strata[-train_index]\n\n# 훈련/테스트 세트 크기 확인\nprint(paste(\"훈련 세트 크기:\", nrow(X_train)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"훈련 세트 크기: 1717\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(paste(\"테스트 세트 크기:\", nrow(X_test)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"테스트 세트 크기: 734\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# 각 세트의 종속 변수 범주 분포 확인\nprint(\"훈련 세트 클래스 분포:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"훈련 세트 클래스 분포:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(table(y_train))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ny_train\n비경제활동및학업관련상태           생산적활동참여 \n                    1645                       72 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(\"테스트 세트 클래스 분포:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"테스트 세트 클래스 분포:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(table(y_test))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ny_test\n비경제활동및학업관련상태           생산적활동참여 \n                     704                       30 \n```\n\n\n:::\n:::\n\n\n\n\n## Random Forest 모델 학습 및 평가\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_model <- randomForest(\n  x = X_train,\n  y = y_train,\n  weights = weights_train,\n  ntree = 500,\n  mtry = floor(sqrt(ncol(X_train))),\n  importance = TRUE,\n  sampsize = table(y_train),\n  replace = TRUE\n)\n\n# 모델 요약 (선택 사항)\n# print(rf_model)\n\n# 변수 중요도 시각화 (선택 사항)\nvarImpPlot(rf_model)\n```\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# --- 모델 평가 (가중치 고려) ---\n# 테스트 세트에 대한 예측\ncat(\"\\n테스트 세트에 대해 예측 중...\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n테스트 세트에 대해 예측 중...\n```\n\n\n:::\n\n```{.r .cell-code}\ny_pred <- predict(rf_model, X_test)\ncat(\"예측 완료.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n예측 완료.\n```\n\n\n:::\n\n```{.r .cell-code}\n# 이전의 caret::confusionMatrix는 가중치를 고려하지 않았으므로 사용하지 않습니다.\n# print(confusionMatrix(y_pred, y_test))\n\n# 가중 혼동 행렬 계산 (수동 구현 - 가중치 반영)\nactual_classes <- y_test # 테스트 데이터의 실제 값\npredicted_classes <- y_pred # 테스트 데이터의 예측 값\ntest_weights <- weights_test # 테스트 데이터의 가중치\n\n# 종속 변수의 레벨 (가중 혼동 행렬 차원 정의에 사용)\noutcome_levels <- levels(actual_classes)\n\n# 가중 혼동 행렬 초기화\nweighted_confusion_matrix <- matrix(0,\n                                   nrow = length(outcome_levels),\n                                   ncol = length(outcome_levels),\n                                   dimnames = list(Actual = outcome_levels, Predicted = outcome_levels))\n\n# 각 테스트 데이터 개체에 대해 가중치 합산\nfor (i in 1:length(actual_classes)) {\n  actual_cat <- as.character(actual_classes[i])\n  predicted_cat <- as.character(predicted_classes[i])\n  weight <- test_weights[i]\n\n  # 해당 (실제, 예측) 셀에 가중치 합산\n  # 범주 레벨이 유효한지 확인하는 로직 추가 (예상치 못한 범주 오류 방지)\n   if (actual_cat %in% outcome_levels && predicted_cat %in% outcome_levels) {\n      weighted_confusion_matrix[actual_cat, predicted_cat] <- weighted_confusion_matrix[actual_cat, predicted_cat] + weight\n  } else {\n      warning(paste(\"유효하지 않은 범주 발견: 실제 =\", actual_cat, \", 예측 =\", predicted_cat, \"인 개체 (인덱스:\", i, \")\"))\n  }\n}\n\ncat(\"\\n=== 가중 혼동 행렬 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 가중 혼동 행렬 ===\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_confusion_matrix, 2)) # 보기 좋게 반올림하여 출력\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          Predicted\nActual                     비경제활동및학업관련상태 생산적활동참여\n  비경제활동및학업관련상태                166677.56           0.00\n  생산적활동참여                             356.02        6638.58\n```\n\n\n:::\n\n```{.r .cell-code}\n# 가중 혼동 행렬 기반 가중 성능 지표 계산\ntotal_weighted_sum <- sum(weighted_confusion_matrix)\n\n# 가중 정확도 (Weighted Accuracy)\nweighted_accuracy <- sum(diag(weighted_confusion_matrix)) / total_weighted_sum\ncat(\"\\n=== 가중 성능 지표 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 가중 성능 지표 ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"가중 정확도:\", round(weighted_accuracy, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n가중 정확도: 0.998 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 각 범주별 가중 정밀도, 재현율, F1-score 계산\nweighted_precision <- numeric(length(outcome_levels))\nweighted_recall <- numeric(length(outcome_levels))\nweighted_f1_score <- numeric(length(outcome_levels))\nnames(weighted_precision) <- names(weighted_recall) <- names(weighted_f1_score) <- outcome_levels\n\nfor (cat in outcome_levels) {\n  TP <- weighted_confusion_matrix[cat, cat]\n  FP <- sum(weighted_confusion_matrix[, cat]) - TP # 해당 열의 합 - TP\n  FN <- sum(weighted_confusion_matrix[cat, ]) - TP # 해당 행의 합 - TP\n\n  # 정밀도 (Precision): 예측된 cat 중 실제 cat 비율 (TP / (TP + FP))\n  # 분모가 0인 경우 (해당 범주로 예측된 개체가 하나도 없는 경우) 0으로 처리\n  weighted_precision[cat] <- ifelse((TP + FP) == 0, 0, TP / (TP + FP))\n\n  # 재현율 (Recall) 또는 민감도 (Sensitivity): 실제 cat인 것들 중 예측도 cat인 비율 (TP / (TP + FN))\n  # 분모가 0인 경우 (실제 해당 범주인 개체가 하나도 없는 경우) 0으로 처리\n  weighted_recall[cat] <- ifelse((TP + FN) == 0, 0, TP / (TP + FN))\n\n  # F1-score: 정밀도와 재현율의 조화 평균\n  # 분모가 0인 경우 0으로 처리\n  weighted_f1_score[cat] <- ifelse((weighted_precision[cat] + weighted_recall[cat]) == 0, 0,\n                                    2 * (weighted_precision[cat] * weighted_recall[cat]) / (weighted_precision[cat] + weighted_recall[cat]))\n}\n\ncat(\"\\n범주별 가중 정밀도:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n범주별 가중 정밀도:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_precision, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  0.9979                   1.0000 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n범주별 가중 재현율:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n범주별 가중 재현율:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_recall, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  1.0000                   0.9491 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n범주별 가중 F1-score:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n범주별 가중 F1-score:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_f1_score, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  0.9989                   0.9739 \n```\n\n\n:::\n\n```{.r .cell-code}\n# ROC 곡선 및 AUC (다중 클래스인 경우 one-vs-all 방식으로 계산)\n# predict 함수의 type = \"prob\"을 사용하여 클래스 확률 얻기\ny_pred_prob <- predict(rf_model, X_test, type = \"prob\")\n\n# 각 클래스에 대한 ROC 곡선 그리기 (비가중)\n# ROC 곡선 자체에 가중치 반영은 pROC 패키지로는 직접 어렵습니다.\n# 이 그래프는 비가중 결과를 시각화하는 것이므로 해석에 유의해야 합니다.\ncat(\"\\n비가중 ROC 곡선 (참고용):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n비가중 ROC 곡선 (참고용):\n```\n\n\n:::\n\n```{.r .cell-code}\nplot_roc <- function() {\n  num_classes <- length(levels(y_test))\n  if (num_classes <= 4 && num_classes > 0) { # 범주가 1개 이하이면 플롯 불가능\n    par(mfrow = c(2, ceiling(num_classes/2)))\n  } else if (num_classes > 4) {\n    par(mfrow = c(2, 2)) # 범주가 많으면 일부만 표시하거나 레이아웃 조정 필요\n    warning(\"범주가 4개 이상입니다. 일부 ROC 곡선만 표시될 수 있습니다. 레이아웃을 조정하거나 플롯 코드를 수정하세요.\")\n  } else {\n    cat(\"ROC 곡선을 그릴 범주가 부족합니다.\\n\")\n    return(numeric(0)) # 빈 numeric 반환\n  }\n\n\n  auc_values <- numeric(num_classes)\n  names(auc_values) <- levels(y_test)\n\n  for (i in 1:num_classes) {\n    class_label <- levels(y_test)[i]\n\n    if(class_label %in% unique(y_test) && class_label %in% colnames(y_pred_prob)) {\n      roc_obj <- roc(response = ifelse(y_test == class_label, 1, 0), predictor = y_pred_prob[, class_label])\n      auc_values[i] <- auc(roc_obj)\n      plot(roc_obj, main = paste(\"ROC for\", class_label, \"(Unweighted)\"), col = \"blue\", lwd = 2)\n      abline(a = 0, b = 1, lty = 2, col = \"gray\")\n      text(0.5, 0.3, paste(\"AUC =\", round(auc_values[i], 3)), col = \"red\")\n      } else {\n        cat(\"클래스\", class_label, \"에 대한 ROC 곡선을 그릴 수 없습니다 (데이터 부족).\\n\")\n        auc_values[i] <- NA # AUC 값에 NA 할당\n        plot.new() # 빈 플롯 생성\n        text(0.5, 0.5, paste(\"No ROC for\", class_label))\n      }\n  }\n  par(mfrow = c(1, 1))\n  return(auc_values)\n}\n\nauc_values_unweighted <- plot_roc()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting direction: controls < cases\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting direction: controls < cases\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](14_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncat(\"\\n각 클래스별 비가중 AUC:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n각 클래스별 비가중 AUC:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(data.frame(Class = levels(y_test), AUC_Unweighted = auc_values_unweighted))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                            Class AUC_Unweighted\n비경제활동및학업관련상태 비경제활동및학업관련상태      0.9643466\n생산적활동참여                     생산적활동참여      0.9643466\n```\n\n\n:::\n:::\n\n\n\n\n## 모델 튜닝\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 교차 검증 및 하이퍼파라미터 튜닝을 위한 설정\n# caret의 trainControl과 train 함수는 가중치를 지원하지만,\n# 교차 검증 과정 및 최종 성능 요약치는 기본적으로 가중치를 엄밀하게 반영하지 않습니다.\n# 가중치를 고려한 교차 검증 튜닝은 더 고급 기법이 필요합니다.\n# 여기서는 caret의 가중치 지원 기능을 사용하되, 최종 모델 평가 시에는 수동 가중치 계산을 사용합니다.\nctrl <- trainControl(\n  method = \"cv\",\n  number = 5,\n  savePredictions = \"final\",\n  classProbs = TRUE,\n  summaryFunction = multiClassSummary\n)\n\n# 튜닝할 파라미터 그리드 설정\nparam_grid <- expand.grid(\n  mtry = floor(sqrt(ncol(X_train))) # 예시: sqrt(p)만 시도. 필요 시 다른 값 추가 c(..., ...)\n)\n# 변수 개수가 1개이면 mtry=1로 설정\nif (ncol(X_train) == 1) {\n  param_grid <- expand.grid(mtry = 1)\n}\n\n\n# 가중치를 반영한 caret 모델 학습 (훈련 데이터 사용)\ncat(\"\\ncaret을 사용한 모델 튜닝 중 (가중치 반영)...\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncaret을 사용한 모델 튜닝 중 (가중치 반영)...\n```\n\n\n:::\n\n```{.r .cell-code}\n# metric = \"Accuracy\"는 튜닝 과정에서 최적 모델 선택 기준으로 사용됨 (비가중 기준)\nrf_tuned <- train(\n  x = X_train,\n  y = y_train,\n  method = \"rf\",\n  metric = \"Accuracy\", # 튜닝 기준으로 사용할 지표 (비가중 기준)\n  weights = weights_train, # 가중치 전달\n  trControl = ctrl,\n  tuneGrid = param_grid,\n  importance = TRUE,\n  ntree = 500\n)\ncat(\"모델 튜닝 완료.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n모델 튜닝 완료.\n```\n\n\n:::\n\n```{.r .cell-code}\n# 튜닝 결과 출력\nprint(rf_tuned)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRandom Forest \n\n1717 samples\n  61 predictor\n   2 classes: '비경제활동및학업관련상태', '생산적활동참여' \n\nNo pre-processing\nResampling: Cross-Validated (5 fold) \nSummary of sample sizes: 1373, 1374, 1373, 1374, 1374 \nResampling results:\n\n  logLoss     AUC        prAUC      Accuracy   Kappa      F1       \n  0.04544216  0.9847995  0.8909432  0.9982524  0.9773794  0.9990895\n  Sensitivity  Specificity  Pos_Pred_Value  Neg_Pred_Value  Precision  Recall\n  1            0.9580952    0.9981818       1               0.9981818  1     \n  Detection_Rate  Balanced_Accuracy\n  0.9580683       0.9790476        \n\nTuning parameter 'mtry' was held constant at a value of 7\n```\n\n\n:::\n\n```{.r .cell-code}\n# plot(rf_tuned) # 튜닝 결과 시각화 (선택 사항)\n\n# --- 튜닝된 모델 평가 (가중치 고려) ---\n# 최적의 튜닝 파라미터로 학습된 모델을 테스트 세트에 대해 평가\ncat(\"\\n튜닝된 모델의 테스트 세트 예측 중...\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n튜닝된 모델의 테스트 세트 예측 중...\n```\n\n\n:::\n\n```{.r .cell-code}\ny_pred_tuned <- predict(rf_tuned, X_test)\ncat(\"예측 완료.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n예측 완료.\n```\n\n\n:::\n\n```{.r .cell-code}\n# 튜닝된 모델의 가중 혼동 행렬 계산 (수동 구현)\nactual_classes_tuned <- y_test\npredicted_classes_tuned <- y_pred_tuned\ntest_weights_tuned <- weights_test\n\nweighted_confusion_matrix_tuned <- matrix(0,\n                                         nrow = length(levels(actual_classes_tuned)),\n                                         ncol = length(levels(actual_classes_tuned)),\n                                         dimnames = list(Actual = levels(actual_classes_tuned), Predicted = levels(actual_classes_tuned)))\n\nfor (i in 1:length(actual_classes_tuned)) {\n  actual_cat <- as.character(actual_classes_tuned[i])\n  predicted_cat <- as.character(predicted_classes_tuned[i])\n  weight <- test_weights_tuned[i]\n   if (actual_cat %in% levels(actual_classes_tuned) && predicted_cat %in% levels(actual_classes_tuned)) {\n      weighted_confusion_matrix_tuned[actual_cat, predicted_cat] <- weighted_confusion_matrix_tuned[actual_cat, predicted_cat] + weight\n  } else {\n      warning(paste(\"튜닝 모델: 유효하지 않은 범주 발견: 실제 =\", actual_cat, \", 예측 =\", predicted_cat, \"인 개체 (인덱스:\", i, \")\"))\n  }\n}\n\ncat(\"\\n=== 튜닝된 모델 가중 혼동 행렬 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 튜닝된 모델 가중 혼동 행렬 ===\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_confusion_matrix_tuned, 2)) # 보기 좋게 반올림하여 출력\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                          Predicted\nActual                     비경제활동및학업관련상태 생산적활동참여\n  비경제활동및학업관련상태                166677.56           0.00\n  생산적활동참여                             356.02        6638.58\n```\n\n\n:::\n\n```{.r .cell-code}\n# 튜닝된 모델의 가중 혼동 행렬 기반 가중 성능 지표 계산\ntotal_weighted_sum_tuned <- sum(weighted_confusion_matrix_tuned)\n\n# 가중 정확도 (Weighted Accuracy)\nweighted_accuracy_tuned <- sum(diag(weighted_confusion_matrix_tuned)) / total_weighted_sum_tuned\ncat(\"\\n=== 튜닝된 모델 가중 성능 지표 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 튜닝된 모델 가중 성능 지표 ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"가중 정확도:\", round(weighted_accuracy_tuned, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n가중 정확도: 0.998 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 각 범주별 가중 정밀도, 재현율, F1-score 계산\nweighted_precision_tuned <- numeric(length(levels(actual_classes_tuned)))\nweighted_recall_tuned <- numeric(length(levels(actual_classes_tuned)))\nweighted_f1_score_tuned <- numeric(length(levels(actual_classes_tuned)))\nnames(weighted_precision_tuned) <- names(weighted_recall_tuned) <- names(weighted_f1_score_tuned) <- levels(actual_classes_tuned)\n\nfor (cat in levels(actual_classes_tuned)) {\n  TP <- weighted_confusion_matrix_tuned[cat, cat]\n  FP <- sum(weighted_confusion_matrix_tuned[, cat]) - TP\n  FN <- sum(weighted_confusion_matrix_tuned[cat, ]) - TP\n\n  weighted_precision_tuned[cat] <- ifelse((TP + FP) == 0, 0, TP / (TP + FP))\n  weighted_recall_tuned[cat] <- ifelse((TP + FN) == 0, 0, TP / (TP + FN))\n  weighted_f1_score_tuned[cat] <- ifelse((weighted_precision_tuned[cat] + weighted_recall_tuned[cat]) == 0, 0,\n                                    2 * (weighted_precision_tuned[cat] * weighted_recall_tuned[cat]) / (weighted_precision_tuned[cat] + weighted_recall_tuned[cat]))\n}\n\ncat(\"\\n튜닝된 모델 범주별 가중 정밀도:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n튜닝된 모델 범주별 가중 정밀도:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_precision_tuned, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  0.9979                   1.0000 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n튜닝된 모델 범주별 가중 재현율:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n튜닝된 모델 범주별 가중 재현율:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_recall_tuned, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  1.0000                   0.9491 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n튜닝된 모델 범주별 가중 F1-score:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n튜닝된 모델 범주별 가중 F1-score:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(round(weighted_f1_score_tuned, 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n비경제활동및학업관련상태           생산적활동참여 \n                  0.9989                   0.9739 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 변수 중요도 (튜닝된 모델)\nimportance_obj_tuned <- varImp(rf_tuned)\n\nif(\"importance\" %in% names(importance_obj_tuned)) {\n  imp_df_tuned <- importance_obj_tuned$importance\n} else {\n  imp_df_tuned <- importance_obj_tuned\n}\n\nvar_names_tuned <- rownames(imp_df_tuned)\nif(\"Overall\" %in% colnames(imp_df_tuned)) {\n  var_importance_tuned <- imp_df_tuned$Overall\n} else {\n  var_importance_tuned <- imp_df_tuned[,1]\n}\n\nimportance_df_tuned <- data.frame(\n  Variable = var_names_tuned,\n  Importance = var_importance_tuned\n)\nimportance_df_tuned <- importance_df_tuned[order(importance_df_tuned$Importance, decreasing = TRUE),]\n\n# 상위 10개 변수 출력 (튜닝된 모델)\ntop_vars_tuned <- head(importance_df_tuned$Variable, 10)\ncat(\"\\n튜닝된 모델에서 가장 중요한 변수 상위 10개:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n튜닝된 모델에서 가장 중요한 변수 상위 10개:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(top_vars_tuned)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"academic_stress_w6\"   \"parent_stress_w6\"     \"academic_stress_w5\"  \n [4] \"academic_stress_w3\"   \"parent_stress_w5\"     \"friend_stress_w5\"    \n [7] \"neg_esteem_w6\"        \"parent_attachment_w3\" \"deviant_esteem_w4\"   \n[10] \"desire_stress_w2\"    \n```\n\n\n:::\n:::\n\n\n\n\n## 최종 평가 및 결론\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 최종 모델 성능 요약 비교\n# 원 모델과 튜닝 모델의 가중 정확도 비교\nfinal_metrics <- data.frame(\n  Metric = c(\"가중 정확도\"), # 비가중 정확도 대신 가중 정확도만 비교\n  Original_Model = c(round(weighted_accuracy * 100, 2)),\n  Tuned_Model = c(round(weighted_accuracy_tuned * 100, 2))\n)\n\n# 결과 출력\ncat(\"\\n=== 최종 모델 가중 정확도 비교 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 최종 모델 가중 정확도 비교 ===\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(kable(final_metrics, caption = \"원본 모델 vs 튜닝 모델 가중 정확도 비교\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"format\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\nTable: 원본 모델 vs 튜닝 모델 가중 정확도 비교\n\n|Metric      | Original_Model| Tuned_Model|\n|:-----------|--------------:|-----------:|\n|가중 정확도 |           99.8|        99.8|\n```\n\n\n:::\n\n```{.r .cell-code}\n# 클래스별 가중 성능 지표 (튜닝된 모델 결과 사용 권장)\ncat(\"\\n=== 튜닝된 모델 범주별 가중 성능 지표 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 튜닝된 모델 범주별 가중 성능 지표 ===\n```\n\n\n:::\n\n```{.r .cell-code}\nclass_weighted_metrics_tuned <- data.frame(\n  Class = levels(y_test), # y_test 또는 actual_classes_tuned 사용 가능\n  Weighted_Precision = round(weighted_precision_tuned, 4),\n  Weighted_Recall = round(weighted_recall_tuned, 4),\n  Weighted_F1 = round(weighted_f1_score_tuned, 4)\n)\nprint(kable(class_weighted_metrics_tuned, caption = \"튜닝된 모델 클래스별 가중 성능 지표\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\nTable: 튜닝된 모델 클래스별 가중 성능 지표\n\n|                         |Class                    | Weighted_Precision| Weighted_Recall| Weighted_F1|\n|:------------------------|:------------------------|------------------:|---------------:|-----------:|\n|비경제활동및학업관련상태 |비경제활동및학업관련상태 |             0.9979|          1.0000|      0.9989|\n|생산적활동참여           |생산적활동참여           |             1.0000|          0.9491|      0.9739|\n```\n\n\n:::\n\n```{.r .cell-code}\n# 최종 변수 중요도 요약 (튜닝된 모델 결과 사용)\ncat(\"\\n=== 튜닝된 모델 변수 중요도 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 튜닝된 모델 변수 중요도 ===\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(kable(head(importance_df_tuned, 10), caption = \"튜닝된 모델 상위 10개 중요 변수 (가중치 고려 학습 결과)\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\nWarning in attr(x, \"align\"): 'xfun::attr()' is deprecated.\nUse 'xfun::attr2()' instead.\nSee help(\"Deprecated\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\nTable: 튜닝된 모델 상위 10개 중요 변수 (가중치 고려 학습 결과)\n\n|   |Variable             | Importance|\n|:--|:--------------------|----------:|\n|60 |academic_stress_w6   | 100.000000|\n|53 |parent_stress_w6     |  13.822783|\n|50 |academic_stress_w5   |  10.885128|\n|30 |academic_stress_w3   |   8.983960|\n|43 |parent_stress_w5     |   8.794158|\n|46 |friend_stress_w5     |   8.705503|\n|59 |neg_esteem_w6        |   8.343213|\n|21 |parent_attachment_w3 |   8.308916|\n|32 |deviant_esteem_w4    |   7.905172|\n|15 |desire_stress_w2     |   7.733016|\n```\n\n\n:::\n\n```{.r .cell-code}\n# 결론 요약\ncat(\"\\n=== 결론 요약 ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== 결론 요약 ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"1. 위 모델은 학생들의 진로 상태(\", OUTCOME_VAR, \")를 예측하기 위해 이전 시점의 요인 점수들을 독립변수로 활용했습니다.\\n\",\n  \"2. 6차년도 종단면 가중치(\", WEIGHT_VAR, \")를 모델 학습에 반영했으며, 테스트 데이터에서 가중치 고려 성능 평가를 수행했습니다.\\n\",\n  \"3. 랜덤 포레스트 모델의 원래 버전과 하이퍼파라미터 튜닝 버전 모두 학습 및 가중 평가했습니다.\\n\",\n  \"4. 최종 튜닝된 모델의 테스트 데이터에서의 **가중 정확도**는 약 \", round(weighted_accuracy_tuned * 100, 2), \"%입니다.\\n\",\n  \"5. 각 진로 상태 범주별 모델의 가중 정밀도, 가중 재현율, 가중 F1-score는 위의 '튜닝된 모델 범주별 가중 성능 지표' 표를 참고하십시오.\\n\",\n  \"6. 예측에 가장 중요한 변수는 위의 '튜닝된 모델 상위 10개 중요 변수' 표를 참고하십시오.\\n\",\n  \"7. 이 결과는 6차년도 종단면 가중치를 통해 원 모집단(1차 조사 시점의 중2 청소년들)에 대해 일정 수준 일반화하여 해석할 수 있습니다.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1. 위 모델은 학생들의 진로 상태( status_category )를 예측하기 위해 이전 시점의 요인 점수들을 독립변수로 활용했습니다.\n 2. 6차년도 종단면 가중치( wt2 )를 모델 학습에 반영했으며, 테스트 데이터에서 가중치 고려 성능 평가를 수행했습니다.\n 3. 랜덤 포레스트 모델의 원래 버전과 하이퍼파라미터 튜닝 버전 모두 학습 및 가중 평가했습니다.\n 4. 최종 튜닝된 모델의 테스트 데이터에서의 **가중 정확도**는 약  99.8 %입니다.\n 5. 각 진로 상태 범주별 모델의 가중 정밀도, 가중 재현율, 가중 F1-score는 위의 '튜닝된 모델 범주별 가중 성능 지표' 표를 참고하십시오.\n 6. 예측에 가장 중요한 변수는 위의 '튜닝된 모델 상위 10개 중요 변수' 표를 참고하십시오.\n 7. 이 결과는 6차년도 종단면 가중치를 통해 원 모집단(1차 조사 시점의 중2 청소년들)에 대해 일정 수준 일반화하여 해석할 수 있습니다.\n```\n\n\n:::\n:::\n",
    "supporting": [
      "14_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
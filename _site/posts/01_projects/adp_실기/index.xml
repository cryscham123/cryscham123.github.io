<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>김형훈의 학습 블로그</title>
<link>https://cryscham123.github.io/posts/01_projects/adp_실기/</link>
<atom:link href="https://cryscham123.github.io/posts/01_projects/adp_실기/index.xml" rel="self" type="application/rss+xml"/>
<description>ADP 실기를 준비해 봅시다.</description>
<image>
<url>https://cryscham123.github.io/profile.jpg</url>
<title>김형훈의 학습 블로그</title>
<link>https://cryscham123.github.io/posts/01_projects/adp_실기/</link>
</image>
<generator>quarto-1.5.56</generator>
<lastBuildDate>Thu, 03 Jul 2025 15:00:00 GMT</lastBuildDate>
<item>
  <title>포아송 과정</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/07.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">8-1</h3>
<div id="0bbdbfd2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gamma</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-5"></span>
<span id="cb1-6">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span></span>
<span id="cb1-9">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb1-10">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gamma.pdf(qs, alpha)</span>
<span id="cb1-11">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, qs)</span>
<span id="cb1-12">prior.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>9.889360237140306</code></pre>
</div>
</div>
<div id="914130ed" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> expo_pdf(t, lam):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> lam <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>lam <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t)</span>
<span id="cb3-3"></span>
<span id="cb3-4">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb3-5">likelihood1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expo_pdf(t1, prior.qs)</span>
<span id="cb3-6">post1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood1</span>
<span id="cb3-7">post1.normalize()</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 지수분포에서 모든 시행은 독립적</span></span>
<span id="cb3-10">t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb3-11">likelihood2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expo_pdf(t2, post1.qs)</span>
<span id="cb3-12">post2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> post1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood2</span>
<span id="cb3-13">post2.normalize()</span>
<span id="cb3-14"></span>
<span id="cb3-15">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"사전분포"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb3-16">post1.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1골 득점 후 사후분포"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb3-17">post2.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2골 득점 후 사후분포"</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb3-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"λ (게임당 골 수)"</span>)</span>
<span id="cb3-19">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"확률밀도"</span>)</span>
<span id="cb3-20">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"독일의 골 득점률 분포"</span>)</span>
<span id="cb3-21">plt.legend()</span>
<span id="cb3-22">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/07_files/figure-html/cell-3-output-1.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f07661e8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> poisson</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_poisson_pmf(lam, qs):</span>
<span id="cb4-6">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> poisson.pmf(qs, lam)</span>
<span id="cb4-7">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, qs)</span>
<span id="cb4-8">    pmf.normalize()</span>
<span id="cb4-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> pmf</span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_mixture(pmf, pmf_seq):</span>
<span id="cb4-12">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(pmf_seq).fillna(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).transpose()</span>
<span id="cb4-13">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> np.array(pmf)</span>
<span id="cb4-14">    total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Pmf(total)</span>
<span id="cb4-16"></span>
<span id="cb4-17">remaining_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb4-18">goals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb4-19">pmf_seq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [make_poisson_pmf(lam <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> remaining_time, goals) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> post2.qs]</span>
<span id="cb4-20">pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_mixture(post2, pmf_seq)</span>
<span id="cb4-21"></span>
<span id="cb4-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"예상 골 수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(pred.qs[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pred.ps[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pred.qs)))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">골"</span>)</span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 표준편차 수동 계산</span></span>
<span id="cb4-24">mean_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(pred.qs[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pred.ps[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pred.qs)))</span>
<span id="cb4-25">variance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>((pred.qs[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_val)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pred.ps[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pred.qs)))</span>
<span id="cb4-26">std_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> variance<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"표준편차: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>std_val<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">골"</span>)</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5골 이상 득점할 확률 계산</span></span>
<span id="cb4-30">prob_5_or_more <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(pred.ps[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pred.ps))))</span>
<span id="cb4-31"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">5골 이상 득점할 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_5_or_more<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_5_or_more<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%)"</span>)</span>
<span id="cb4-32"></span>
<span id="cb4-33">pred.plot(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb4-34">plt.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'orange'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'5골'</span>)</span>
<span id="cb4-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb4-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수동으로 평균 계산</span></span>
<span id="cb4-37">    mean_goals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(pred.qs[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pred.ps[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pred.qs)))</span>
<span id="cb4-38">    plt.axvline(mean_goals, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'평균 (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>mean_goals<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">골)'</span>)</span>
<span id="cb4-39"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span>:</span>
<span id="cb4-40">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"평균 계산 중 오류 발생"</span>)</span>
<span id="cb4-41">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"골 수"</span>)</span>
<span id="cb4-42">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"확률"</span>)</span>
<span id="cb4-43">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"남은 시간 동안의 예상 골 수 분포"</span>)</span>
<span id="cb4-44">plt.legend()</span>
<span id="cb4-45">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>예상 골 수: 2.01골
표준편차: 1.78골

5골 이상 득점할 확률: 0.0939 (9.39%)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/07_files/figure-html/cell-4-output-2.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">8-2</h3>
<div id="94cc532c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_goal(prior, data):</span>
<span id="cb6-2">    posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.copy()</span>
<span id="cb6-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> goals <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data:</span>
<span id="cb6-4">        likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [poisson.pmf(goals, lam) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> posterior.qs]</span>
<span id="cb6-5">        posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb6-6">        posterior.normalize()</span>
<span id="cb6-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> posterior</span></code></pre></div>
</div>
<div id="c1a061bf" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">france <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_goal(prior, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])</span>
<span id="cb7-2">croatia <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_goal(prior, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb7-3"></span>
<span id="cb7-4">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb7-5">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expo_pdf(qs, prior.qs)</span>
<span id="cb7-6"></span>
<span id="cb7-7">france_post <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> france <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb7-8">france_post.normalize()</span>
<span id="cb7-9">croatia_post <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> croatia <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb7-10">croatia_post.normalize()</span>
<span id="cb7-11"></span>
<span id="cb7-12">Pmf.prob_lt(france_post, croatia_post)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0.2633977680689847</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">8-3</h3>
<div id="11abb6ba" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.8</span></span>
<span id="cb9-2">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb9-3"></span>
<span id="cb9-4">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(gamma.pdf(qs, alpha), qs)</span>
<span id="cb9-5">prior.normalize()</span>
<span id="cb9-6"></span>
<span id="cb9-7"></span>
<span id="cb9-8">boston_posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_goal(prior, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])</span>
<span id="cb9-9">vancouver_posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_goal(prior, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb9-10"></span>
<span id="cb9-11">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>)</span>
<span id="cb9-12">boston_posterior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'boston'</span>)</span>
<span id="cb9-13">vancouver_posterior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'vancouver'</span>)</span>
<span id="cb9-14">plt.legend()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/07_files/figure-html/cell-7-output-1.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7ede4cc2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">pmf_seq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [make_poisson_pmf(lam, goals) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> prior.qs]</span>
<span id="cb10-2">pred_boston <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_mixture(boston_posterior, pmf_seq)</span>
<span id="cb10-3">pred_vancouver <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_mixture(vancouver_posterior, pmf_seq)</span>
<span id="cb10-4">win <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.prob_gt(pred_boston, pred_vancouver)</span>
<span id="cb10-5">win</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>0.703863141313654</code></pre>
</div>
</div>
<p>챔피언십 우승 확률은 아직은 못 구하겠다.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/07.html</guid>
  <pubDate>Thu, 03 Jul 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Titanic</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/machine_learning/00.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">Preprocessing</h2>
<section id="data-load" class="level3">
<h3 class="anchored" data-anchor-id="data-load">Data load</h3>
<div id="940ce690" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> warnings</span>
<span id="cb1-7"></span>
<span id="cb1-8">warnings.filterwarnings(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ignore'</span>)</span>
<span id="cb1-9">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">train <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/train.csv'</span>, index_col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-12">test_X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/test.csv'</span>, index_col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-13">train_X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Survived'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-14">train_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train.iloc[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
</div>
</section>
<section id="결측치-처리" class="level3">
<h3 class="anchored" data-anchor-id="결측치-처리">결측치 처리</h3>
<div id="7c84a433" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">train_X.info(), test_X.info()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 891 entries, 1 to 891
Data columns (total 10 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Pclass    891 non-null    int64  
 1   Name      891 non-null    object 
 2   Sex       891 non-null    object 
 3   Age       714 non-null    float64
 4   SibSp     891 non-null    int64  
 5   Parch     891 non-null    int64  
 6   Ticket    891 non-null    object 
 7   Fare      891 non-null    float64
 8   Cabin     204 non-null    object 
 9   Embarked  889 non-null    object 
dtypes: float64(2), int64(3), object(5)
memory usage: 76.6+ KB
&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 418 entries, 892 to 1309
Data columns (total 10 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Pclass    418 non-null    int64  
 1   Name      418 non-null    object 
 2   Sex       418 non-null    object 
 3   Age       332 non-null    float64
 4   SibSp     418 non-null    int64  
 5   Parch     418 non-null    int64  
 6   Ticket    418 non-null    object 
 7   Fare      417 non-null    float64
 8   Cabin     91 non-null     object 
 9   Embarked  418 non-null    object 
dtypes: float64(2), int64(3), object(5)
memory usage: 35.9+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(None, None)</code></pre>
</div>
</div>
<ul>
<li>결측치가 있는 column은 Age, Cabin, Embarked, Fare</li>
<li>Cabin은 너무 많으니까 걍 삭제하자</li>
</ul>
<div id="a61def00" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">train_X.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cabin'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, inplace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-2">test_X.drop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cabin'</span>, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, inplace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<ul>
<li>Age, Fare랑 Embarked는 일단 지워보자</li>
</ul>
<div id="bab8b80e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">train_X.dropna(subset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Embarked'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>], inplace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb6-2">test_X.dropna(subset<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Fare'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Age'</span>], inplace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb6-3">train_X.info(), test_X.info()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 712 entries, 1 to 891
Data columns (total 9 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Pclass    712 non-null    int64  
 1   Name      712 non-null    object 
 2   Sex       712 non-null    object 
 3   Age       712 non-null    float64
 4   SibSp     712 non-null    int64  
 5   Parch     712 non-null    int64  
 6   Ticket    712 non-null    object 
 7   Fare      712 non-null    float64
 8   Embarked  712 non-null    object 
dtypes: float64(2), int64(3), object(4)
memory usage: 55.6+ KB
&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 331 entries, 892 to 1307
Data columns (total 9 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Pclass    331 non-null    int64  
 1   Name      331 non-null    object 
 2   Sex       331 non-null    object 
 3   Age       331 non-null    float64
 4   SibSp     331 non-null    int64  
 5   Parch     331 non-null    int64  
 6   Ticket    331 non-null    object 
 7   Fare      331 non-null    float64
 8   Embarked  331 non-null    object 
dtypes: float64(2), int64(3), object(4)
memory usage: 25.9+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(None, None)</code></pre>
</div>
</div>
</section>
<section id="eda" class="level3">
<h3 class="anchored" data-anchor-id="eda">EDA</h3>
<div id="2a6d3df4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">train_X.describe()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>712.000000</td>
<td>712.000000</td>
<td>712.000000</td>
<td>712.000000</td>
<td>712.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2.240169</td>
<td>29.642093</td>
<td>0.514045</td>
<td>0.432584</td>
<td>34.567251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.836854</td>
<td>14.492933</td>
<td>0.930692</td>
<td>0.854181</td>
<td>52.938648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
<td>0.420000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>1.000000</td>
<td>20.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>8.050000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.000000</td>
<td>28.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>15.645850</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>3.000000</td>
<td>38.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>33.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.000000</td>
<td>80.000000</td>
<td>5.000000</td>
<td>6.000000</td>
<td>512.329200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Pclass: 명목 1, 2, 3</li>
<li>Sex: 명목 male, female</li>
<li>Age: 연속형 (0.42~80)</li>
<li>SibSp: 명목, 0, 1, 2, 3, 4, 5</li>
<li>Parch: 명목, 0, 1, 2, 3, 4, 5, 6</li>
<li>Ticket: 541개 짜리 명목</li>
<li>Fare: 연속 (34.56~512.32)</li>
<li>Embarked: 명목 S C Q</li>
</ul>
<div id="54559e2d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">bindo <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(train_X[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Pclass'</span>].value_counts())</span>
<span id="cb10-2"></span>
<span id="cb10-3">sns.barplot(bindo, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pclass"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>, legend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/machine_learning/00_files/figure-html/cell-7-output-1.png" width="590" height="430" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/machine_learning/00.html</guid>
  <pubDate>Wed, 02 Jul 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>순열검정과 전통적인 비모수통계</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="부호검정이항검정" class="level2">
<h2 class="anchored" data-anchor-id="부호검정이항검정">부호검정(이항검정)</h2>
<ul>
<li>모집단 분포가 정규분포가 아니고, 대칭이 아닐경우 사용</li>
<li>어떤 분포라도 중앙값이 존재한다.</li>
<li>표본 중 절반은 중앙값보다 작고, 절반은 크다.</li>
<li>검정통계량은 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5E%7Bn%7DI(X_i%20%3E%20%CE%B8_0)"></li>
<li>영분포는 B(n, 1/2)를 따른다.</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?P(S%E2%89%A5c_%7Bval%7D%20%7C%20H_0)%20=%20%5Csum_%7Bk=c_%7Bval%7D%7D%5E%7Bn%7DnCk(%5Cfrac%7B1%7D%7B2%7D)%5En%20%E2%89%A4%20%CE%B1"></p>
<p><img src="https://latex.codecogs.com/png.latex?c_%7Bval%7D%20=%20Q_%7B1-%CE%B1%7D%20+%201"></p>
<ul>
<li>만약 이산형 변수여서 <img src="https://latex.codecogs.com/png.latex?%CE%B8_0">와 같은 값이 m개 이면 n - m개에 대해서만 검정을 진행</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">sign_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(S0, sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'two'</span>) {</span>
<span id="cb1-2">    n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> S0)</span>
<span id="cb1-3">    Sobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> S0)</span>
<span id="cb1-4">    </span>
<span id="cb1-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'greater'</span>) {</span>
<span id="cb1-6">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-7">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'less'</span>) {</span>
<span id="cb1-8">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs, n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-9">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb1-10">        prob_lower <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs, n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-11">        prob_upper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-12">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(prob_lower, prob_upper)</span>
<span id="cb1-13">    }</span>
<span id="cb1-14">    </span>
<span id="cb1-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(pvalue)</span>
<span id="cb1-16">}</span>
<span id="cb1-17"></span>
<span id="cb1-18">S0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-19">iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">98</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">89</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">109</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">108</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">102</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">92</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">131</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">114</span>)</span>
<span id="cb1-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign_test</span>(S0, iq, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'greater'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.171875</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(iq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% 
126.5 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign_test</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">127.5</span>, iq, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'greater'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9990234</code></pre>
</div>
</div>
<section id="부호검정의-영분포-시각화" class="level3">
<h3 class="anchored" data-anchor-id="부호검정의-영분포-시각화">부호검정의 영분포 시각화</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 부호검정 영분포 plotting 함수</span></span>
<span id="cb7-4">plot_sign_test_null <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(sample, S0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'two'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) {</span>
<span id="cb7-5">    n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> S0)</span>
<span id="cb7-6">    Sobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(sample <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> S0)</span>
<span id="cb7-7">    </span>
<span id="cb7-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이항분포 B(n, 0.5)의 가능한 값들</span></span>
<span id="cb7-9">    x_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n</span>
<span id="cb7-10">    probs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(x_vals, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb7-11">    </span>
<span id="cb7-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 데이터프레임 생성</span></span>
<span id="cb7-13">    df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_vals, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> probs)</span>
<span id="cb7-14">    </span>
<span id="cb7-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># p-value 계산 및 영역 표시를 위한 색상 설정</span></span>
<span id="cb7-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'greater'</span>) {</span>
<span id="cb7-17">        critical_region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> Sobs</span>
<span id="cb7-18">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb7-19">        title_suffix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(우측검정)"</span></span>
<span id="cb7-20">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (dir <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'less'</span>) {</span>
<span id="cb7-21">        critical_region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> Sobs</span>
<span id="cb7-22">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb7-23">        title_suffix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(좌측검정)"</span></span>
<span id="cb7-24">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 양측검정</span></span>
<span id="cb7-26">        prob_lower <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb7-27">        prob_upper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pbinom</span>(Sobs<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb7-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (prob_lower <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> prob_upper) {</span>
<span id="cb7-29">            critical_region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> Sobs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Sobs)</span>
<span id="cb7-30">        } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-31">            critical_region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> Sobs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> x_vals <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Sobs)</span>
<span id="cb7-32">        }</span>
<span id="cb7-33">        pvalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(prob_lower, prob_upper)</span>
<span id="cb7-34">        title_suffix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(양측검정)"</span></span>
<span id="cb7-35">    }</span>
<span id="cb7-36">    </span>
<span id="cb7-37">    df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(critical_region, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p-value 영역"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"채택역"</span>)</span>
<span id="cb7-38">    </span>
<span id="cb7-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 그래프 생성</span></span>
<span id="cb7-40">    p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> prob)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-41">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> region), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-42">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> Sobs, ], </span>
<span id="cb7-43">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> prob), </span>
<span id="cb7-44">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-45">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p-value 영역"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"채택역"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-46">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-47">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부호검정의 영분포 B("</span>, n, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", 0.5) "</span>, title_suffix),</span>
<span id="cb7-48">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"관찰값 S = "</span>, Sobs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p-value = "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(pvalue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)),</span>
<span id="cb7-49">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"검정통계량 S (중앙값보다 큰 값의 개수)"</span>,</span>
<span id="cb7-50">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"확률"</span>,</span>
<span id="cb7-51">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"영역"</span></span>
<span id="cb7-52">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-53">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-54">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-55">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb7-56">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb7-57">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span></span>
<span id="cb7-58">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-59">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> x_vals)</span>
<span id="cb7-60">    </span>
<span id="cb7-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p)</span>
<span id="cb7-62">}</span>
<span id="cb7-63"></span>
<span id="cb7-64">S0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb7-65">iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">98</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">89</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">109</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">108</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">102</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">92</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">131</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">114</span>)</span>
<span id="cb7-66"></span>
<span id="cb7-67"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_sign_test_null</span>(iq, S0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'greater'</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_sign_test_null</span>(iq, S0, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'two'</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_sign_test_null</span>(iq, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">127.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'less'</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>α를 정확하게 통제할 수 없다.
<ul>
<li>대표본의 경우 이산형 분포가 정규분포로 근사할 수 있기 때문에, 근사해서 검정 진행해서 α 통제</li>
</ul></li>
</ul>
</section>
<section id="신뢰구간" class="level3">
<h3 class="anchored" data-anchor-id="신뢰구간">신뢰구간</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 신뢰구간 계산</span></span>
<span id="cb10-2">a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb10-3">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(iq)</span>
<span id="cb10-4">l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qbinom</span>(a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-5">u <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> l</span>
<span id="cb10-6">sorted_iq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(iq)</span>
<span id="cb10-7">(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> sorted_iq[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(l, u)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  92 121</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실제 신뢰도 계산 (이산분포 특성상 정확히 95%가 아님)</span></span>
<span id="cb12-2">(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coverage =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(l<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(u<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>), n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9785156</code></pre>
</div>
</div>
<p><strong>왜 비대칭 분포에서도 유효한가?</strong></p>
<ol type="1">
<li><strong>중앙값의 불변성</strong>: 분포가 비대칭이어도 중앙값은 여전히 모집단을 반으로 나누는 점</li>
<li><strong>부호의 독립성</strong>: 각 관측값이 중앙값보다 클 확률은 항상 0.5 (연속분포 가정)</li>
<li><strong>순서통계량의 분포</strong>: 순서통계량들 사이의 확률적 관계는 분포 형태와 무관</li>
</ol>
<p><strong>시뮬레이션 검증: 비대칭 분포에서의 신뢰구간</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 부호검정 신뢰구간 함수</span></span>
<span id="cb14-2">sign_ci <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>) {</span>
<span id="cb14-3">    n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sample)</span>
<span id="cb14-4">    l <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qbinom</span>(alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, n, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb14-5">    u <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> l</span>
<span id="cb14-6">    sorted_sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(sample)</span>
<span id="cb14-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> sorted_sample[l], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> sorted_sample[u]))</span>
<span id="cb14-8">}</span>
<span id="cb14-9"></span>
<span id="cb14-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 비대칭 분포 시뮬레이션</span></span>
<span id="cb14-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb14-12">n_sim <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb14-13">n_sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb14-14">coverage_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb14-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distribution =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">character</span>(),</span>
<span id="cb14-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_median =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb14-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coverage_rate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb14-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb14-19">)</span>
<span id="cb14-20"></span>
<span id="cb14-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. 정규분포 (대칭)</span></span>
<span id="cb14-22">true_median_normal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-23">coverage_normal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_sim) {</span>
<span id="cb14-25">    sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n_sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-26">    ci <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign_ci</span>(sample)</span>
<span id="cb14-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (true_median_normal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> true_median_normal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) {</span>
<span id="cb14-28">        coverage_normal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coverage_normal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-29">    }</span>
<span id="cb14-30">}</span>
<span id="cb14-31">coverage_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(coverage_results, </span>
<span id="cb14-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distribution =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"정규분포"</span>, </span>
<span id="cb14-33">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_median =</span> true_median_normal,</span>
<span id="cb14-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coverage_rate =</span> coverage_normal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_sim))</span>
<span id="cb14-35"></span>
<span id="cb14-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. 지수분포 (오른쪽 비대칭)</span></span>
<span id="cb14-37">true_median_exp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 지수분포의 중앙값</span></span>
<span id="cb14-38">coverage_exp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-39"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_sim) {</span>
<span id="cb14-40">    sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(n_sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rate =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-41">    ci <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign_ci</span>(sample)</span>
<span id="cb14-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (true_median_exp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> true_median_exp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) {</span>
<span id="cb14-43">        coverage_exp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coverage_exp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-44">    }</span>
<span id="cb14-45">}</span>
<span id="cb14-46">coverage_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(coverage_results, </span>
<span id="cb14-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distribution =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"지수분포"</span>, </span>
<span id="cb14-48">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_median =</span> true_median_exp,</span>
<span id="cb14-49">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coverage_rate =</span> coverage_exp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_sim))</span>
<span id="cb14-50"></span>
<span id="cb14-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 베타분포 (왼쪽 비대칭)</span></span>
<span id="cb14-52">true_median_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qbeta</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-53">coverage_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb14-54"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n_sim) {</span>
<span id="cb14-55">    sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(n_sample, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-56">    ci <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign_ci</span>(sample)</span>
<span id="cb14-57">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (true_median_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> true_median_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> ci[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]) {</span>
<span id="cb14-58">        coverage_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coverage_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb14-59">    }</span>
<span id="cb14-60">}</span>
<span id="cb14-61">coverage_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(coverage_results, </span>
<span id="cb14-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distribution =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"베타분포(5,2)"</span>, </span>
<span id="cb14-63">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">true_median =</span> true_median_beta,</span>
<span id="cb14-64">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coverage_rate =</span> coverage_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_sim))</span>
<span id="cb14-65"></span>
<span id="cb14-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(coverage_results)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   distribution true_median coverage_rate
1      정규분포   0.0000000         0.952
2      지수분포   0.6931472         0.971
3 베타분포(5,2)   0.7355500         0.961</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 분포의 형태와 중앙값 시각화</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gridExtra)</span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb16-6">x_normal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb16-7">x_exp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rexp</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb16-8">x_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb16-9"></span>
<span id="cb16-10">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_normal), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"정규분포 (대칭)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"값"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"중앙값 = 0"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb18-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_exp), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"지수분포 (오른쪽 비대칭)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"값"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"중앙값 ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb18-6"></span>
<span id="cb18-7">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb18-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_beta), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qbeta</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"베타분포(5,2) (왼쪽 비대칭)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"값"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"중앙값 ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qbeta</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb18-12"></span>
<span id="cb18-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.arrange</span>(p1, p2, p3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>결론</strong>: 시뮬레이션 결과에서 볼 수 있듯이, 분포가 대칭이든 비대칭이든 부호검정의 신뢰구간 포함률(coverage rate)은 명목 신뢰수준(95%)에 근접합니다. 이는 부호검정 신뢰구간이 <strong>분포무관(distribution-free)</strong> 성질을 가지기 때문입니다.</p>
</section>
<section id="부호검정-사용-시-주의사항" class="level3">
<h3 class="anchored" data-anchor-id="부호검정-사용-시-주의사항">부호검정 사용 시 주의사항</h3>
<ol type="1">
<li><strong>동일한 값 처리</strong>: 중앙값과 정확히 같은 값들은 검정에서 제외</li>
<li><strong>표본 크기</strong>: 작은 표본에서는 정확한 이항분포 사용, 큰 표본에서는 정규분포 근사</li>
<li><strong>검정 방향</strong>: 양측검정 vs 단측검정 선택 중요</li>
<li><strong>가정</strong>: 표본이 연속분포에서 추출되었다고 가정</li>
</ol>
</section>
</section>
<section id="윌콕슨-부호순위검정" class="level2">
<h2 class="anchored" data-anchor-id="윌콕슨-부호순위검정">윌콕슨 부호순위검정</h2>
<ul>
<li>모집단이 대칭인 경우 사용 가능</li>
<li>rank가 동점인 경우 평균으로 처리</li>
<li>영분포는 잘 알려져 있지 않은 분포</li>
<li>평균: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bn(n+1)%7D%7B4%7D"></li>
<li>분산: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bn(n+1)(2n+1)%7D%7B24%7D"></li>
<li>일반적으로 resampling 방식으로 구하고, 수가 많아지면 표준정규분포로 근사해서 계산(Lyapunov의 중심극한정리)</li>
</ul>
<section id="중앙값-추정과-신뢰구간" class="level3">
<h3 class="anchored" data-anchor-id="중앙값-추정과-신뢰구간">중앙값 추정과 신뢰구간</h3>
<ul>
<li>왈시평균: <img src="https://latex.codecogs.com/png.latex?W_%7Bij%7D%20=%20%5Cfrac%7BX_i%20+%20X_j%7D%7B2%7D"></li>
<li><img src="https://latex.codecogs.com/png.latex?SR_%7B+%7D(%CE%B8)%20=%20%5C#%7BW_%7Bij%7D%20%3E%20%CE%B8%7D"></li>
</ul>
</section>
</section>
<section id="순열-검정" class="level2">
<h2 class="anchored" data-anchor-id="순열-검정">순열 검정</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/01.html</guid>
  <pubDate>Tue, 01 Jul 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>intro</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/00.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="비모수-통계란" class="level2">
<h2 class="anchored" data-anchor-id="비모수-통계란">비모수 통계란</h2>
<ul>
<li>모집단에 대한 가정을 적게 한 상태에서 통계적 추론을 하는 방법론
<ul>
<li>모집단이 정규분포를 따른다는 모수적 모형 가정 없이 정확한 추론을 할 수 있다.</li>
</ul></li>
</ul>
<ol type="1">
<li>두 표본이 정규분포를 따르지 않을 때 검정</li>
</ol>
<ul>
<li>순위와 부호를 이용한 검정 방법</li>
<li>순열 검정</li>
</ul>
<ol type="1">
<li>추정량의 불확실성을 계량화</li>
<li>비모수적 함수 추정</li>
</ol>
<section id="모수의-종류에-따른-비모수통계학의-소주제" class="level3">
<h3 class="anchored" data-anchor-id="모수의-종류에-따른-비모수통계학의-소주제">모수의 종류에 따른 비모수통계학의 소주제</h3>
<ol type="1">
<li>위치와 산포 모수</li>
</ol>
<ul>
<li>순열검정</li>
</ul>
<ol type="1">
<li>모수모형 하에서 적용 가능</li>
</ol>
<ul>
<li>붓스트랩</li>
</ul>
<ol type="1">
<li>비모수모형 공간이 매우 크기 때문에, 복잡한 모형에서의 모수 추정 가능</li>
</ol>
<ul>
<li>평활법</li>
</ul>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/Nonparametric/00.html</guid>
  <pubDate>Tue, 01 Jul 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>켤레사전분포</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/17.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="월드컵-문제" class="level2">
<h2 class="anchored" data-anchor-id="월드컵-문제">월드컵 문제</h2>
<div id="ec47ab63" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gamma</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-4"></span>
<span id="cb1-5">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span></span>
<span id="cb1-6">dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gamma(alpha)</span>
<span id="cb1-7"></span>
<span id="cb1-8">lams <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb1-9">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(dist.pdf(lams), lams)</span>
<span id="cb1-10">prior.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>9.889360237140306</code></pre>
</div>
</div>
<div id="5c3c2104" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> poisson</span>
<span id="cb3-2"></span>
<span id="cb3-3">k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb3-4">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> poisson(lams).pmf(k)</span>
<span id="cb3-5">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb3-6">posterior.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0.05015532557804499</code></pre>
</div>
</div>
</section>
<section id="켤레사전분포" class="level2">
<h2 class="anchored" data-anchor-id="켤레사전분포">켤레사전분포</h2>
<div id="52a1536f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_gamma_dist(alpha, beta):</span>
<span id="cb5-2">    dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gamma(alpha, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>beta)</span>
<span id="cb5-3">    dist.alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha</span>
<span id="cb5-4">    dist.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> beta</span>
<span id="cb5-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> dist</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_gamma(prior, daata):</span>
<span id="cb5-8">    k, t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data</span>
<span id="cb5-9">    alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k</span>
<span id="cb5-10">    beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t</span>
<span id="cb5-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> make_gamma_dist(alpha, beta)</span>
<span id="cb5-12"></span>
<span id="cb5-13">prior_gamma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_gamma_dist(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-14">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-15">posterior_gamma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update_gamma(prior_gamma, data)</span></code></pre></div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/17.html</guid>
  <pubDate>Mon, 30 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>회귀</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/16.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="더-많은-눈이-내렸을까" class="level2">
<h2 class="anchored" data-anchor-id="더-많은-눈이-내렸을까">더 많은 눈이 내렸을까?</h2>
<div id="c62e3da3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"></span>
<span id="cb1-5">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb1-6">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://github.com/AllenDowney/ThinkBayes2/raw/master/data/2239075.csv'</span>, parse_dates<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb1-7">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'YEAR'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'DATE'</span>].dt.year</span>
<span id="cb1-8">snow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'YEAR'</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SNOW'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb1-9">snow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> snow.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-10">snow.plot(ls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'강설량'</span>)</span>
<span id="cb1-11">plt.legend()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/16_files/figure-html/cell-2-output-1.png" width="572" height="430" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="fbd44a29" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.formula.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> smf</span>
<span id="cb2-3">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> snow.reset_index()</span>
<span id="cb2-4">offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'YEAR'</span>].mean().<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>()</span>
<span id="cb2-5">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'YEAR'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> offset</span>
<span id="cb2-6">data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SNOW'</span>]</span>
<span id="cb2-7"></span>
<span id="cb2-8">formula <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y ~ x'</span></span>
<span id="cb2-9">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.ols(formula, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>data).fit()</span>
<span id="cb2-10">results.params</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Intercept    64.446325
x             0.511880
dtype: float64</code></pre>
</div>
</div>
<section id="사전분포" class="level3">
<h3 class="anchored" data-anchor-id="사전분포">사전분포</h3>
<div id="91a144db" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>)</span>
<span id="cb4-2">prior_slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(qs)</span>
<span id="cb4-3">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">41</span>)</span>
<span id="cb4-4">prior_inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(qs)</span>
<span id="cb4-5">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>)</span>
<span id="cb4-6">prior_sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(qs)</span></code></pre></div>
</div>
<div id="9523ebfb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_joint(pmf1, pmf2):</span>
<span id="cb5-2">    X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(pmf1, pmf2)</span>
<span id="cb5-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> pd.DataFrame(X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Y, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf1.index, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf2.index)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_joint3(pmf1, pmf2, pmf3):</span>
<span id="cb5-6">    joint2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(pmf2, pmf1).stack()</span>
<span id="cb5-7">    joint3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(pmf3, joint2).stack()</span>
<span id="cb5-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Pmf(joint3)</span>
<span id="cb5-9"></span>
<span id="cb5-10">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint3(prior_slope, prior_inter, prior_sigma)</span>
<span id="cb5-11">prior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">-0.5</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">54.0</td>
<td data-quarto-table-cell-role="th">20.0</td>
<td>0.000015</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20.5</td>
<td>0.000015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21.0</td>
<td>0.000015</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21.5</td>
<td>0.000015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22.0</td>
<td>0.000015</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">1.5</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">75.0</td>
<td data-quarto-table-cell-role="th">33.0</td>
<td>0.000015</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33.5</td>
<td>0.000015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34.0</td>
<td>0.000015</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">34.5</td>
<td>0.000015</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35.0</td>
<td>0.000015</td>
</tr>
</tbody>
</table>

<p>64821 rows × 1 columns</p>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/16.html</guid>
  <pubDate>Mon, 30 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>로지스틱 회귀</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<p><img src="https://latex.codecogs.com/png.latex?logO(H%7Cx)%20=%20%CE%B2_0%20+%20%CE%B2_1x"></p>
<section id="우주-왕복선-문제" class="level2">
<h2 class="anchored" data-anchor-id="우주-왕복선-문제">우주 왕복선 문제</h2>
<div id="03633cd8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"></span>
<span id="cb1-4">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/master/Chapter2_MorePyMC/data/challenger_data.csv'</span>)</span>
<span id="cb1-5">pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.iloc[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-6">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].dropna()</span>
<span id="cb1-7">offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>].mean().<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>()</span>
<span id="cb1-8">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Temperature'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> offset</span>
<span id="cb1-9">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Damage Incident'</span>].astype(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb1-10"></span>
<span id="cb1-11">df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Temperature</th>
<th data-quarto-table-cell-role="th">Damage Incident</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>04/12/1981</td>
<td>66</td>
<td>0</td>
<td>-4.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/12/1981</td>
<td>70</td>
<td>1</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3/22/82</td>
<td>69</td>
<td>0</td>
<td>-1.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>01/11/1982</td>
<td>68</td>
<td>0</td>
<td>-2.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>04/04/1983</td>
<td>67</td>
<td>0</td>
<td>-3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>6/18/83</td>
<td>72</td>
<td>0</td>
<td>2.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>8/30/83</td>
<td>73</td>
<td>0</td>
<td>3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>11/28/83</td>
<td>70</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>02/03/1984</td>
<td>57</td>
<td>1</td>
<td>-13.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>04/06/1984</td>
<td>63</td>
<td>1</td>
<td>-7.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>8/30/84</td>
<td>70</td>
<td>1</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>10/05/1984</td>
<td>78</td>
<td>0</td>
<td>8.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>11/08/1984</td>
<td>67</td>
<td>0</td>
<td>-3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>1/24/85</td>
<td>53</td>
<td>1</td>
<td>-17.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>04/12/1985</td>
<td>67</td>
<td>0</td>
<td>-3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>4/29/85</td>
<td>75</td>
<td>0</td>
<td>5.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>6/17/85</td>
<td>70</td>
<td>0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>7/29/85</td>
<td>81</td>
<td>0</td>
<td>11.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>8/27/85</td>
<td>76</td>
<td>0</td>
<td>6.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>10/03/1985</td>
<td>79</td>
<td>0</td>
<td>9.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>10/30/85</td>
<td>75</td>
<td>1</td>
<td>5.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>11/26/85</td>
<td>76</td>
<td>0</td>
<td>6.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>01/12/1986</td>
<td>58</td>
<td>1</td>
<td>-12.0</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="전통-로지스틱" class="level3">
<h3 class="anchored" data-anchor-id="전통-로지스틱">전통 로지스틱</h3>
<div id="502d4dc8" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.formula.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> smf</span>
<span id="cb2-2"></span>
<span id="cb2-3">formula <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y ~ x'</span></span>
<span id="cb2-4">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> smf.logit(formula, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df).fit(disp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb2-5">results.params</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Intercept   -1.208490
x           -0.232163
dtype: float64</code></pre>
</div>
</div>
<div id="1e8ff3e5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.special <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> expit</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-3"></span>
<span id="cb4-4">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb4-5"></span>
<span id="cb4-6">inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.params[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Intercept'</span>]</span>
<span id="cb4-7">slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.params[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>]</span>
<span id="cb4-8">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">53</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">83</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> offset</span>
<span id="cb4-9">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expit(inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> xs)</span>
<span id="cb4-10">plt.plot(xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> offset, ps)</span>
<span id="cb4-11">plt.scatter(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> offset, df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>])</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15_files/figure-html/cell-4-output-1.png" width="568" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="사전-분포" class="level3">
<h3 class="anchored" data-anchor-id="사전-분포">사전 분포</h3>
<div id="5f4e805e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_joint(pmf1, pmf2):</span>
<span id="cb5-4">    X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(pmf1, pmf2)</span>
<span id="cb5-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> pd.DataFrame(X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Y, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf1.qs, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf2.qs)</span>
<span id="cb5-6"></span>
<span id="cb5-7">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb5-8">prior_inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(qs)</span>
<span id="cb5-9">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb5-10">prior_slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(qs)</span>
<span id="cb5-11">joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(prior_inter, prior_slope)</span>
<span id="cb5-12">joint_pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(joint.stack())</span>
<span id="cb5-13">joint_pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">-0.8</td>
<td data-quarto-table-cell-role="th">-5.00</td>
<td>0.000098</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">-4.94</td>
<td>0.000098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">-4.88</td>
<td>0.000098</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">-4.82</td>
<td>0.000098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">-4.76</td>
<td>0.000098</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">0.1</td>
<td data-quarto-table-cell-role="th">0.76</td>
<td>0.000098</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.82</td>
<td>0.000098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.88</td>
<td>0.000098</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.94</td>
<td>0.000098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.00</td>
<td>0.000098</td>
</tr>
</tbody>
</table>

<p>10201 rows × 1 columns</p>
</div>
</div>
</div>
</section>
<section id="가능도" class="level3">
<h3 class="anchored" data-anchor-id="가능도">가능도</h3>
<div id="da240aa7" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> binom</span>
<span id="cb6-2"></span>
<span id="cb6-3">grouped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>].agg([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'count'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sum'</span>])</span>
<span id="cb6-4">ns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grouped[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'count'</span>]</span>
<span id="cb6-5">ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grouped[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sum'</span>]</span>
<span id="cb6-6">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grouped.index</span>
<span id="cb6-7">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expit(inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> xs)</span>
<span id="cb6-8">likes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(ks, ns, ps)</span>
<span id="cb6-9">likes</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([0.93924781, 0.85931657, 0.82884484, 0.60268105, 0.56950687,
       0.24446388, 0.67790595, 0.72637895, 0.18815003, 0.8419509 ,
       0.87045398, 0.15645171, 0.86667894, 0.95545945, 0.96435859,
       0.97729671])</code></pre>
</div>
</div>
<div id="89fa1bc6" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint_pmf.copy()</span>
<span id="cb8-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> slope, inter <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> joint_pmf.index:</span>
<span id="cb8-3">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expit(inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> xs)</span>
<span id="cb8-4">    likes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(ks, ns, ps)</span>
<span id="cb8-5">    likelihood[slope, inter] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> likes.prod()</span></code></pre></div>
</div>
</section>
<section id="갱신" class="level3">
<h3 class="anchored" data-anchor-id="갱신">갱신</h3>
<div id="452601db" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">posterior_pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint_pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb9-2">posterior_pmf.normalize()</span>
<span id="cb9-3">joint_posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior_pmf.unstack()</span>
<span id="cb9-4"></span>
<span id="cb9-5">marginal_inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(joint_posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb9-6">marginal_inter.normalize()</span>
<span id="cb9-7">marginal_slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(joint_posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb9-8">marginal_slope.normalize()</span>
<span id="cb9-9"></span>
<span id="cb9-10">marginal_inter.plot()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15_files/figure-html/cell-8-output-1.png" width="583" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c6b58425" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">marginal_slope.plot()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15_files/figure-html/cell-9-output-1.png" width="583" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="분포-변환" class="level3">
<h3 class="anchored" data-anchor-id="분포-변환">분포 변환</h3>
<div id="6402c0cf" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">marginal_probs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> marginal_inter.transform(expit)</span>
<span id="cb11-2">marginal_lr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> marginal_slope.transform(np.exp)</span></code></pre></div>
</div>
</section>
<section id="예측-분포" class="level3">
<h3 class="anchored" data-anchor-id="예측-분포">예측 분포</h3>
<div id="96634644" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior_pmf.choice(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb12-2">temps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">83</span>)</span>
<span id="cb12-3">xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> temps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> offset</span>
<span id="cb12-4">pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.empty((<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sample), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(xs)))</span>
<span id="cb12-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, (slope, inter) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sample):</span>
<span id="cb12-6">    pred[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> expit(inter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> xs)</span>
<span id="cb12-7">low, median, high <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(pred, [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb12-8">plt.fill_between(temps, low, high, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'95% 신뢰구간'</span>)</span>
<span id="cb12-9">plt.plot(temps, median, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'logistic model'</span>)</span>
<span id="cb12-10">plt.legend()</span>
<span id="cb12-11">plt.scatter(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> offset, df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15_files/figure-html/cell-11-output-1.png" width="568" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/15.html</guid>
  <pubDate>Mon, 30 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>비교</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="a의-키" class="level2">
<h2 class="anchored" data-anchor-id="a의-키">A의 키</h2>
<ul>
<li>미국 성인 남성 중 두명을 임의로 골랐다.</li>
<li>A가 B보다 큰 것 같을 때, A의 키는 얼마인가</li>
</ul>
<div id="e908d932" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> norm</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-4"></span>
<span id="cb1-5">mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span></span>
<span id="cb1-6">std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.7</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(mean<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, mean<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb1-9">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm(mean, std).pdf(qs)</span>
<span id="cb1-10">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, qs)</span>
<span id="cb1-11">prior.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1.9963309462450582</code></pre>
</div>
</div>
<div id="ff3f4dd9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_joint(pmf1, pmf2):</span>
<span id="cb3-4">  X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(pmf1, pmf2)</span>
<span id="cb3-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> pd.DataFrame(X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Y, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf1.qs, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pmf2.qs)</span></code></pre></div>
</div>
<div id="5acd9382" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-2"></span>
<span id="cb4-3">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb4-4">joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(prior, prior)</span>
<span id="cb4-5">plt.contour(joint.columns, joint.index, joint, linewidths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-6">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A의 키(cm)'</span>)</span>
<span id="cb4-7">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B의 키(cm)'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Text(0, 0.5, 'B의 키(cm)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-4-output-2.png" width="591" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6ad7dea9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint.columns, joint.index</span>
<span id="cb6-2">X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x, y)</span>
<span id="cb6-3">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where((X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Y), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-4">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(a, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y)</span>
<span id="cb6-5">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span></code></pre></div>
</div>
<div id="e1f072c9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> normalize(pdf):</span>
<span id="cb7-2">  prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint.to_numpy().<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb7-3">  pdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> prob_data</span>
<span id="cb7-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> prob_data</span>
<span id="cb7-5">normalize(posterior)</span>
<span id="cb7-6">marginal_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb7-7">marginal_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb7-8">marginal_A.normalize()</span>
<span id="cb7-9">marginal_B.normalize()</span>
<span id="cb7-10">marginal_A.plot()</span>
<span id="cb7-11">marginal_B.plot()</span>
<span id="cb7-12">prior.plot()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-6-output-1.png" width="583" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="dbeae4ce" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">marginal_A.mean(), marginal_B.mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(182.38728123421686, 173.60286000233393)</code></pre>
</div>
</div>
<ul>
<li>A의 키가 170이라면?</li>
</ul>
<div id="5e2a1912" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">170</span>])</span>
<span id="cb10-2">pmf.normalize()</span>
<span id="cb10-3">pmf.plot()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-8-output-1.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="연습-문제" class="level2">
<h2 class="anchored" data-anchor-id="연습-문제">연습 문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">11-1</h3>
<div id="47a4b72c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior.loc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>])</span>
<span id="cb11-2">pmf.normalize()</span>
<span id="cb11-3">pmf.plot()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-9-output-1.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">11-2</h3>
<div id="3e2fbd7c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span></span>
<span id="cb12-2">std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.3</span></span>
<span id="cb12-3">qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(mean<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, mean<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb12-4">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm(mean, std).pdf(qs)</span>
<span id="cb12-5">girl_prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, qs)</span>
<span id="cb12-6">girl_prior.normalize()</span>
<span id="cb12-7">joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(marginal_A, girl_prior)</span>
<span id="cb12-8"></span>
<span id="cb12-9">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint.columns, joint.index</span>
<span id="cb12-10">X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x, y)</span>
<span id="cb12-11">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where((X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb12-12">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(a, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x)</span>
<span id="cb12-13">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb12-14">normalize(posterior)</span>
<span id="cb12-15">marginal_A.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c 정보 이전'</span>)</span>
<span id="cb12-16">marginal_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb12-17">marginal_A.normalize()</span>
<span id="cb12-18">marginal_A.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c 정보 이후'</span>)</span>
<span id="cb12-19">plt.legend()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-10-output-1.png" width="583" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">11-3</h3>
<div id="5dabbc5e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">mean_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span></span>
<span id="cb13-2">std_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb13-3">qs_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(mean_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, mean_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb13-4">ps_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm(mean_A, std_A).pdf(qs_A)</span>
<span id="cb13-5">prior_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps_A, qs_A)</span>
<span id="cb13-6">prior_A.normalize()</span>
<span id="cb13-7"></span>
<span id="cb13-8">mean_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1800</span></span>
<span id="cb13-9">std_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb13-10">qs_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(mean_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, mean_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb13-11">ps_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> norm(mean_B, std_B).pdf(qs_B)</span>
<span id="cb13-12">prior_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps_B, qs_B)</span>
<span id="cb13-13">prior_B.normalize()</span>
<span id="cb13-14"></span>
<span id="cb13-15">joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_joint(prior_A, prior_B)</span></code></pre></div>
</div>
<div id="37d688f8" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> logistic_prob(r_a, r_b):</span>
<span id="cb14-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>((r_b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> r_a) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>))</span>
<span id="cb14-3">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint.columns, joint.index</span>
<span id="cb14-4">X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(x, y)</span>
<span id="cb14-5">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>((Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>))</span>
<span id="cb14-6">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(a, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x)</span>
<span id="cb14-7"></span>
<span id="cb14-8">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> joint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb14-9">normalize(posterior)</span>
<span id="cb14-10">marginal_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(posterior.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb14-11">marginal_A.normalize()</span>
<span id="cb14-12"></span>
<span id="cb14-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(marginal_A.max_prob(), marginal_A.mean())</span>
<span id="cb14-14">marginal_A.plot()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1640 1636.648345528236</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13_files/figure-html/cell-12-output-2.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/13.html</guid>
  <pubDate>Sun, 29 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>분류</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/14.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="팽귄-데이터" class="level2">
<h2 class="anchored" data-anchor-id="팽귄-데이터">팽귄 데이터</h2>
<div id="de65bf3d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"></span>
<span id="cb1-3">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://github.com/allisonhorst/palmerpenguins/raw/main/inst/extdata/penguins_raw.csv'</span>)</span>
<span id="cb1-4">df.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(344, 17)</code></pre>
</div>
</div>
<div id="cbec3b96" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_cdf_map(df, colname, by<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Species2'</span>):</span>
<span id="cb3-2">  cdf_map <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb3-3">  grouped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.groupby(by)[colname]</span>
<span id="cb3-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> species, group <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> grouped:</span>
<span id="cb3-5">    cdf_map[species] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Cdf.from_seq(group, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>species)</span>
<span id="cb3-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> cdf_map</span></code></pre></div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/14.html</guid>
  <pubDate>Mon, 23 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>최솟값, 최댓값 그리고 혼합 분포</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/06.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="넷-중-높은-값" class="level2">
<h2 class="anchored" data-anchor-id="넷-중-높은-값">넷 중 높은 값</h2>
<div id="b5c51b74" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-3"></span>
<span id="cb1-4">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb1-5">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-6">a.sort(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-7">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-8">pmf_best3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(t)</span></code></pre></div>
</div>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">7-1</h3>
<div id="f799af24" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span>
<span id="cb2-2">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(n, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb2-3">a.sort(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-4">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-5">pmf_best3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(t)</span>
<span id="cb2-6">cdf_best3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf_best3.make_cdf()</span></code></pre></div>
</div>
<div id="dacbad69" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Cdf</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"></span>
<span id="cb3-4">standard <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>]</span>
<span id="cb3-5">standard_pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(standard)</span>
<span id="cb3-6"></span>
<span id="cb3-7">cdf_best3.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'best 3 of 4'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, ls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>)</span>
<span id="cb3-8">cdf_standard <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Cdf.from_seq(standard)</span>
<span id="cb3-9"></span>
<span id="cb3-10">cdf_standard.step(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standard set'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C7'</span>)</span>
<span id="cb3-11">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CDF'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-12"></span>
<span id="cb3-13">cdf_max_dist6 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cdf_best3.max_dist(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb3-14">cdf_min_dist6 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cdf_best3.min_dist(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/06_files/figure-html/cell-4-output-1.png" width="589" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7b4e4e4b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Best 3 of 4 - 평균: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>pmf_best3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 표준편차: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>pmf_best3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Standard array - 평균: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>standard_pmf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 표준편차: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>standard_pmf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"></span>
<span id="cb4-5">prob_less_than_8 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cdf_best3(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb4-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Best 3 of 4에서 8보다 작은 값이 나올 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_less_than_8<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"6번 굴렸을 때 최소 하나가 8보다 작을 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cdf_min_dist6(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-9"></span>
<span id="cb4-10">prob_greater_than_15 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cdf_best3(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb4-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Best 3 of 4에서 15보다 큰 값이 나올 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_greater_than_15<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb4-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"6번 굴렸을 때 최소 하나가 15보다 클 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cdf_max_dist6(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best 3 of 4 - 평균: 12.25, 표준편차: 2.82
Standard array - 평균: 12.00, 표준편차: 2.38
Best 3 of 4에서 8보다 작은 값이 나올 확률: 0.0569
6번 굴렸을 때 최소 하나가 8보다 작을 확률: 0.5206
Best 3 of 4에서 15보다 큰 값이 나올 확률: 0.1275
6번 굴렸을 때 최소 하나가 15보다 클 확률: 0.5588</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">7-2</h3>
<div id="3d25626b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_dice(pmf, data):</span>
<span id="cb6-2">    hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs</span>
<span id="cb6-3">    likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> hypos</span>
<span id="cb6-4">    likelihood[data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> hypos] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb6-5">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb6-6">    pmf.normalize()</span>
<span id="cb6-7"></span>
<span id="cb6-8">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>])</span>
<span id="cb6-9">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-10">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.425532</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>0.319149</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>0.255319</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="78b2450d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_mixture(pmf, pmf_seq):</span>
<span id="cb7-4">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(pmf_seq).fillna(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).transpose()</span>
<span id="cb7-5">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> np.array(pmf)</span>
<span id="cb7-6">    total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Pmf(total)</span>
<span id="cb7-8"></span>
<span id="cb7-9">pmf_6 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 6면체 주사위</span></span>
<span id="cb7-10">pmf_8 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 8면체 주사위</span></span>
<span id="cb7-11">pmf_10 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10면체 주사위</span></span>
<span id="cb7-12"></span>
<span id="cb7-13">mixture <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_mixture(pmf, [pmf_6, pmf_8, pmf_10])</span>
<span id="cb7-14">prob_6_damage <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mixture[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mixture.qs <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Probability of 6 points of damage: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_6_damage<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Probability of 6 points of damage: 0.1363</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">7-3</h3>
<div id="21813085" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">950</span></span>
<span id="cb9-2">std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb9-3"></span>
<span id="cb9-4">sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.normal(mean, std, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>)</span>
<span id="cb9-5">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq(sample)</span>
<span id="cb9-6">cdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.make_cdf()</span></code></pre></div>
</div>
<div id="df9dab2c" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">means <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb10-2">n_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> n_values:</span>
<span id="cb10-5">    cdf_max_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cdf.max_dist(n)</span>
<span id="cb10-6">    mean_max <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cdf_max_dist.mean()</span>
<span id="cb10-7">    means.append(mean_max)</span>
<span id="cb10-8"></span>
<span id="cb10-9">means <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(means)</span>
<span id="cb10-10">target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb10-11">closest_idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmin(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(means <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> target))</span>
<span id="cb10-12">optimal_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_values[closest_idx]</span>
<span id="cb10-13">closest_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> means[closest_idx]</span>
<span id="cb10-14"></span>
<span id="cb10-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">결과:"</span>)</span>
<span id="cb10-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"1000g에 가장 가까운 평균을 만드는 n: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>optimal_n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"해당 n에서의 평균: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>closest_mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">g"</span>)</span>
<span id="cb10-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"목표값과의 차이: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(closest_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> target)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">g"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
결과:
1000g에 가장 가까운 평균을 만드는 n: 3
해당 n에서의 평균: 997.51g
목표값과의 차이: 2.49g</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/06.html</guid>
  <pubDate>Mon, 23 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>공산과 가산</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="공산" class="level2">
<h2 class="anchored" data-anchor-id="공산">공산</h2>
<div id="0b6bbef6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> odds(p):</span>
<span id="cb1-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> p)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> prob(o):</span>
<span id="cb1-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> o)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> prob2(a, b):</span>
<span id="cb1-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b)</span>
<span id="cb1-9"></span>
<span id="cb1-10">odds(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<pre><code>1.4999999999999998</code></pre>
</div>
</div>
</section>
<section id="베이즈-규칙" class="level2">
<h2 class="anchored" data-anchor-id="베이즈-규칙">베이즈 규칙</h2>
<p><img src="https://latex.codecogs.com/png.latex?odds(A%7CD)%20=%20odds(A)%20%5Ccdot%20%5Cfrac%7BP(D%7CA)%7D%7BP(D%7CB)%7D"></p>
<div id="1f2e85b7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb3-2">likelihood_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-3">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_ratio</span>
<span id="cb3-4">post_odds</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>1.5</code></pre>
</div>
</div>
<div id="1be29a6a" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre><code>0.6</code></pre>
</div>
</div>
<div id="2924ba13" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">likelihood_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-2">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood_ratio</span>
<span id="cb7-3">post_odds</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">
<pre><code>0.75</code></pre>
</div>
</div>
<div id="e75a2c40" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>0.42857142857142855</code></pre>
</div>
</div>
</section>
<section id="올리버의-혈액형" class="level2">
<h2 class="anchored" data-anchor-id="올리버의-혈액형">올리버의 혈액형</h2>
<ul>
<li>범죄 현장에서 두 사람의 혈흔을 발견했다.</li>
<li>발견된 혈흔은 O형과 AB형이다.</li>
<li>해당 지역에서 O형의 비율은 0.6, AB형의 비율은 0.01이다.</li>
<li>올리버는 O형이다.</li>
<li>범죄 현장의 혈흔(데이터)이 올리버가 범인 중 한 명이라는 질문(가정)에 대한 증거가 될 수 있는가</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?odds(A%7CD)%20=%20odds(A)%20%5Ccdot%20%5Cfrac%7BP(D%7CA)%7D%7BP(D%7CB)%7D"> <img src="https://latex.codecogs.com/png.latex?%E2%86%92%20%5Cfrac%7Bodds(A%7CD)%7D%7Bodds(A)%7D%20=%20%5Cfrac%7BP(D%7CA)%7D%7BP(D%7CB)%7D"></p>
<ul>
<li>베이즈 요인 &gt; 1: A의 가정 하에 존재하는게 더 가깝다.</li>
<li>베이즈 요인 &lt; 1: B의 가정 하에 존재하는게 더 가깝다.</li>
<li>베이즈 요인 == 1: 양쪽 가설 하에서 동일한 가능성을 가진다.</li>
</ul>
<div id="a35966c8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">like1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># oliver가 혈흔을 남긴 경우</span></span>
<span id="cb11-2">like2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># oliver가 혈흔을 남기지 않은 경우</span></span>
<span id="cb11-3"></span>
<span id="cb11-4">likelihood_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> like1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> like2</span>
<span id="cb11-5">likelihood_ratio</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>0.8333333333333334</code></pre>
</div>
</div>
<ul>
<li>가능도비가 1보다 낮기 때문에, oliver가 혈흔을 남기지 않은 쪽에 더 가깝다.</li>
</ul>
<div id="6e453e97" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> like1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> like2</span>
<span id="cb13-2">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">
<pre><code>0.45454545454545453</code></pre>
</div>
</div>
</section>
<section id="글루텐-민감도" class="level2">
<h2 class="anchored" data-anchor-id="글루텐-민감도">글루텐 민감도</h2>
<ul>
<li>글루텐에 민감한 사람은 블라이든 검사에서 글루텐 밀가루를 정확히 식별할 확률이 95%다</li>
<li>글루텐에 민감하지 않은 사람이 우연히 글루텐 밀가루를 식별할 확률은 40%다.</li>
</ul>
<div id="196441bd" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span></span>
<span id="cb15-2">num_sensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb15-3">num_insensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> num_sensitive</span></code></pre></div>
</div>
<div id="7c68053c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> binom</span>
<span id="cb16-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb16-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb16-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb16-5"></span>
<span id="cb16-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_binomial(n, p):</span>
<span id="cb16-7">  ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb16-8">  ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(ks, n, p)</span>
<span id="cb16-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Pmf(ps, ks)</span>
<span id="cb16-10"></span>
<span id="cb16-11">dist_sensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(num_sensitive, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb16-12">dist_insensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(num_insensitive, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>)</span>
<span id="cb16-13"></span>
<span id="cb16-14">dist_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.add_dist(dist_sensitive, dist_insensitive)</span>
<span id="cb16-15"></span>
<span id="cb16-16">dist_sensitive.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sensitive'</span>, ls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span>)</span>
<span id="cb16-17">dist_insensitive.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'insensitive'</span>, ls<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>)</span>
<span id="cb16-18">dist_total.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'total'</span>)</span>
<span id="cb16-19">plt.legend()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05_files/figure-html/cell-10-output-1.png" width="568" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="역산" class="level3">
<h3 class="anchored" data-anchor-id="역산">역산</h3>
<ul>
<li>35명의 피험자중 12명이 글루텐이 있다고 했을 때, 글루텐에 민감한 사람의 비율은?</li>
</ul>
<div id="b724fec8" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb17-2"></span>
<span id="cb17-3">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame()</span>
<span id="cb17-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> num_sensitive <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb17-5">  num_insensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> num_sensitive</span>
<span id="cb17-6">  dist_sensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(num_sensitive, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb17-7">  dist_insensitive <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(num_insensitive, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>)</span>
<span id="cb17-8">  dist_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.add_dist(dist_sensitive, dist_insensitive)</span>
<span id="cb17-9">  table[num_sensitive] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dist_total</span>
<span id="cb17-10"></span>
<span id="cb17-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dist <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> table:</span>
<span id="cb17-12">  table[dist].plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'num_sensitive = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05_files/figure-html/cell-11-output-1.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="353164af" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">likelihood1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table.loc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span>
<span id="cb18-2">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb18-3">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb18-4"></span>
<span id="cb18-5">posterior1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood1</span>
<span id="cb18-6">posterior1.normalize()</span>
<span id="cb18-7"></span>
<span id="cb18-8">likelihood2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table.loc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>]</span>
<span id="cb18-9">posterior2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood2</span>
<span id="cb18-10">posterior2.normalize()</span>
<span id="cb18-11"></span>
<span id="cb18-12">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb18-13"></span>
<span id="cb18-14">posterior1.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'12개가 정확히 분류한 경우의 사후분포'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb18-15">posterior2.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'20개가 정확히 분류한 경우의 사후분포'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb18-16">plt.legend()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05_files/figure-html/cell-12-output-1.png" width="575" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="676e54bc" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'12명이 정확히 분류했을 때 글루텐 민감한 사람은 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>max_prob()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명, 20명이 정확히 분류했을 때 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>max_prob()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명일 확률이 높음'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>12명이 정확히 분류했을 때 글루텐 민감한 사람은 0명, 20명이 정확히 분류했을 때 11명일 확률이 높음</code></pre>
</div>
</div>
</section>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">6-1</h3>
<div id="9e39db1a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> trust <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>]:</span>
<span id="cb21-2">  prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> odds(trust)</span>
<span id="cb21-3">  post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_ratio</span>
<span id="cb21-4">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>trust<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prior_odds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob(post_odds)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9, 9.000000000000002: 0.8823529411764706
0.5, 1.0: 0.45454545454545453
0.1, 0.11111111111111112: 0.08474576271186442</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">6-2</h3>
<div id="2aed0cb5" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> odds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb23-2">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb23-3">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span></span>
<span id="cb23-4"></span>
<span id="cb23-5">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>0.5555555555555555</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">6-3</h3>
<div id="5e0860e0" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> odds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb25-2">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb25-3"></span>
<span id="cb25-4">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre><code>0.4705882352941177</code></pre>
</div>
</div>
<ul>
<li>베이즈 방법을 이용하나 빈도주의적 방법을 이용하나, 확률을 구하는 문제에 있어서는 차이가 없다.</li>
<li>하지만 통계적 추론 방법을 선택하는데 있어서는 차이가 있다.</li>
</ul>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">6-4</h3>
<div id="ce3e4e55" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> odds(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb27-2">post_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior_odds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb27-3"></span>
<span id="cb27-4">prob(post_odds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>0.8027522935779816</code></pre>
</div>
</div>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4">6-5</h3>
<div id="2321d4e5" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">dice6 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)))</span>
<span id="cb29-2">goblin_health <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dice6.add_dist(dice6)</span>
<span id="cb29-3">remaining_health <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.sub_dist(goblin_health, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb29-4">attack_damage <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dice6</span>
<span id="cb29-5"></span>
<span id="cb29-6">defeat_probability <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb29-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> damage, damage_prob <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> attack_damage.items():</span>
<span id="cb29-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> remaining, remaining_prob <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> remaining_health.items():</span>
<span id="cb29-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> remaining <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> damage <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> remaining:</span>
<span id="cb29-10">            defeat_probability <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> damage_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> remaining_prob</span>
<span id="cb29-11"></span>
<span id="cb29-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">고블린을 물리칠 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>defeat_probability<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
고블린을 물리칠 확률: 0.417</code></pre>
</div>
</div>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5">6-6</h3>
<div id="f8ec77c2" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb31-2"></span>
<span id="cb31-3">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span>
<span id="cb31-4">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, hypos)</span>
<span id="cb31-5">dice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)),</span>
<span id="cb31-6">        Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)),</span>
<span id="cb31-7">        Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>))]</span>
<span id="cb31-8">like <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [d.mul_dist(d) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dice]</span>
<span id="cb31-9">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(like).fillna(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).transpose()</span>
<span id="cb31-10">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> pmf.ps</span>
<span id="cb31-11">df[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre><code>0.020833333333333332</code></pre>
</div>
</div>
</section>
<section id="section-6" class="level3">
<h3 class="anchored" data-anchor-id="section-6">6-7</h3>
<div id="5c60352b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'long'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'zost'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bell'</span>])</span>
<span id="cb33-2">pmf.normalize()</span>
<span id="cb33-3">dice <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb33-4">like <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [dice.add_dist(dice).add_dist(dice).add_dist(dice).add_dist(dice),</span>
<span id="cb33-5">        dice.add_dist(dice).add_dist(dice).add_dist(dice),</span>
<span id="cb33-6">        dice.add_dist(dice).add_dist(dice)]</span>
<span id="cb33-7">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(like).fillna(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).transpose()</span>
<span id="cb33-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]:</span>
<span id="cb33-9">  pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> np.array(df.loc[i])</span>
<span id="cb33-10">  pmf.normalize()</span>
<span id="cb33-11">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">long</td>
<td>0.235762</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">zost</td>
<td>0.449704</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">bell</td>
<td>0.314534</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-7" class="level3">
<h3 class="anchored" data-anchor-id="section-7">6-8</h3>
<div id="f2387149" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb34-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb34-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> binom</span>
<span id="cb34-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb34-5"></span>
<span id="cb34-6">n_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">538</span></span>
<span id="cb34-7">n_outperform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">312</span></span>
<span id="cb34-8"></span>
<span id="cb34-9">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(n_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb34-10">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb34-11"></span>
<span id="cb34-12">likelihoods <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb34-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n_honest <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hypos:</span>
<span id="cb34-14">    n_dishonest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> n_honest</span>
<span id="cb34-15">    honest_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(n_honest, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb34-16">    dishonest_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binomial(n_dishonest, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)</span>
<span id="cb34-17">    total_dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.add_dist(honest_dist, dishonest_dist)</span>
<span id="cb34-18">    likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> total_dist[n_outperform] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> n_outperform <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> total_dist <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb34-19">    likelihoods.append(likelihood)</span>
<span id="cb34-20"></span>
<span id="cb34-21">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.array(likelihoods)</span>
<span id="cb34-22">posterior.normalize()</span>
<span id="cb34-23"></span>
<span id="cb34-24">most_likely_honest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior.max_prob()</span>
<span id="cb34-25">posterior_prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior[most_likely_honest]</span>
<span id="cb34-26"></span>
<span id="cb34-27"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"가장 가능성이 높은 정직한 의원 수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>most_likely_honest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명"</span>)</span>
<span id="cb34-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"해당 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_prob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb34-29"></span>
<span id="cb34-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사후분포 시각화</span></span>
<span id="cb34-31"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb34-32">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb34-33">posterior.plot()</span>
<span id="cb34-34">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'정직한 의원 수'</span>)</span>
<span id="cb34-35">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'확률'</span>)</span>
<span id="cb34-36">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'정직한 의원 수에 대한 사후분포'</span>)</span>
<span id="cb34-37">plt.axvline(most_likely_honest, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, </span>
<span id="cb34-38">           label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'최빈값: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>most_likely_honest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명'</span>)</span>
<span id="cb34-39">plt.legend()</span>
<span id="cb34-40">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb34-41">plt.show()</span>
<span id="cb34-42"></span>
<span id="cb34-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 95% 신용구간</span></span>
<span id="cb34-44">credible_interval <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior.credible_interval(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb34-45"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"95% 신용구간: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>credible_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명 - </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>credible_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가장 가능성이 높은 정직한 의원 수: 430명
해당 확률: 0.0147</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05_files/figure-html/cell-21-output-2.png" width="974" height="525" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>95% 신용구간: 380.0명 - 486.0명</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/05.html</guid>
  <pubDate>Thu, 19 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>수량 추정</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/04.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="기관차-문제" class="level2">
<h2 class="anchored" data-anchor-id="기관차-문제">기관차 문제</h2>
<ul>
<li>각 철도를 지나가는 기관차에 1부터 N까지의 순서로 번호를 붙인다.</li>
<li>60번 번호가 붙은 기관차를 보았다.</li>
<li>이 철도에 몇 개의 기관차가 지나가는지 추정해보자</li>
</ul>
<div id="7cd48f51" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-3"></span>
<span id="cb1-4">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1001</span>)</span>
<span id="cb1-5">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span></code></pre></div>
</div>
<ul>
<li>가정: N은 1부터 1000까지의 값 중 한 값이 동일한 확률로 선택될 수 있다.</li>
</ul>
<div id="a3077e04" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_train(pmf, data):</span>
<span id="cb2-2">  hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs</span>
<span id="cb2-3">  likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> hypos</span>
<span id="cb2-4">  likelihood[(data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> hypos)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-5">  pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb2-6">  pmf.normalize()</span></code></pre></div>
</div>
<div id="9002e66b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb3-2">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.copy()</span>
<span id="cb3-3">update_train(posterior, data)</span></code></pre></div>
</div>
<div id="a5e2f2e4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-2"></span>
<span id="cb4-3">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb4-4"></span>
<span id="cb4-5">posterior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'60번 기관차 발견 시 전체 기관차 수의 사후확률'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb4-6">plt.legend()</span>
<span id="cb4-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후 확률'</span>)</span>
<span id="cb4-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'기관차 수'</span>)</span>
<span id="cb4-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/04_files/figure-html/cell-5-output-2.png" width="601" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="e727b870" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">posterior.max_prob()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>60</code></pre>
</div>
</div>
<ul>
<li>당연하다는 듯이 60이 최선의 선택. 하지만 이는 별로 도움이 안됨.</li>
<li>대안으로 사후확률의 평균을 구해본다.</li>
</ul>
<div id="dc8d9807" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">posterior.mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>333.41989326370776</code></pre>
</div>
</div>
<ul>
<li>해당 값을 선택하는 것이 장기적으로 좋은 선택.</li>
</ul>
<div id="4f22f0c1" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb10-2"></span>
<span id="cb10-3">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후확률 분포 평균'</span>])</span>
<span id="cb10-4">df.index.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'상한값'</span></span>
<span id="cb10-5"></span>
<span id="cb10-6">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>]</span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> high <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>]:</span>
<span id="cb10-9">    hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb10-10">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb10-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> data <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dataset:</span>
<span id="cb10-12">        update_train(pmf, data)</span>
<span id="cb10-13">    df.loc[high] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.mean()</span>
<span id="cb10-14">df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">사후확률 분포 평균</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">상한값</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">500</td>
<td>151.849588</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1000</td>
<td>164.305586</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000</td>
<td>171.338181</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>하지만 상한값의 범위의 변화에 따른 사후확률 분포의 평균값이 크게 달라진다.</li>
<li>이럴때는 2가지 방법이 있다.
<ol type="1">
<li>데이터를 더 확보</li>
<li>배경지식을 더 확보해서 더 나은 사전확률을 선택</li>
</ol></li>
</ul>
</section>
<section id="멱법칙-사전확률" class="level2">
<h2 class="anchored" data-anchor-id="멱법칙-사전확률">멱법칙 사전확률</h2>
<ul>
<li>기관차 수는 멱법칙을 주로 따르는 것으로 알려져 있음</li>
<li>더 적합한 사전확률은 안정적인 사전확률을 제공할 수 있다.</li>
</ul>
<div id="dfdba5bd" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb11-2">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha)</span>
<span id="cb11-3">power <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, hypos, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'power law'</span>)</span>
<span id="cb11-4">power.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>8.178368103610282</code></pre>
</div>
</div>
<div id="64d6a0f9" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniform'</span>)</span>
<span id="cb13-2">uniform.normalize()</span>
<span id="cb13-3"></span>
<span id="cb13-4">power.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'power'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'skyblue'</span>)</span>
<span id="cb13-5">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniform'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pink'</span>)</span>
<span id="cb13-6">plt.legend()</span>
<span id="cb13-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전확률 분포'</span>)</span>
<span id="cb13-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'기관차 수'</span>)</span>
<span id="cb13-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/04_files/figure-html/cell-10-output-2.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="05b363c4" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">update_train(uniform, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>)</span>
<span id="cb15-2">update_train(power, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4">power.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'power'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'skyblue'</span>)</span>
<span id="cb15-5">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniform'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pink'</span>)</span>
<span id="cb15-6">plt.legend()</span>
<span id="cb15-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후확률 분포'</span>)</span>
<span id="cb15-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'기관차 수'</span>)</span>
<span id="cb15-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/04_files/figure-html/cell-11-output-2.png" width="609" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="223cfb71" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후확률 분포 평균'</span>])</span>
<span id="cb17-2">df.index.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'상한값'</span></span>
<span id="cb17-3"></span>
<span id="cb17-4">alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb17-5">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>]</span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> high <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>]:</span>
<span id="cb17-8">    hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-9">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hypos<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha)</span>
<span id="cb17-10">    power <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(ps, hypos)</span>
<span id="cb17-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> data <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dataset:</span>
<span id="cb17-12">        update_train(power, data)</span>
<span id="cb17-13">    df.loc[high] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> power.mean()</span>
<span id="cb17-14">df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">사후확률 분포 평균</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">상한값</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">500</td>
<td>130.708470</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1000</td>
<td>133.275231</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000</td>
<td>133.997463</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="신뢰구간" class="level2">
<h2 class="anchored" data-anchor-id="신뢰구간">신뢰구간</h2>
<div id="e18bda50" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">power.credible_interval(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array([ 91., 243.])</code></pre>
</div>
</div>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">5-1</h3>
<div id="70e2ae98" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> binom</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update(pmf, k, p):</span>
<span id="cb20-4">    likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(k, pmf.qs, p)</span>
<span id="cb20-5">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb20-6">    pmf.normalize()</span>
<span id="cb20-7"></span>
<span id="cb20-8">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span>)</span>
<span id="cb20-9">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb20-10"></span>
<span id="cb20-11">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.copy()</span>
<span id="cb20-12"></span>
<span id="cb20-13">update(posterior, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>)</span>
<span id="cb20-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"5월 11일 데이터 적용 후 평균 인원수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb20-15"></span>
<span id="cb20-16">update(posterior, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>)</span>
<span id="cb20-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"5월 23일 데이터 적용 후 평균 인원수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb20-18"></span>
<span id="cb20-19">update(posterior, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">365</span>)</span>
<span id="cb20-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"8월 1일 데이터 적용 후 평균 인원수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5월 11일 데이터 적용 후 평균 인원수: 957.1
5월 23일 데이터 적용 후 평균 인원수: 721.7
8월 1일 데이터 적용 후 평균 인원수: 486.2</code></pre>
</div>
</div>
<div id="db5066ce" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">estimated_people <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior.mean()</span>
<span id="cb22-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"추정된 강당 인원수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>estimated_people<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">명"</span>)</span>
<span id="cb22-3"></span>
<span id="cb22-4">prob_over_1200 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior[posterior.qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb22-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"1200명을 초과할 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_over_1200<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prob_over_1200<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%)"</span>)</span>
<span id="cb22-6"></span>
<span id="cb22-7">ci_90 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior.credible_interval(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)</span>
<span id="cb22-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"90% 신뢰구간: [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ci_90[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ci_90[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">]"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>추정된 강당 인원수: 486.2명
1200명을 초과할 확률: 0.0112 (1.12%)
90% 신뢰구간: [166, 942]</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">5-2</h3>
<div id="816547c4" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> rabbit_likelihood(n):</span>
<span id="cb24-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ((n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb24-3"></span>
<span id="cb24-4">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)</span>
<span id="cb24-5">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb24-6"></span>
<span id="cb24-7">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [rabbit_likelihood(n) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> n <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hypos]</span>
<span id="cb24-8"></span>
<span id="cb24-9">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.copy()</span>
<span id="cb24-10">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb24-11">posterior.normalize()</span>
<span id="cb24-12"></span>
<span id="cb24-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">추정 토끼 수 (평균): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">마리"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
추정 토끼 수 (평균): 5.92마리</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">5-3</h3>
<p>Exercise: Suppose that in the criminal justice system, all prison sentences are either 1, 2, or 3 years, with an equal number of each. One day, you visit a prison and choose a prisoner at random. What is the probability that they are serving a 3-year sentence? What is the average remaining sentence of the prisoners you observe?</p>
<div id="b2e5565e" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 감옥 문제 해결</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 핵심: 길이 편향(length bias) - 더 긴 형량을 받은 죄수가 감옥에 더 오래 머물러 있음</span></span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb26-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb26-6"></span>
<span id="cb26-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 형량별 죄수 수 (같은 수)</span></span>
<span id="cb26-8">sentences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 년 단위</span></span>
<span id="cb26-9">sentence_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각각 동일한 수</span></span>
<span id="cb26-10"></span>
<span id="cb26-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 형량의 죄수가 감옥에 있을 기간 (평균적으로)</span></span>
<span id="cb26-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1년형: 평균 0.5년, 2년형: 평균 1년, 3년형: 평균 1.5년 동안 감옥에 있음</span></span>
<span id="cb26-13">expected_time_in_prison <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb26-14"></span>
<span id="cb26-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 어느 순간 감옥에 있을 죄수의 분포 (길이 편향 적용)</span></span>
<span id="cb26-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 형량의 죄수 수 × 평균 재소 기간</span></span>
<span id="cb26-17">weighted_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> count, time <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(sentence_counts, expected_time_in_prison)]</span>
<span id="cb26-18"></span>
<span id="cb26-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"형량별 가중 죄수 수:"</span>)</span>
<span id="cb26-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, sentence <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sentences):</span>
<span id="cb26-21">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sentence<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">년형: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>weighted_counts[i]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-22"></span>
<span id="cb26-23">total_weighted <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(weighted_counts)</span>
<span id="cb26-24">probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> count <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> weighted_counts]</span>
<span id="cb26-25"></span>
<span id="cb26-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">무작위로 선택한 죄수의 형량 분포:"</span>)</span>
<span id="cb26-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, sentence <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sentences):</span>
<span id="cb26-28">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sentence<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">년형 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>probabilities[i]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-29"></span>
<span id="cb26-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">3년형을 받을 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>probabilities[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-31"></span>
<span id="cb26-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 평균 잔여 형량 계산</span></span>
<span id="cb26-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 형량에 대해 평균 잔여 기간을 계산</span></span>
<span id="cb26-34">avg_remaining <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sentence <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sentences:</span>
<span id="cb26-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 균등분포 가정: 0부터 sentence까지 균등하게 분포</span></span>
<span id="cb26-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 평균 잔여 기간 = sentence/2</span></span>
<span id="cb26-38">    avg_remaining.append(sentence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-39"></span>
<span id="cb26-40"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">형량별 평균 잔여 기간:"</span>)</span>
<span id="cb26-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, sentence <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sentences):</span>
<span id="cb26-42">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sentence<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">년형: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>avg_remaining[i]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">년"</span>)</span>
<span id="cb26-43"></span>
<span id="cb26-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 전체 평균 잔여 형량 (가중평균)</span></span>
<span id="cb26-45">overall_avg_remaining <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(prob <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> remaining <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> prob, remaining <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(probabilities, avg_remaining))</span>
<span id="cb26-46"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">관찰된 죄수들의 평균 잔여 형량: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>overall_avg_remaining<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">년"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>형량별 가중 죄수 수:
1년형: 0.5
2년형: 1.0
3년형: 1.5

무작위로 선택한 죄수의 형량 분포:
1년형 확률: 0.167
2년형 확률: 0.333
3년형 확률: 0.500

3년형을 받을 확률: 0.500

형량별 평균 잔여 기간:
1년형: 0.5년
2년형: 1.0년
3년형: 1.5년

관찰된 죄수들의 평균 잔여 형량: 1.167년</code></pre>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">5-5</h3>
<p>Exercise: The Doomsday argument is “a probabilistic argument that claims to predict the number of future members of the human species given an estimate of the total number of humans born so far.”</p>
<p>Suppose there are only two kinds of intelligent civilizations that can happen in the universe. The “short-lived” kind go exinct after only 200 billion individuals are born. The “long-lived” kind survive until 2,000 billion individuals are born. And suppose that the two kinds of civilization are equally likely. Which kind of civilization do you think we live in?</p>
<p>The Doomsday argument says we can use the total number of humans born so far as data. According to the Population Reference Bureau, the total number of people who have ever lived is about 108 billion.</p>
<p>Since you were born quite recently, let’s assume that you are, in fact, human being number 108 billion. If N is the total number who will ever live and we consider you to be a randomly-chosen person, it is equally likely that you could have been person 1, or N , or any number in between. So what is the probability that you would be number 108 billion?</p>
<p>Given this data and dubious prior, what is the probability that our civilization will be short-lived?</p>
<div id="d680b1b7" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Doomsday Argument 문제 해결</span></span>
<span id="cb28-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 핵심: 베이즈 정리를 사용하여 현재까지 태어난 인구수로부터 문명의 유형을 추정</span></span>
<span id="cb28-3"></span>
<span id="cb28-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb28-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb28-6"></span>
<span id="cb28-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 문제 설정</span></span>
<span id="cb28-8">observed_position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">108</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 108번째 인간 (단위: 10억)</span></span>
<span id="cb28-9">short_lived_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 단명형 문명의 총 인구 (단위: 10억) </span></span>
<span id="cb28-10">long_lived_total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 장명형 문명의 총 인구 (단위: 10억)</span></span>
<span id="cb28-11"></span>
<span id="cb28-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사전확률: 두 종류의 문명이 동일한 확률</span></span>
<span id="cb28-13">prior_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb28-14">prior_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb28-15"></span>
<span id="cb28-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Doomsday Argument 분석 ==="</span>)</span>
<span id="cb28-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"관찰된 데이터: 현재까지 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>observed_position<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">억 명이 태어남"</span>)</span>
<span id="cb28-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"단명형 문명: 총 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>short_lived_total<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">억 명까지 생존"</span>)</span>
<span id="cb28-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"장명형 문명: 총 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>long_lived_total<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">억 명까지 생존"</span>)</span>
<span id="cb28-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"사전확률: 각각 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prior_short<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-21"></span>
<span id="cb28-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Likelihood 계산</span></span>
<span id="cb28-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 만약 총 N명이 태어날 문명이라면, 내가 108번째일 확률은 1/N (균등분포 가정)</span></span>
<span id="cb28-24"></span>
<span id="cb28-25">likelihood_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> short_lived_total <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> observed_position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> short_lived_total <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb28-26">likelihood_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> long_lived_total <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> observed_position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> long_lived_total <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb28-27"></span>
<span id="cb28-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">=== Likelihood 계산 ==="</span>)</span>
<span id="cb28-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"단명형 문명에서 108번째일 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>likelihood_short<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-30"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"장명형 문명에서 108번째일 확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>likelihood_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-31"></span>
<span id="cb28-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 베이즈 정리 적용</span></span>
<span id="cb28-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># P(단명형|데이터) = P(데이터|단명형) × P(단명형) / P(데이터)</span></span>
<span id="cb28-34"></span>
<span id="cb28-35">numerator_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> likelihood_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior_short</span>
<span id="cb28-36">numerator_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> likelihood_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior_long</span>
<span id="cb28-37">denominator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> numerator_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> numerator_long</span>
<span id="cb28-38"></span>
<span id="cb28-39">posterior_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> numerator_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator</span>
<span id="cb28-40">posterior_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> numerator_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denominator</span>
<span id="cb28-41"></span>
<span id="cb28-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 베이즈 업데이트 결과 ==="</span>)</span>
<span id="cb28-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"단명형 문명일 사후확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_short<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_short<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%)"</span>)</span>
<span id="cb28-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"장명형 문명일 사후확률: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_long<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%)"</span>)</span>
<span id="cb28-45"></span>
<span id="cb28-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 추가 분석: 베이즈 팩터</span></span>
<span id="cb28-47">bayes_factor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (likelihood_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> likelihood_long) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> likelihood_long <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inf'</span>)</span>
<span id="cb28-48"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 추가 분석 ==="</span>)</span>
<span id="cb28-49"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"베이즈 팩터 (단명형/장명형): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bayes_factor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-50"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"이는 관찰된 데이터가 단명형을 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bayes_factor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">배 더 지지함을 의미"</span>)</span>
<span id="cb28-51"></span>
<span id="cb28-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결론</span></span>
<span id="cb28-53"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 결론 ==="</span>)</span>
<span id="cb28-54"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> posterior_short <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> posterior_long:</span>
<span id="cb28-55">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Doomsday argument에 따르면, 우리 문명은 단명형일 확률이 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_short<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%로 더 높습니다."</span>)</span>
<span id="cb28-56">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"이는 직관과 반대되는 결과로, 108억이라는 관찰값이 200억보다 2000억에 더 가깝지만,"</span>)</span>
<span id="cb28-57">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"확률적으로는 단명형에서 이 값이 나올 가능성이 더 높다고 계산됩니다."</span>)</span>
<span id="cb28-58"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb28-59">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"우리 문명은 장명형일 확률이 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_long<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">%로 더 높습니다."</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Doomsday Argument 분석 ===
관찰된 데이터: 현재까지 108억 명이 태어남
단명형 문명: 총 200억 명까지 생존
장명형 문명: 총 2000억 명까지 생존
사전확률: 각각 0.5

=== Likelihood 계산 ===
단명형 문명에서 108번째일 확률: 0.005000
장명형 문명에서 108번째일 확률: 0.000500

=== 베이즈 업데이트 결과 ===
단명형 문명일 사후확률: 0.909091 (90.91%)
장명형 문명일 사후확률: 0.090909 (9.09%)

=== 추가 분석 ===
베이즈 팩터 (단명형/장명형): 10.0
이는 관찰된 데이터가 단명형을 10.0배 더 지지함을 의미

=== 결론 ===
Doomsday argument에 따르면, 우리 문명은 단명형일 확률이 90.9%로 더 높습니다.
이는 직관과 반대되는 결과로, 108억이라는 관찰값이 200억보다 2000억에 더 가깝지만,
확률적으로는 단명형에서 이 값이 나올 가능성이 더 높다고 계산됩니다.</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/04.html</guid>
  <pubDate>Wed, 18 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>비율 추정</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<div id="9759e6f1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> binom</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> make_binominal(n, p):</span>
<span id="cb1-6">  ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-7">  ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(ks, n, p)</span>
<span id="cb1-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Pmf(ps, ks)</span></code></pre></div>
</div>
<section id="유로-동전-문제" class="level2">
<h2 class="anchored" data-anchor-id="유로-동전-문제">유로 동전 문제</h2>
<div id="285dcaa7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-2"></span>
<span id="cb2-3">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb2-4"></span>
<span id="cb2-5">pmf_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make_binominal(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb2-6">pmf_k.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'coin'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb2-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'coin toss 이항분포'</span>)</span>
<span id="cb2-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'앞면이 나온 횟수(k)'</span>)</span>
<span id="cb2-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-3-output-2.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>동전을 250번 던져서 앞면의 횟수가 140과 같은 극단적인 값이 나올 확률</li>
</ul>
<div id="793755c3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">pmf_k.prob_ge(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pmf_k.prob_le(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>0.06642115124004333</code></pre>
</div>
</div>
</section>
<section id="베이지안-추정" class="level2">
<h2 class="anchored" data-anchor-id="베이지안-추정">베이지안 추정</h2>
<ul>
<li>동전 앞면의 비율을 균등분포로 가정하고 시작</li>
</ul>
<div id="50a57b96" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb6-2">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb6-3">likelihood_heads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hypos</span>
<span id="cb6-4">likelihood_tails <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hypos</span>
<span id="cb6-5">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb6-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>: likelihood_heads,</span>
<span id="cb6-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'T'</span>: likelihood_tails</span>
<span id="cb6-8">}</span>
<span id="cb6-9">prior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.00</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.01</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.02</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.03</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.04</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.96</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.97</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0.98</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0.99</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.00</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>101 rows × 1 columns</p>
</div>
</div>
</div>
<div id="660a22a1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_euro(pmf, dataset):</span>
<span id="cb7-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> data <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dataset:</span>
<span id="cb7-3">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood[data]</span>
<span id="cb7-4">  pmf.normalize()</span></code></pre></div>
</div>
<div id="51d4a725" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.copy()</span>
<span id="cb8-2">dataset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'T'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span></span>
<span id="cb8-3"></span>
<span id="cb8-4">update_euro(posterior, dataset)</span>
<span id="cb8-5"></span>
<span id="cb8-6">posterior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'coin'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb8-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'동전 앞면 비율의 사후확률 분포'</span>)</span>
<span id="cb8-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'동전 앞면의 비율'</span>)</span>
<span id="cb8-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-7-output-2.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="49d69bda" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'동전의 앞면이 250번 중 140번 등장했다면 앞면의 비율은 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>max_prob()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">일 확률이 가장 높다.'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>동전의 앞면이 250번 중 140번 등장했다면 앞면의 비율은 0.56일 확률이 가장 높다.</code></pre>
</div>
</div>
</section>
<section id="삼각사전분포" class="level2">
<h2 class="anchored" data-anchor-id="삼각사전분포">삼각사전분포</h2>
<ul>
<li>사전확률을 균등분포로 설정했지만, 실제로는 정규분포에 가까울 것이다.</li>
<li>근데 책에서는 일단 삼각분포를 사용한다.</li>
</ul>
<div id="1ef25865" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">ramp_up <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb12-2">ramp_down <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-3">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.append(ramp_up, ramp_down)</span>
<span id="cb12-4">triangle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(a, hypos, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'triangle'</span>)</span>
<span id="cb12-5">triangle.normalize()</span>
<span id="cb12-6"></span>
<span id="cb12-7">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniform'</span>)</span>
<span id="cb12-8">uniform.normalize()</span>
<span id="cb12-9"></span>
<span id="cb12-10">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'균등사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb12-11">triangle.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'삼각사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb12-12">plt.legend()</span>
<span id="cb12-13">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'삼각사전분포 및 균등사전분포'</span>)</span>
<span id="cb12-14">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'동전 앞면의 비율'</span>)</span>
<span id="cb12-15">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-9-output-2.png" width="609" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3ac883e3" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">update_euro(uniform, dataset)</span>
<span id="cb14-2">update_euro(triangle, dataset)</span>
<span id="cb14-3"></span>
<span id="cb14-4">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'균등사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb14-5">triangle.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'삼각사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb14-6">plt.legend()</span>
<span id="cb14-7">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'삼각 및 균등 사후분포'</span>)</span>
<span id="cb14-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'동전 앞면의 비율'</span>)</span>
<span id="cb14-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-10-output-2.png" width="594" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>두 확률분포의 사후 분포간 차이는 미미함.</li>
<li>데이터가 충분하다면 서로 다른 사전확률로 시작한다고 해도 동일한 사후확률로 수렴하는 경향이 있다.</li>
</ul>
</section>
<section id="이항가능도함수" class="level2">
<h2 class="anchored" data-anchor-id="이항가능도함수">이항가능도함수</h2>
<ul>
<li>갱신을 굳이 250번 하지 않아도, 이항분포를 통해 가능도를 한번에 계산할 수 있다.</li>
</ul>
<div id="01b69e10" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_binomial(pmf, data):</span>
<span id="cb16-2">  k, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data</span>
<span id="cb16-3">  xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs</span>
<span id="cb16-4">  likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(k, n, xs)</span>
<span id="cb16-5">  pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb16-6">  pmf.normalize()</span></code></pre></div>
</div>
<div id="1b3dc894" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">uniform2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniform2'</span>)</span>
<span id="cb17-2">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb17-3">update_binomial(uniform2, data)</span>
<span id="cb17-4">np.allclose(uniform, uniform2)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">4-1</h3>
<div id="e210cb7f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb19-2">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb19-3">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform.copy()</span>
<span id="cb19-4">prior.normalize()</span>
<span id="cb19-5"></span>
<span id="cb19-6">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb19-7">update_binomial(uniform, data)</span>
<span id="cb19-8">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb19-9">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb19-10">plt.legend()</span>
<span id="cb19-11">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전 vs 사후 분포'</span>)</span>
<span id="cb19-12">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'안타 비율'</span>)</span>
<span id="cb19-13">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-13-output-2.png" width="602" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">4-2</h3>
<div id="15cbdf19" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_randomized_response(pmf, data):</span>
<span id="cb21-2">    yes_count, total <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data</span>
<span id="cb21-3">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs</span>
<span id="cb21-4">    prob_yes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ps</span>
<span id="cb21-5">    likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(yes_count, total, prob_yes)</span>
<span id="cb21-6">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb21-7">    pmf.normalize()</span>
<span id="cb21-8"></span>
<span id="cb21-9">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb21-10">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb21-11">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform.copy()</span>
<span id="cb21-12">prior.normalize()</span>
<span id="cb21-13"></span>
<span id="cb21-14">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb21-15">update_randomized_response(uniform, data)</span>
<span id="cb21-16"></span>
<span id="cb21-17">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb21-18">uniform.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb21-19">plt.legend()</span>
<span id="cb21-20">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Randomized Response - 사전 vs 사후 분포'</span>)</span>
<span id="cb21-21">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'탈세자 비율 (p)'</span>)</span>
<span id="cb21-22">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span>
<span id="cb21-23">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-14-output-1.png" width="594" height="452" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="bc56ff0a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">most_likely_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform.max_prob()</span>
<span id="cb22-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'가장 가능성이 높은 탈세자 비율: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>most_likely_rate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb22-3"></span>
<span id="cb22-4">credible_interval <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform.credible_interval(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>)</span>
<span id="cb22-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'95% 신뢰구간: [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>credible_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>credible_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">]'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가장 가능성이 높은 탈세자 비율: 0.600
95% 신뢰구간: [0.420, 0.730]</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">4-3</h3>
<div id="d3de9b38" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_machine_response(pmf, data, y):</span>
<span id="cb24-2">    k, n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data</span>
<span id="cb24-3">    xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pmf.qs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y</span>
<span id="cb24-4">    likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> binom.pmf(k, n, xs)</span>
<span id="cb24-5">    pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb24-6">    pmf.normalize()</span>
<span id="cb24-7"></span>
<span id="cb24-8">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb24-9">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb24-10"></span>
<span id="cb24-11">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb24-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>):</span>
<span id="cb24-13">    dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform.copy()</span>
<span id="cb24-14">    update_machine_response(dist, data, y)</span>
<span id="cb24-15">    dist.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'y=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb24-16">plt.legend()</span>
<span id="cb24-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y에 따른 앞면의 비율'</span>)</span>
<span id="cb24-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'동전 앞면의 비율'</span>)</span>
<span id="cb24-19">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>Text(0, 0.5, 'PMF')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-16-output-2.png" width="594" height="452" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">4-4</h3>
<div id="1b9b7c02" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb26-2">uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb26-3">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb26-4">prior.normalize()</span>
<span id="cb26-5"></span>
<span id="cb26-6">prob_both_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hypos) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb26-7">prob_both_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hypos)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb26-8">prob_both_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb26-9"></span>
<span id="cb26-10">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prob_both_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> prob_both_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> prob_both_2</span>
<span id="cb26-11">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uniform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb26-12">posterior.normalize()</span>
<span id="cb26-13"></span>
<span id="cb26-14">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전분포'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>)</span>
<span id="cb26-15">posterior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사후분포'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>)</span>
<span id="cb26-16">plt.legend()</span>
<span id="cb26-17">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사전 분포와 사후분포'</span>)</span>
<span id="cb26-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'우주선을 맞출 확률 (x)'</span>)</span>
<span id="cb26-19">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span>
<span id="cb26-20"></span>
<span id="cb26-21">prior_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior.mean()</span>
<span id="cb26-22">posterior_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior.mean()</span>
<span id="cb26-23"></span>
<span id="cb26-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 연습문제 4-4 답변 ==="</span>)</span>
<span id="cb26-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> posterior_mean <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> prior_mean:</span>
<span id="cb26-26">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"✅ 데이터는 좋은 소식입니다 (GOOD)"</span>)</span>
<span id="cb26-27">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"✅ x의 추정값이 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prior_mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">에서 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">로 증가했습니다 (INCREASE)"</span>)</span>
<span id="cb26-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb26-29">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"❌ 데이터는 나쁜 소식입니다 (BAD)"</span>)</span>
<span id="cb26-30">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"❌ x의 추정값이 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>prior_mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">에서 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>posterior_mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">로 감소했습니다 (DECREASE)"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 연습문제 4-4 답변 ===
❌ 데이터는 나쁜 소식입니다 (BAD)
❌ x의 추정값이 0.250에서 0.235로 감소했습니다 (DECREASE)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03_files/figure-html/cell-17-output-2.png" width="602" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/03.html</guid>
  <pubDate>Wed, 18 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>분포</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/02.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="pmf를-이용한-확률" class="level2">
<h2 class="anchored" data-anchor-id="pmf를-이용한-확률">Pmf를 이용한 확률</h2>
<section id="쿠키-문제" class="level3">
<h3 class="anchored" data-anchor-id="쿠키-문제">쿠키 문제</h3>
<div id="63b9c69d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> empiricaldist <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Pmf</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"></span>
<span id="cb1-4">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bowl 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bowl 2'</span>])</span>
<span id="cb1-5">likelihood_vanilla <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span>
<span id="cb1-6">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_vanilla</span>
<span id="cb1-7">posterior.normalize()</span>
<span id="cb1-8">posterior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bowl 1</td>
<td>0.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Bowl 2</td>
<td>0.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>만약 같은 그릇에서 한 번 더 쿠키를 꺼냈을 때 바닐라일 경우</li>
</ul>
<div id="5b58adf3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood_vanilla</span>
<span id="cb2-2">posterior.normalize()</span>
<span id="cb2-3">posterior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bowl 1</td>
<td>0.692308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Bowl 2</td>
<td>0.307692</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>만약 같은 그릇에서 한 번 더 쿠키를 꺼냈을 때 초코쿠키일 경우</li>
</ul>
<div id="7146a469" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">likelihood_chocolate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span>
<span id="cb3-2">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood_chocolate</span>
<span id="cb3-3">posterior.normalize()</span>
<span id="cb3-4">posterior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Bowl 1</td>
<td>0.529412</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Bowl 2</td>
<td>0.470588</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="개의-쿠키-그릇" class="level3">
<h3 class="anchored" data-anchor-id="개의-쿠키-그릇">101개의 쿠키 그릇</h3>
<ul>
<li>그릇 i에는 바닐라 쿠키가 i% 있다.</li>
<li>임의의 그릇을 골라 쿠키를 임의로 꺼냈을 때, 바닐라 쿠키라면 그릇 x에서 쿠키가 나왔을 확률은 얼마일까?</li>
</ul>
<div id="82aeb063" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-2"></span>
<span id="cb4-3">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb4-4">prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, hypos)</span>
<span id="cb4-5">prior.normalize()</span>
<span id="cb4-6">prior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.009901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.009901</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.009901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.009901</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.009901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>0.009901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>0.009901</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">98</td>
<td>0.009901</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>0.009901</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">100</td>
<td>0.009901</td>
</tr>
</tbody>
</table>

<p>101 rows × 1 columns</p>
</div>
</div>
</div>
<div id="d8ff2e13" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">likelihood_vanilla <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-2">posterior1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> prior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_vanilla</span>
<span id="cb5-3">posterior1.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0.5000000000000001</code></pre>
</div>
</div>
<div id="7e7795cf" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb7-2"></span>
<span id="cb7-3">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb7-4">prior.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C5'</span>)</span>
<span id="cb7-5">posterior1.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'posterior'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb7-6">plt.legend()</span>
<span id="cb7-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'그릇 번호'</span>)</span>
<span id="cb7-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span>
<span id="cb7-9">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'바닐라 쿠키 하나 뽑은 후'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>Text(0.5, 1.0, '바닐라 쿠키 하나 뽑은 후')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/02_files/figure-html/cell-7-output-2.png" width="609" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>한 번 더 뽑았을 때 바닐라 쿠키인 경우</li>
</ul>
<div id="9cf40a94" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">posterior2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_vanilla</span>
<span id="cb9-2">posterior2.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0.6699999999999999</code></pre>
</div>
</div>
<div id="864f7540" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">posterior2.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'posterior'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb11-2">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'그릇 번호'</span>)</span>
<span id="cb11-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span>
<span id="cb11-4">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'바닐라 쿠키 두 번 뽑은 후'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Text(0.5, 1.0, '바닐라 쿠키 두 번 뽑은 후')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/02_files/figure-html/cell-9-output-2.png" width="601" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>한 번 더 뽑았는데 초코 쿠키인 경우</li>
</ul>
<div id="6ab9c2f8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">likelihood_chocolate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb13-2">posterior3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> posterior2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood_chocolate</span>
<span id="cb13-3">posterior3.normalize()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>0.2462686567164179</code></pre>
</div>
</div>
<div id="1a0bdc6e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">posterior3.plot(label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'posterior'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C4'</span>)</span>
<span id="cb15-2">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'그릇 번호'</span>)</span>
<span id="cb15-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PMF'</span>)</span>
<span id="cb15-4">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'바닐라 쿠키 두 번 뽑고 초코 쿠키 하나 뽑은 후'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Text(0.5, 1.0, '바닐라 쿠키 두 번 뽑고 초코 쿠키 하나 뽑은 후')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/02_files/figure-html/cell-11-output-2.png" width="609" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="aa3fa795" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">posterior3.max_prob()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>67</code></pre>
</div>
</div>
<ul>
<li>MAP: 사후확률 분포에서 가장 큰 확률값</li>
</ul>
</section>
<section id="주사위-문제" class="level3">
<h3 class="anchored" data-anchor-id="주사위-문제">주사위 문제</h3>
<div id="f17d0ccf" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_dice(pmf, data):</span>
<span id="cb19-2">  hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf.qs</span>
<span id="cb19-3">  likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> hypos</span>
<span id="cb19-4">  likelihood[data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> hypos] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb19-5">  pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> likelihood</span>
<span id="cb19-6">  pmf.normalize()</span></code></pre></div>
</div>
<ul>
<li>주사위를 굴려서 1이 나왔다.</li>
</ul>
<div id="9302623e" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span>
<span id="cb20-2">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, hypos)</span>
<span id="cb20-3">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb20-4">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.444444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>0.333333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.222222</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>주사위를 한번 더 굴렸는데 7이 나왔다.</li>
</ul>
<div id="dd598859" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb21-2">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>0.692308</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.307692</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">3-1</h3>
<div id="dbab164f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span>
<span id="cb22-2">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, hypos)</span>
<span id="cb22-3">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb22-4">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb22-5">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb22-6">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb22-7">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>0.835052</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>0.164948</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">3-2</h3>
<div id="aba9382b" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">hypos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>]</span>
<span id="cb23-2">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>], hypos)</span>
<span id="cb23-3">update_dice(pmf, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb23-4">pmf</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.391304</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>0.347826</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>0.260870</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">3-3</h3>
<div id="7b46a14e" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pmf.from_seq([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'서랍 1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'서랍 2'</span>])</span>
<span id="cb24-2">likelihood <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb24-3">posterior <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pmf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> likelihood</span>
<span id="cb24-4">posterior.normalize()</span>
<span id="cb24-5">posterior</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">probs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">서랍 1</td>
<td>0.818182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">서랍 2</td>
<td>0.181818</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/02.html</guid>
  <pubDate>Wed, 18 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>베이즈 정리</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/01.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="이론" class="level2">
<h2 class="anchored" data-anchor-id="이론">이론</h2>
<p>사전확률을 이용해서 사후확률을 구하는 과정을 베이즈 갱신이라고 한다.</p>
<p><img src="https://latex.codecogs.com/png.latex?P(H%7CD)%20=%20%5Cfrac%7BP(D%7CH)P(H)%7D%7BP(D)%7D"></p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?P(H)">: 가설의 확률. 사전확률</li>
<li><img src="https://latex.codecogs.com/png.latex?P(H%7CD)">: 데이터가 주어졌을 때 가설의 확률. 사후확률</li>
<li><img src="https://latex.codecogs.com/png.latex?P(D%7CH)">: 가설하에서 데이터가 나올 확률. 가능도(우도)</li>
<li><img src="https://latex.codecogs.com/png.latex?P(D)">: 데이터의 확률. <img src="https://latex.codecogs.com/png.latex?P(D)%20=%20%5Csum%20P(H_i)P(D%7CH_i)"></li>
</ul>
<p>가설은 상호 배제와 전체 포괄 가정이 필요하다.<br>
즉, 가설은 서로 배타적이어야 하고, 모든 가능한 가설을 포함해야 한다.</p>
</section>
<section id="베이즈-테이블" class="level2">
<h2 class="anchored" data-anchor-id="베이즈-테이블">베이즈 테이블</h2>
<ol type="1">
<li>가설과 데이터를 정리한다.</li>
<li>사전확률을 구한다.</li>
<li>각 가설 하에서의 데이터 가능도를 구한다.</li>
<li>베이즈 테이블을 정리한다.</li>
</ol>
<section id="쿠키-문제" class="level3">
<h3 class="anchored" data-anchor-id="쿠키-문제">쿠키 문제</h3>
<ul>
<li>그릇 1에서 바닐라 쿠키를 집을 확률은 3/4</li>
<li>그릇 2에서 바닐라 쿠키를 집을 확률은 1/2</li>
<li>바닐라 쿠키를 집었을 때, 그릇 i에서 집었을 확률은?</li>
</ul>
<div id="8105dc5a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"></span>
<span id="cb1-3">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bowl1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bowl2'</span>])</span>
<span id="cb1-4">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-5">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-6">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>]</span>
<span id="cb1-7">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'posterior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb1-8">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bowl1</td>
<td>0.5</td>
<td>0.75</td>
<td>0.375</td>
<td>0.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bowl2</td>
<td>0.5</td>
<td>0.50</td>
<td>0.250</td>
<td>0.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="주사위-문제" class="level3">
<h3 class="anchored" data-anchor-id="주사위-문제">주사위 문제</h3>
<ul>
<li>육면체, 팔면체, 십이면체 주사위가 든 상자가 있다.</li>
<li>이 중 임의로 하나를 집어 굴렸더니 1이 나왔다.</li>
<li>이 주사위가 육면체일 확률은?</li>
</ul>
<div id="2eee8e8e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update(table):</span>
<span id="cb2-2">  table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>]</span>
<span id="cb2-3">  prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb2-4">  table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'posterior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unnorm'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> prob_data</span>
<span id="cb2-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> prob_data</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fractions <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Fraction</span>
<span id="cb2-8"></span>
<span id="cb2-9">table2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>])</span>
<span id="cb2-10">table2[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-11">table2[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb2-12">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table2)</span>
<span id="cb2-13">table2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1/3</td>
<td>1/6</td>
<td>1/18</td>
<td>4/9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>1/3</td>
<td>1/8</td>
<td>1/24</td>
<td>1/3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>1/3</td>
<td>1/12</td>
<td>1/36</td>
<td>2/9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="몬티홀-문제" class="level3">
<h3 class="anchored" data-anchor-id="몬티홀-문제">몬티홀 문제</h3>
<ul>
<li>1,2,3 번호가 붙은 세 개의 문 중 하나에 상품이 있다.</li>
<li>참가자는 문 하나를 선택하고, 사회자는 나머지 두 문 중 상품이 없는 문을 열어 보여준다.</li>
<li>참가자는 처음 선택한 문을 유지하거나 다른 문으로 바꿀 수 있다.</li>
<li>당신은 1번 문을 선택했고, 사회자는 문 3을 열었다.</li>
<li>다시 참가자가 문을 선택했을 때 상품이 있는 문을 선택할 확률은?</li>
</ul>
<div id="9a73c150" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">table3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb3-2">table3[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb3-3">table3[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table3)</span>
<span id="cb3-5">table3</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1/3</td>
<td>1/2</td>
<td>1/6</td>
<td>1/3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1/3</td>
<td>1</td>
<td>1/3</td>
<td>2/3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1/3</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">2-1</h3>
<div id="2bf59a66" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'normal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weird'</span>])</span>
<span id="cb4-2">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-3">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table)</span>
<span id="cb4-5">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">normal</td>
<td>1/2</td>
<td>1/2</td>
<td>1/4</td>
<td>1/3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">weird</td>
<td>1/2</td>
<td>1</td>
<td>1/2</td>
<td>2/3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2-2</h3>
<div id="23d2ba46" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bb'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bg'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gb'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gg'</span>])</span>
<span id="cb5-2">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb5-3">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table)</span>
<span id="cb5-5">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bb</td>
<td>1/4</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bg</td>
<td>1/4</td>
<td>1</td>
<td>1/4</td>
<td>1/3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gb</td>
<td>1/4</td>
<td>1</td>
<td>1/4</td>
<td>1/3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gg</td>
<td>1/4</td>
<td>1</td>
<td>1/4</td>
<td>1/3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">2-3</h3>
<div id="aa5c3213" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb6-2">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb6-3">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table)</span>
<span id="cb6-5">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1/3</td>
<td>1</td>
<td>1/3</td>
<td>1/2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1/3</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1/3</td>
<td>1</td>
<td>1/3</td>
<td>1/2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f7761091" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb7-2">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-3">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table)</span>
<span id="cb7-5">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1/3</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>1/3</td>
<td>1</td>
<td>1/3</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1/3</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3">2-4</h3>
<div id="0721211f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1994_1996'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1996_1994'</span>])</span>
<span id="cb8-2">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prior'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-3">table[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'likelihood'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> Fraction(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb8-4">prob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> update(table)</span>
<span id="cb8-5">table</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prior</th>
<th data-quarto-table-cell-role="th">likelihood</th>
<th data-quarto-table-cell-role="th">unnorm</th>
<th data-quarto-table-cell-role="th">posterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994_1996</td>
<td>1/2</td>
<td>1/25</td>
<td>1/50</td>
<td>20/27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1996_1994</td>
<td>1/2</td>
<td>7/500</td>
<td>7/1000</td>
<td>7/27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/01.html</guid>
  <pubDate>Wed, 18 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>EDA</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/statistics/00.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="plot을-통한-자료-요약" class="level2">
<h2 class="anchored" data-anchor-id="plot을-통한-자료-요약">plot을 통한 자료 요약</h2>
<section id="범주형-자료-요약" class="level3">
<h3 class="anchored" data-anchor-id="범주형-자료-요약">범주형 자료 요약</h3>
<ol type="1">
<li>도수분포표</li>
</ol>
<div id="e5a336f1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> color_palette</span>
<span id="cb1-5"></span>
<span id="cb1-6">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)).sample(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, replace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-7">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.crosstab(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df.values.flatten(), colnames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'질병'</span>], columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'도수'</span>)</span>
<span id="cb1-8">table.index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"감염"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"심장"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"호흡기"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"소화기"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"신경"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"근골격"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"내분비"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"정신"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"피부"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"기타"</span>]</span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(table)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>질병   도수
감염    8
심장   11
호흡기   9
소화기   4
신경   15
근골격  12
내분비  11
정신    9
피부    9
기타   12</code></pre>
</div>
</div>
<ol type="1">
<li>원형 그래프</li>
</ol>
<div id="cc23b672" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.family'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Noto Sans KR'</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">table.plot(kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bar'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'skyblue'</span>, legend<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb3-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사망 원인'</span>)</span>
<span id="cb3-5">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'빈도수'</span>)</span>
<span id="cb3-6">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사망 원인별 빈도수'</span>)</span>
<span id="cb3-7">plt.xticks(rotation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-8">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/statistics/00_files/figure-html/cell-3-output-1.png" width="583" height="451" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>막대 그래프</li>
</ol>
<div id="c3347ac5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">plt.pie(table.iloc[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(table.index), colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>color_palette(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pastel"</span>), autopct<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%1.1f%%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb4-2">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'사망 원인별 빈도수'</span>)</span>
<span id="cb4-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/statistics/00_files/figure-html/cell-4-output-1.png" width="400" height="409" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>파레토그림 (명목형)</li>
</ol>
<ul>
<li>가장 큰 영향을 미치는 범주를 파악할 수 있는 그래프</li>
<li>라이브러리는 딱히 없는거 같고, 뭐 많이 쓰지도 않는거 같아서 구현은 생략</li>
</ul>
</section>
<section id="이산형-자료-요약" class="level3">
<h3 class="anchored" data-anchor-id="이산형-자료-요약">이산형 자료 요약</h3>
<ul>
<li>관측값의 종료가 적은 경우 그냥 범주형으로 처리할 수 있다. (단 파레토그림같은 순서가 바뀌는 기법은 사용하지 않는다.)</li>
<li>관측값의 종류가 많을 경우, 연속형 자료로 처리할 수 있다.</li>
</ul>
</section>
<section id="연속형-자료-요약" class="level3">
<h3 class="anchored" data-anchor-id="연속형-자료-요약">연속형 자료 요약</h3>
<ol type="1">
<li><p>점도표</p></li>
<li><p>도수분포표</p></li>
</ol>
<ul>
<li>구간을 정하고 각 구간에 속하는 관측값의 개수를 세어 도수분포표를 만든다.</li>
</ul>
<ol type="1">
<li>히스토그램</li>
</ol>
<ul>
<li>상대도수를 계급구간의 폭으로 나눈 값을 막대의 높이로 사용하는 그래프</li>
</ul>
<ol type="1">
<li>도수다각형</li>
</ol>
<ul>
<li>중심의 위치, 퍼진 정도 등을 파악하는데 유용하다.</li>
<li>또한 여러 자료를 비교하는 경우 히스토그램보다 유용하다.</li>
</ul>
<ol type="1">
<li>줄기-잎 그림</li>
</ol>
<ul>
<li>개개의 관측값에 대한 정보를 유지하면서 분포를 파악할 수 있는 그래프</li>
<li>하지만 관측값의 갯수가 많거나 지나치게 흩어져 있는 경우 제한된 공간에 그리는 것이 불가능하다.</li>
</ul>
</section>
<section id="분포의-모양" class="level3">
<h3 class="anchored" data-anchor-id="분포의-모양">분포의 모양</h3>
<ol type="1">
<li>종모양</li>
<li>이봉형: 두 개의 다른 집단이 섞여 있을 때 종종 나타난다.</li>
<li>균일형</li>
<li>오른쪽 편중</li>
<li>왼쪽 편중</li>
</ol>
</section>
</section>
<section id="수치를-통한-연속형-자료-요약" class="level2">
<h2 class="anchored" data-anchor-id="수치를-통한-연속형-자료-요약">수치를 통한 연속형 자료 요약</h2>
<div id="b9f3f303" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">df.describe(include<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'all'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>100.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.700000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.840899</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>6.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>8.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>10.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="중심위치의-측도" class="level3">
<h3 class="anchored" data-anchor-id="중심위치의-측도">중심위치의 측도</h3>
<ul>
<li>평균, 중앙값, 최빈값</li>
</ul>
<div id="411aaf15" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stats</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'평균: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 중앙값: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 최빈값: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mode(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>평균: 5.7, 중앙값: 6.0, 최빈값: ModeResult(mode=array([5]), count=array([15]))</code></pre>
</div>
</div>
</section>
<section id="퍼진-정도의-측도" class="level3">
<h3 class="anchored" data-anchor-id="퍼진-정도의-측도">퍼진 정도의 측도</h3>
<ul>
<li>분산, 표준편차, 범위, 사분위수, 변동계수</li>
</ul>
<div id="5b8b16ab" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 자유도 -1</span></span>
<span id="cb8-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'분산: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>var(df, ddof<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 표준편차: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(df, ddof<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 범위: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>ptp(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 1,3분위수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>quantile(df, [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 변동계수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(df, ddof<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>분산: 0    8.070707
dtype: float64, 표준편차: 0    2.840899
dtype: float64, 범위: 9, 1,3분위수: [3. 8.], 변동계수: 0    0.498403
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="box-plot" class="level3">
<h3 class="anchored" data-anchor-id="box-plot">box plot</h3>
<ul>
<li>종모양의 데이터의 분포를 나타내는 데 적절하다.</li>
<li>사전에 도수분포표, 히스토그램, 줄기-잎 그림으로 봉우리를 파악해야 한다.</li>
</ul>
<div id="d857a92d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">plt.boxplot(df)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>{'whiskers': [&lt;matplotlib.lines.Line2D at 0x74d87129df10&gt;,
  &lt;matplotlib.lines.Line2D at 0x74d87129e210&gt;],
 'caps': [&lt;matplotlib.lines.Line2D at 0x74d87129e510&gt;,
  &lt;matplotlib.lines.Line2D at 0x74d87129e7e0&gt;],
 'boxes': [&lt;matplotlib.lines.Line2D at 0x74d8713c2450&gt;],
 'medians': [&lt;matplotlib.lines.Line2D at 0x74d87129eab0&gt;],
 'fliers': [&lt;matplotlib.lines.Line2D at 0x74d87129ed80&gt;],
 'means': []}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/statistics/00_files/figure-html/cell-8-output-2.png" width="564" height="412" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>데이터 분석</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/statistics/00.html</guid>
  <pubDate>Mon, 16 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>확률</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/00.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<div id="1ee15baa" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"></span>
<span id="cb1-3">gss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/AllenDowney/ThinkBayes2/master/data/gss_bayes.csv'</span>)</span>
<span id="cb1-4">banker <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'indus10'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6870</span>)</span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'은행원 수: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> banker<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'은행원 비율: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> banker<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>은행원 수: 728
은행원 비율: 0.014769730168391155</code></pre>
</div>
</div>
<section id="확률" class="level2">
<h2 class="anchored" data-anchor-id="확률">확률</h2>
<div id="c7112058" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> prob(A):</span>
<span id="cb3-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""A의 확률 계산"""</span></span>
<span id="cb3-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A.mean()</span>
<span id="cb3-4">prob(banker)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0.014769730168391155</code></pre>
</div>
</div>
<div id="7c6161e9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">female <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-2">prob(female)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0.5378575776019476</code></pre>
</div>
</div>
<div id="59576b31" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">liberal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'polviews'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-2">prob(liberal)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0.27374721038750255</code></pre>
</div>
</div>
<div id="2a71ea28" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">democrat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'partyid'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-2">prob(democrat)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0.3662609048488537</code></pre>
</div>
</div>
</section>
<section id="and-논리곱" class="level2">
<h2 class="anchored" data-anchor-id="and-논리곱">And 논리곱</h2>
<div id="2cbdbb73" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">prob(banker <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> democrat)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0.004686548995739501</code></pre>
</div>
</div>
</section>
<section id="조건부-확률" class="level2">
<h2 class="anchored" data-anchor-id="조건부-확률">조건부 확률</h2>
<div id="7e8187f2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">selected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> democrat[liberal]</span>
<span id="cb13-2">prob(selected)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0.5206403320240125</code></pre>
</div>
</div>
<p>진보(liberal) 성향 중 민주당(democrat)의 비율</p>
<div id="4acfbdd7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> conditional(proposition, given):</span>
<span id="cb15-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> prob(proposition[given])</span>
<span id="cb15-3">conditional(liberal, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>female)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0.27581004111500884</code></pre>
</div>
</div>
<div id="974376da" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">prob(liberal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> female) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> prob(female)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0.2758100411150089</code></pre>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?P(A%7CB)%20=%20%5Cfrac%7BP(A%20and%20B)%7D%7BP(B)%7D"></p>
<div id="8086091d" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(prob(female) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> conditional(liberal, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>female))</span>
<span id="cb19-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(prob(female <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> liberal))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14834652059241224
0.14834652059241227</code></pre>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?P(A%20and%20B)%20=%20P(B)P(A%7CB)"></p>
<div id="42b923c2" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">conditional(female, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>liberal)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>0.5419106203216483</code></pre>
</div>
</div>
<p>조건부 확률은 교환 불가</p>
<div id="8728b21a" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(conditional(female, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>liberal))</span>
<span id="cb23-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(prob(female) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> conditional(liberal, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>female) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> prob(liberal))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5419106203216483
0.5419106203216482</code></pre>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?P(A%7CB)%20=%20%5Cfrac%7BP(A)*P(B%7CA)%7D%7BP(B)%7D"></p>
<div id="d61aed09" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">male <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(prob(gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> conditional(banker, gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sex'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0.014769730168391153</code></pre>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?P(A)%20=%20P(B_1)P(A%7CB_1)%20+%20P(B_2)P(A%7CB_2)"></p>
</section>
<section id="조건과-논리곱" class="level2">
<h2 class="anchored" data-anchor-id="조건과-논리곱">조건과 논리곱</h2>
<div id="69f852ae" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">conditional(female, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>liberal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> democrat)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0.576085409252669</code></pre>
</div>
</div>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">연습문제</h2>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">1-1</h3>
<div id="5c04ac46" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">prob(female), prob(liberal), prob(democrat)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(0.5378575776019476, 0.27374721038750255, 0.3662609048488537)</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">1-2</h3>
<div id="5e9e9fa2" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">conditional(liberal, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>democrat), conditional(democrat, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>liberal)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(0.3891320002215698, 0.5206403320240125)</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2">1-3</h3>
<div id="894ef00a" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">young <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'age'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb33-2">old <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'age'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>)</span>
<span id="cb33-3">conservative <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gss[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'polviews'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb33-4">prob(young <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> liberal), conditional(liberal, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>young), prob(old <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> conservative), conditional(old, given<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>conservative)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(0.06579427875836884,
 0.338517745302714,
 0.06701156421180766,
 0.19597721609113564)</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/bayse/00.html</guid>
  <pubDate>Mon, 16 Jun 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>머신 러닝</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/04.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>



<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>데이터 분석</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/04.html</guid>
  <pubDate>Mon, 24 Feb 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>데이터 전처리</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/03.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="데이터-전처리의-의미" class="level2">
<h2 class="anchored" data-anchor-id="데이터-전처리의-의미">데이터 전처리의 의미</h2>
<ol type="1">
<li>데이터 클리닝</li>
<li>데이터 통합</li>
<li>데이터 변환</li>
<li>데이터 축소</li>
<li>불균형 데이터 처리</li>
<li>데이터 분할</li>
</ol>
</section>
<section id="이상치-확인-및-정제" class="level2">
<h2 class="anchored" data-anchor-id="이상치-확인-및-정제">이상치 확인 및 정제</h2>
<section id="이상치-확인" class="level3">
<h3 class="anchored" data-anchor-id="이상치-확인">이상치 확인</h3>
<div id="e0aab155" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pandas.core.common <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random_state</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_wine</span>
<span id="cb1-5"></span>
<span id="cb1-6">wine_load <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_wine()</span>
<span id="cb1-7">wine <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(wine_load.data, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wine_load.feature_names)</span>
<span id="cb1-8">wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine_load.target</span>
<span id="cb1-9">wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>({<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_0'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_1'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_2'</span>})</span>
<span id="cb1-10"></span>
<span id="cb1-11">plt.boxplot(wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>], whis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb1-12">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Boxplot of color_intensity'</span>)</span>
<span id="cb1-13">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/03_files/figure-html/cell-2-output-1.png" width="566" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a5602cec" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> outliers_iqr(dt, col):</span>
<span id="cb2-4">    q1, q3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(dt[col], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>])</span>
<span id="cb2-5">    iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> q3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q1</span>
<span id="cb2-6">    lower_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> q1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb2-7">    upper_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> q3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb2-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> dt[(dt[col] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> lower_bound) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (dt[col] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> upper_bound)]</span>
<span id="cb2-9"></span>
<span id="cb2-10">outliers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outliers_iqr(wine, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>)</span>
<span id="cb2-11">outliers</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">malic_acid</th>
<th data-quarto-table-cell-role="th">ash</th>
<th data-quarto-table-cell-role="th">alcalinity_of_ash</th>
<th data-quarto-table-cell-role="th">magnesium</th>
<th data-quarto-table-cell-role="th">total_phenols</th>
<th data-quarto-table-cell-role="th">flavanoids</th>
<th data-quarto-table-cell-role="th">nonflavanoid_phenols</th>
<th data-quarto-table-cell-role="th">proanthocyanins</th>
<th data-quarto-table-cell-role="th">color_intensity</th>
<th data-quarto-table-cell-role="th">hue</th>
<th data-quarto-table-cell-role="th">od280/od315_of_diluted_wines</th>
<th data-quarto-table-cell-role="th">proline</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">151</td>
<td>12.79</td>
<td>2.67</td>
<td>2.48</td>
<td>22.0</td>
<td>112.0</td>
<td>1.48</td>
<td>1.36</td>
<td>0.24</td>
<td>1.26</td>
<td>10.80</td>
<td>0.48</td>
<td>1.47</td>
<td>480.0</td>
<td>class_2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">158</td>
<td>14.34</td>
<td>1.68</td>
<td>2.70</td>
<td>25.0</td>
<td>98.0</td>
<td>2.80</td>
<td>1.31</td>
<td>0.53</td>
<td>2.70</td>
<td>13.00</td>
<td>0.57</td>
<td>1.96</td>
<td>660.0</td>
<td>class_2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">159</td>
<td>13.48</td>
<td>1.67</td>
<td>2.64</td>
<td>22.5</td>
<td>89.0</td>
<td>2.60</td>
<td>1.10</td>
<td>0.52</td>
<td>2.29</td>
<td>11.75</td>
<td>0.57</td>
<td>1.78</td>
<td>620.0</td>
<td>class_2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">166</td>
<td>13.45</td>
<td>3.70</td>
<td>2.60</td>
<td>23.0</td>
<td>111.0</td>
<td>1.70</td>
<td>0.92</td>
<td>0.43</td>
<td>1.46</td>
<td>10.68</td>
<td>0.85</td>
<td>1.56</td>
<td>695.0</td>
<td>class_2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="이상치-정제" class="level3">
<h3 class="anchored" data-anchor-id="이상치-정제">이상치 정제</h3>
<ol type="1">
<li>이상치 제거</li>
</ol>
<div id="845e1c58" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">drop_outliers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine.drop(index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>outliers.index)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original:"</span>, wine.shape)</span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Drop outliers:"</span>, drop_outliers.shape)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original: (178, 14)
Drop outliers: (174, 14)</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>이상치 대체</li>
</ol>
<p>이상치를 NULL로 만든 후, 결측치와 함께 대체</p>
<div id="06470f51" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">wine.loc[outliers.index, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.NaN</span>
<span id="cb5-2"></span>
<span id="cb5-3">wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>].fillna(wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>].mean(), inplace<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-4">wine.loc[outliers.index, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_intensity'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>151    4.908678
158    4.908678
159    4.908678
166    4.908678
Name: color_intensity, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="범주형-데이터-처리" class="level2">
<h2 class="anchored" data-anchor-id="범주형-데이터-처리">범주형 데이터 처리</h2>
<div id="5dd16cfe" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_iris</span>
<span id="cb7-2"></span>
<span id="cb7-3">iris <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_iris()</span>
<span id="cb7-4">iris <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(iris.data, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris.feature_names)</span>
<span id="cb7-5">iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_iris().target</span>
<span id="cb7-6">iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>({<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Setosa'</span>, </span>
<span id="cb7-7">                                   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Versicolour'</span>, </span>
<span id="cb7-8">                                   <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Virginica'</span>})</span></code></pre></div>
</div>
</section>
<section id="데이터-분할" class="level2">
<h2 class="anchored" data-anchor-id="데이터-분할">데이터 분할</h2>
<div id="bcbdaffe" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.model_selection <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> train_test_split</span>
<span id="cb8-2"></span>
<span id="cb8-3">X_train, X_test, y_train, y_test <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_test_split(iris.drop(</span>
<span id="cb8-4">  columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>), iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>], test_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1004</span>)</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'X_train: '</span>, X_train.shape, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'X_test: '</span>, X_test.shape)</span>
<span id="cb8-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y_train: '</span>, y_train.shape, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y_test: '</span>, y_test.shape)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X_train:  (120, 4) X_test:  (30, 4)
y_train:  (120,) y_test:  (30,)</code></pre>
</div>
</div>
<div id="e1687c23" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">X_train.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal length (cm)</th>
<th data-quarto-table-cell-role="th">sepal width (cm)</th>
<th data-quarto-table-cell-role="th">petal length (cm)</th>
<th data-quarto-table-cell-role="th">petal width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>6.3</td>
<td>2.3</td>
<td>4.4</td>
<td>1.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>5.8</td>
<td>2.7</td>
<td>4.1</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">131</td>
<td>7.9</td>
<td>3.8</td>
<td>6.4</td>
<td>2.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1f2b76b6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">y_train.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>87     Versicolour
67     Versicolour
131      Virginica
Name: Class, dtype: object</code></pre>
</div>
</div>
<div id="cccf33a8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>].value_counts()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Class
Setosa         50
Versicolour    50
Virginica      50
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="6f15837d" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">y_train.value_counts()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Class
Versicolour    41
Setosa         40
Virginica      39
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="데이터-스케일링" class="level2">
<h2 class="anchored" data-anchor-id="데이터-스케일링">데이터 스케일링</h2>
<section id="standard-scaler" class="level3">
<h3 class="anchored" data-anchor-id="standard-scaler">Standard Scaler</h3>
<ul>
<li>평균이 0, 분산이 1이 되도록 변환</li>
<li>이상치에 민감하다.</li>
<li>회귀분석보다는 분류분석에 적합</li>
</ul>
<div id="1ff889fe" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RobustScaler, StandardScaler</span>
<span id="cb17-2"></span>
<span id="cb17-3">StdScaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb17-4"></span>
<span id="cb17-5">StdScaler.fit(X_train)</span>
<span id="cb17-6">X_train_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StdScaler.transform(X_train)</span>
<span id="cb17-7">X_test_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StdScaler.transform(X_test)</span></code></pre></div>
</div>
</section>
<section id="min-max-scaler" class="level3">
<h3 class="anchored" data-anchor-id="min-max-scaler">Min-Max Scaler</h3>
<ul>
<li>0 ~ 1 사이의 값으로 변환</li>
<li>이상치에 민감하다.</li>
<li>회귀분석에 적합</li>
</ul>
<div id="13de6070" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MinMaxScaler</span>
<span id="cb18-2"></span>
<span id="cb18-3">MinMaxScaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MinMaxScaler()</span>
<span id="cb18-4"></span>
<span id="cb18-5">MinMaxScaler.fit(X_train)</span>
<span id="cb18-6">X_train_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MinMaxScaler.transform(X_train)</span>
<span id="cb18-7"></span>
<span id="cb18-8">X_test_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MinMaxScaler.transform(X_test)</span></code></pre></div>
</div>
</section>
<section id="max-abs-scaler" class="level3">
<h3 class="anchored" data-anchor-id="max-abs-scaler">Max Abs Scaler</h3>
<ul>
<li>-1 ~ 1 사이의 값으로 변환</li>
<li>이상치에 민감하다.</li>
<li>회귀분석에 적합</li>
</ul>
<div id="ea5480f0" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MaxAbsScaler</span>
<span id="cb19-2"></span>
<span id="cb19-3">MaxAbsScaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MaxAbsScaler()</span>
<span id="cb19-4"></span>
<span id="cb19-5">MaxAbsScaler.fit(X_train)</span>
<span id="cb19-6">X_train_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MaxAbsScaler.transform(X_train)</span>
<span id="cb19-7"></span>
<span id="cb19-8">X_test_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MaxAbsScaler.transform(X_test)</span></code></pre></div>
</div>
</section>
<section id="robust-scaler" class="level3">
<h3 class="anchored" data-anchor-id="robust-scaler">Robust Scaler</h3>
<ul>
<li>중앙값을 0으로 설정하고, IQR을 사용하여 잉상치 영향을 최소화함</li>
</ul>
<div id="c86d94a7" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RobustScaler</span>
<span id="cb20-2"></span>
<span id="cb20-3">RobustScaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RobustScaler()</span>
<span id="cb20-4"></span>
<span id="cb20-5">RobustScaler.fit(X_train)</span>
<span id="cb20-6">X_train_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RobustScaler.transform(X_train)</span>
<span id="cb20-7"></span>
<span id="cb20-8">X_test_sc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RobustScaler.transform(X_test)</span></code></pre></div>
</div>
</section>
<section id="다시-완본으로-변경" class="level3">
<h3 class="anchored" data-anchor-id="다시-완본으로-변경">다시 완본으로 변경</h3>
<ul>
<li><code>scaler.inverse_transform()</code></li>
</ul>
<div id="ba195281" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">pd.DataFrame(X_train_sc).head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.384615</td>
<td>-1.4</td>
<td>0.028369</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.000000</td>
<td>-0.6</td>
<td>-0.056738</td>
<td>-0.200000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.615385</td>
<td>1.6</td>
<td>0.595745</td>
<td>0.466667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="15a163b3" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">X_original <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RobustScaler.inverse_transform(X_train_sc)</span>
<span id="cb22-2"></span>
<span id="cb22-3">pd.DataFrame(X_original).head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6.3</td>
<td>2.3</td>
<td>4.4</td>
<td>1.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.8</td>
<td>2.7</td>
<td>4.1</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7.9</td>
<td>3.8</td>
<td>6.4</td>
<td>2.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="차원-축소" class="level2">
<h2 class="anchored" data-anchor-id="차원-축소">차원 축소</h2>
<div id="9cb516c4" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb23-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris.drop(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>)</span>
<span id="cb23-3"></span>
<span id="cb23-4">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler().fit_transform(x)</span>
<span id="cb23-5"></span>
<span id="cb23-6">pd.DataFrame(x).head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.900681</td>
<td>1.019004</td>
<td>-1.340227</td>
<td>-1.315444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.143017</td>
<td>-0.131979</td>
<td>-1.340227</td>
<td>-1.315444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.385353</td>
<td>0.328414</td>
<td>-1.397064</td>
<td>-1.315444</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b272a63f" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb24-2"></span>
<span id="cb24-3">pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PCA(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb24-4">pca_fit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.fit(x)</span>
<span id="cb24-5"></span>
<span id="cb24-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(pca.singular_values_)</span>
<span id="cb24-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(pca.explained_variance_ratio_.cumsum())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[20.92306556 11.7091661   4.69185798  1.76273239]
[0.72962445 0.95813207 0.99482129 1.        ]</code></pre>
</div>
</div>
<div id="9fdaed7b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Scree Plot'</span>)</span>
<span id="cb26-2">plt.plot(pca.explained_variance_ratio_, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o-'</span>)</span>
<span id="cb26-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/03_files/figure-html/cell-20-output-1.png" width="571" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="데이터-불균형-문제-처리" class="level2">
<h2 class="anchored" data-anchor-id="데이터-불균형-문제-처리">데이터 불균형 문제 처리</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>데이터 분석</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/03.html</guid>
  <pubDate>Wed, 01 Jan 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>EDA와 시각화</title>
  <link>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="edaexploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="edaexploratory-data-analysis">EDA(Exploratory Data Analysis)</h2>
<p>: 데이터의 특징과 데이터에 내재된 관계를 알아내기 위해 그래프와 통계적 분석 방법을 활용하여 탐구하는 것</p>
<section id="주제" class="level3">
<h3 class="anchored" data-anchor-id="주제">주제</h3>
<ol type="1">
<li>저항성 강조: 부분적 변동(이상치 등)에 대한 민감성 확인</li>
<li>잔차 계산</li>
<li>자료변수의 재표현: 변수를 적당한 척도로 바꾸는 것</li>
<li>그래프를 통한 현시성</li>
</ol>
</section>
</section>
<section id="막대-그래프" class="level2">
<h2 class="anchored" data-anchor-id="막대-그래프">막대 그래프</h2>
<p><code>범주형 데이터</code>를 요약하고 시각적으로 비교하는 데 활용</p>
<div id="cb7e8a6f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_wine</span>
<span id="cb1-4"></span>
<span id="cb1-5">wine_load <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_wine()</span>
<span id="cb1-6">wine <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(wine_load.data, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wine_load.feature_names)</span>
<span id="cb1-7">wine_load</span>
<span id="cb1-8">wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine_load.target</span>
<span id="cb1-9">wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>({<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_0'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_1'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_2'</span>})</span>
<span id="cb1-10"></span>
<span id="cb1-11">wine_type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> wine[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Class'</span>].value_counts()</span>
<span id="cb1-12">wine_type</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Class
class_1    71
class_0    59
class_2    48
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="d2162de6" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수직 막대</span></span>
<span id="cb3-2">plt.bar(wine_type.index, wine_type.values, width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, bottom<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, align <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb3-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-3-output-1.png" width="566" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="0065c7fe" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수평 막대</span></span>
<span id="cb4-2">plt.barh(wine_type.index, wine_type.values, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, left<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, align <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb4-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-4-output-1.png" width="598" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>각 범주의 값의 갯수 <code>차이가 극단적</code>인지 확인한다. 극단적일 경우, 전처리 과정에서 <code>업/다운 샘플링 등을 통해 갯수가 유사해지도록 조정</code>해야한다.</p>
</section>
<section id="히스토그램" class="level2">
<h2 class="anchored" data-anchor-id="히스토그램">히스토그램</h2>
<p><code>연속형 데이터</code>의 분포를 확인하는 데 활용</p>
<div id="3aa395ce" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Wine alcohol histogram'</span>)</span>
<span id="cb5-2">plt.hist(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'alcohol'</span>, bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wine)</span>
<span id="cb5-3">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-5-output-1.png" width="566" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="box-plot" class="level2">
<h2 class="anchored" data-anchor-id="box-plot">box plot</h2>
<p><code>수치형 변수</code>의 분포를 확인하는 그래프</p>
<div id="71671800" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_iris</span>
<span id="cb6-2"></span>
<span id="cb6-3">iris_load <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_iris()</span>
<span id="cb6-4">iris <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(iris_load.data, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris_load.feature_names)</span>
<span id="cb6-5">iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris_load.target</span>
<span id="cb6-6">iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>({<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'setosa'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'versicolor'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'virginica'</span>})</span>
<span id="cb6-7"></span>
<span id="cb6-8">plt.boxplot(iris.drop(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>))</span>
<span id="cb6-9">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-6-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6e1b5a42" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb7-2"></span>
<span id="cb7-3">sns.boxplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sepal width (cm)"</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris)</span>
<span id="cb7-4">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-7-output-1.png" width="589" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="산점도" class="level2">
<h2 class="anchored" data-anchor-id="산점도">산점도</h2>
<p>두 개의 <code>수치형 변수</code>의 <code>분포와 관계</code>를 확인하는 그래프</p>
<div id="0699d108" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'iris scatter'</span>)</span>
<span id="cb8-2">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>)</span>
<span id="cb8-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal width (cm)'</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5">plt.scatter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal width (cm)'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb8-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-8-output-1.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="65717dc9" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">sns.scatterplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal width (cm)'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris, style<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>)</span>
<span id="cb9-2">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-9-output-1.png" width="589" height="432" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="선그래프" class="level2">
<h2 class="anchored" data-anchor-id="선그래프">선그래프</h2>
<section id="수평-수직-선" class="level3">
<h3 class="anchored" data-anchor-id="수평-수직-선">수평 / 수직 선</h3>
<div id="9c6a5dda" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">plt.hlines(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'solid'</span>)</span>
<span id="cb10-2">plt.vlines(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, linestyles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-10-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="함수식" class="level3">
<h3 class="anchored" data-anchor-id="함수식">함수식</h3>
<div id="b1cdb42f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> linear_func(x):</span>
<span id="cb11-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-3"></span>
<span id="cb11-4">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>]</span>
<span id="cb11-5">plt.plot(X, linear_func(X), c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb11-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-11-output-1.png" width="566" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="회귀선" class="level3">
<h3 class="anchored" data-anchor-id="회귀선">회귀선</h3>
<div id="d95c5bec" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb12-2"></span>
<span id="cb12-3">X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>], iris[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal width (cm)'</span>]</span>
<span id="cb12-4">plt.scatter(X, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb12-5">a, b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.polyfit(X, Y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-6">plt.plot(X, a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b, c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb12-7">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-12-output-1.png" width="571" height="413" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>2차 이상의 그래프는 X값에 대하여 정렬해야 한다.</p>
<div id="2061621e" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">iris2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris.sort_values(by<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>)</span>
<span id="cb13-2">X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris2[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>], iris2[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'petal length (cm)'</span>]</span>
<span id="cb13-3">b2, b1, b0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.polyfit(X, Y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-4">plt.scatter(X, Y, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb13-5">plt.plot(X, b0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb13-6">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-13-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="꺾은선" class="level3">
<h3 class="anchored" data-anchor-id="꺾은선">꺾은선</h3>
<div id="5b05c474" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">plt.plot(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sepal length (cm)'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'petal length (cm)'</span>, data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris2)</span>
<span id="cb14-2">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-14-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="상관관계-시각화" class="level2">
<h2 class="anchored" data-anchor-id="상관관계-시각화">상관관계 시각화</h2>
<section id="산점도-행렬" class="level3">
<h3 class="anchored" data-anchor-id="산점도-행렬">산점도 행렬</h3>
<div id="3a077aad" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pandas.plotting <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> scatter_matrix</span>
<span id="cb15-2"></span>
<span id="cb15-3">scatter_matrix(iris, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), diagonal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hist'</span>)</span>
<span id="cb15-4">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-15-output-1.png" width="649" height="655" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="06b84c9b" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">sns.pairplot(iris, diag_kind<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>, hue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>)</span>
<span id="cb16-2">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-16-output-1.png" width="1069" height="947" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="상관계수-행렬-그래프" class="level3">
<h3 class="anchored" data-anchor-id="상관계수-행렬-그래프">상관계수 행렬 그래프</h3>
<div id="d4cac182" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">iris_corr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> iris.drop(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class'</span>).corr(method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pearson'</span>)</span>
<span id="cb17-2">sns.heatmap(iris_corr, xticklabels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris_corr.columns, yticklabels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>iris_corr.columns, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RdBu_r"</span>, annot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02_files/figure-html/cell-17-output-1.png" width="648" height="520" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pandas-profiling" class="level2">
<h2 class="anchored" data-anchor-id="pandas-profiling">Pandas Profiling</h2>
<div id="e2f08bc6" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from pandas_profiling import ProfileReport</span></span>
<span id="cb18-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ProfileReport(iris)</span></span></code></pre></div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>데이터 분석</category>
  <guid>https://cryscham123.github.io/posts/01_projects/adp_실기/notes/02.html</guid>
  <pubDate>Sun, 29 Dec 2024 15:00:00 GMT</pubDate>
</item>
</channel>
</rss>

<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>김형훈의 학습 블로그</title>
<link>https://cryscham123.github.io/posts/01_projects/bs_3_1/</link>
<atom:link href="https://cryscham123.github.io/posts/01_projects/bs_3_1/index.xml" rel="self" type="application/rss+xml"/>
<description>3학년 1학기 학부 할 일 총 정리</description>
<image>
<url>https://cryscham123.github.io/profile.jpg</url>
<title>김형훈의 학습 블로그</title>
<link>https://cryscham123.github.io/posts/01_projects/bs_3_1/</link>
</image>
<generator>quarto-1.5.56</generator>
<lastBuildDate>Fri, 23 May 2025 01:44:26 GMT</lastBuildDate>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/16.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <category>데이터 마이닝</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/16.pdf</guid>
  <pubDate>Fri, 23 May 2025 01:44:26 GMT</pubDate>
</item>
<item>
  <title>PCA 분석</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/17.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<div id="95c0ddb0" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.preprocessing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StandardScaler</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> sklearn.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PCA</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7">feature_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a2'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a3'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a4'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a5'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a6'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q1a7'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a12'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a13'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a14'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a15'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a16'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a17'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'q12a18'</span>]</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 학생 데이터에 대한 PCA 결과를 저장할 딕셔너리</span></span>
<span id="cb1-10">pca_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb1-13">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'_data/student_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.csv'</span>)</span>
<span id="cb1-14">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[feature_names].dropna()</span>
<span id="cb1-15">    wave_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'w</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-16">    scaler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StandardScaler()</span>
<span id="cb1-17">    df_scaled <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaler.fit_transform(df)</span>
<span id="cb1-18"></span>
<span id="cb1-19">    n_components <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-20">    pca <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PCA(n_components<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n_components)</span>
<span id="cb1-21">    principal_components <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.fit_transform(df_scaled)</span>
<span id="cb1-22"></span>
<span id="cb1-23">    pc_columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'PC</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>wave_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n_components)]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 PC에 wave_id를 포함</span></span>
<span id="cb1-24">    principal_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>principal_components, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pc_columns)</span>
<span id="cb1-25">    </span>
<span id="cb1-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 샘플에 고유 식별자 부여</span></span>
<span id="cb1-27">    principal_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>wave_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_sample_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(principal_df))]</span>
<span id="cb1-28">    </span>
<span id="cb1-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 저장</span></span>
<span id="cb1-30">    pca_results[wave_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> principal_df</span>
<span id="cb1-31">    </span>
<span id="cb1-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원래 있던 출력 코드 유지</span></span>
<span id="cb1-33">    explained_variance_ratio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca.explained_variance_ratio_</span>
<span id="cb1-34">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"--- 학생 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 각 주성분의 설명된 분산 비율 ---"</span>)</span>
<span id="cb1-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j, ratio <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(explained_variance_ratio):</span>
<span id="cb1-36">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"PC</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ratio<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> (누적: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(explained_variance_ratio[:j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>)</span>
<span id="cb1-37">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"총 설명된 분산: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(explained_variance_ratio)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-38">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"--- 학생 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 주성분 벡터 (고유 벡터) ---"</span>)</span>
<span id="cb1-41">    components_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(pca.components_, columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>feature_names, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pc_columns)</span>
<span id="cb1-42">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(components_df)</span>
<span id="cb1-43">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 횡 방향으로 PCA 결과 병합 (공통 키가 있는 경우)</span></span>
<span id="cb1-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 참고: 실제 데이터에서는 sample_id가 동일한 레코드끼리 병합해야 할 수 있습니다</span></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이 예제에서는 단순히 첫 번째 데이터셋을 기준으로 병합합니다</span></span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 먼저 기준 데이터프레임 설정</span></span>
<span id="cb1-50">merged_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pca_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w3'</span>].set_index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>)</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 나머지 데이터프레임을 횡 방향으로 병합</span></span>
<span id="cb1-53"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> wave_id, df <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pca_results.items():</span>
<span id="cb1-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> wave_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w3'</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기준 데이터프레임 제외</span></span>
<span id="cb1-55">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 인덱스 기준으로 병합 (outer join - 모든 샘플 포함)</span></span>
<span id="cb1-56">        merged_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> merged_df.join(df.set_index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>), how<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'outer'</span>)</span>
<span id="cb1-57"></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 확인</span></span>
<span id="cb1-59"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- 횡 방향으로 병합된 PCA 결과 ---"</span>)</span>
<span id="cb1-60"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(merged_df.reset_index())  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample_id를 다시 컬럼으로 변환</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- 학생 3 각 주성분의 설명된 분산 비율 ---
PC1: 0.3269 (누적: 0.3269)
PC2: 0.1227 (누적: 0.4497)
PC3: 0.1100 (누적: 0.5597)
총 설명된 분산: 0.5597


--- 학생 3 주성분 벡터 (고유 벡터) ---
            q1a1      q1a2      q1a3      q1a4      q1a5      q1a6      q1a7  \
PC1_w3  0.247862  0.237873  0.230581  0.301675  0.243926  0.235251  0.223636   
PC2_w3  0.366504  0.369130  0.162445  0.156753 -0.287024 -0.229956 -0.291483   
PC3_w3 -0.241074 -0.287373  0.438479  0.296505 -0.001940 -0.143635 -0.199942   

          q12a12    q12a13    q12a14    q12a15    q12a16    q12a17    q12a18  
PC1_w3  0.298027  0.294329  0.263841  0.327178  0.279594  0.274408  0.259556  
PC2_w3  0.259620  0.237896  0.062205  0.087176 -0.346159 -0.302207 -0.334084  
PC3_w3 -0.264197 -0.288675  0.441378  0.353738  0.064246 -0.076792 -0.188166  


--- 학생 4 각 주성분의 설명된 분산 비율 ---
PC1: 0.3557 (누적: 0.3557)
PC2: 0.1296 (누적: 0.4853)
PC3: 0.1003 (누적: 0.5856)
총 설명된 분산: 0.5856


--- 학생 4 주성분 벡터 (고유 벡터) ---
            q1a1      q1a2      q1a3      q1a4      q1a5      q1a6      q1a7  \
PC1_w4  0.243141  0.236866  0.241068  0.288196  0.246889  0.240895  0.246690   
PC2_w4  0.388228  0.415968  0.085153  0.151228 -0.265814 -0.182576 -0.222634   
PC3_w4 -0.228642 -0.243857  0.478800  0.338032 -0.052284 -0.170940 -0.205696   

          q12a12    q12a13    q12a14    q12a15    q12a16    q12a17    q12a18  
PC1_w4  0.289653  0.287025  0.277797  0.323675  0.270187  0.271515  0.262346  
PC2_w4  0.294460  0.284031 -0.016731  0.026280 -0.370027 -0.296113 -0.315624  
PC3_w4 -0.212274 -0.208043  0.442286  0.342813 -0.050594 -0.129397 -0.222921  


--- 횡 방향으로 병합된 PCA 결과 ---
           sample_id    PC1_w3    PC2_w3    PC3_w3    PC1_w4    PC2_w4  \
0        w3_sample_0 -1.254296 -1.224018 -2.154943       NaN       NaN   
1        w3_sample_1  2.247322 -0.049948  1.067250       NaN       NaN   
2       w3_sample_10  0.431017 -1.510617 -0.870137       NaN       NaN   
3      w3_sample_100  0.201425  2.796726 -0.839905       NaN       NaN   
4     w3_sample_1000 -1.899832  0.188324  0.128137       NaN       NaN   
...              ...       ...       ...       ...       ...       ...   
6241   w4_sample_995       NaN       NaN       NaN -0.072505  0.113869   
6242   w4_sample_996       NaN       NaN       NaN  2.380158  0.724508   
6243   w4_sample_997       NaN       NaN       NaN  1.370190 -2.457734   
6244   w4_sample_998       NaN       NaN       NaN -1.726048 -0.219925   
6245   w4_sample_999       NaN       NaN       NaN  1.474996  1.818824   

        PC3_w4  
0          NaN  
1          NaN  
2          NaN  
3          NaN  
4          NaN  
...        ...  
6241 -0.519265  
6242 -0.787852  
6243 -1.963943  
6244  0.269801  
6245 -0.402807  

[6246 rows x 7 columns]</code></pre>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/17.html</guid>
  <pubDate>Thu, 22 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>analysis</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/15.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="데이터-load" class="level2">
<h2 class="anchored" data-anchor-id="데이터-load">데이터 load</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(survey)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid
Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loading required package: survival

Attaching package: 'survey'

The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(semPlot)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(caret)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:survival':

    cluster

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(randomForest)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2
Type rfNews() to see new features/changes/bug fixes.

Attaching package: 'randomForest'

The following object is masked from 'package:dplyr':

    combine

The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pROC)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>)</span>
<span id="cb13-2"></span>
<span id="cb13-3">X_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_data/train_data.csv"</span>)</span>
<span id="cb13-4">X_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_data/test_data.csv"</span>)</span>
<span id="cb13-5">y_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(X_train<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span>
<span id="cb13-6">y_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(X_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span>
<span id="cb13-7">weights_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_train<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weights</span>
<span id="cb13-8">weights_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weights</span>
<span id="cb13-9">X_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>weights)</span>
<span id="cb13-10">X_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_test <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>weights)</span></code></pre></div>
</div>
</section>
<section id="무작위-분류기-random-classifier" class="level2">
<h2 class="anchored" data-anchor-id="무작위-분류기-random-classifier">무작위 분류기 (Random Classifier)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 훈련 데이터에서 클래스 비율 계산</span></span>
<span id="cb14-2">class_proportions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(y_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_train)</span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 테스트 데이터에 대한 무작위 예측 생성</span></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 클래스 비율에 맞게 무작위로 샘플링</span></span>
<span id="cb14-6">random_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), </span>
<span id="cb14-7">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_test), </span>
<span id="cb14-8">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb14-9">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> class_proportions)</span>
<span id="cb14-10">random_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(random_predictions, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test))</span>
<span id="cb14-11"></span>
<span id="cb14-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가중 혼동 행렬 계산</span></span>
<span id="cb14-13">weighted_confusion_matrix_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb14-14">                                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb14-15">                                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb14-16">                                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Actual =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Predicted =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb14-17"></span>
<span id="cb14-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_test)) {</span>
<span id="cb14-19">  actual_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(y_test[i])</span>
<span id="cb14-20">  predicted_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(random_predictions[i])</span>
<span id="cb14-21">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights_test[i]</span>
<span id="cb14-22">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (actual_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> predicted_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb14-23">    weighted_confusion_matrix_random[actual_cat, predicted_cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_random[actual_cat, predicted_cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight</span>
<span id="cb14-24">  }</span>
<span id="cb14-25">}</span>
<span id="cb14-26"></span>
<span id="cb14-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 무작위 분류기 가중 혼동 행렬 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 무작위 분류기 가중 혼동 행렬 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_confusion_matrix_random, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Predicted
Actual      active  passive
  active  57687.49 58084.02
  passive 30544.02 28027.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 무작위 분류기 가중 성능 지표 계산</span></span>
<span id="cb18-2">total_weighted_sum_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_random)</span>
<span id="cb18-3">weighted_accuracy_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(weighted_confusion_matrix_random)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted_sum_random</span>
<span id="cb18-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 무작위 분류기 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 무작위 분류기 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_random, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가중 정확도: 0.4916 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 범주별 가중 정밀도, 재현율, F1-score 계산</span></span>
<span id="cb22-2">weighted_precision_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb22-3">weighted_recall_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb22-4">weighted_f1_score_random <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb22-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_precision_random) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_recall_random) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_f1_score_random) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)</span>
<span id="cb22-6"></span>
<span id="cb22-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (cat <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb22-8">  TP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_random[cat, cat]</span>
<span id="cb22-9">  FP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_random[, cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb22-10">  FN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_random[cat, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb22-11"></span>
<span id="cb22-12">  weighted_precision_random[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP))</span>
<span id="cb22-13">  weighted_recall_random[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN))</span>
<span id="cb22-14">  weighted_f1_score_random[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((weighted_precision_random[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_random[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb22-15">                                        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (weighted_precision_random[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weighted_recall_random[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (weighted_precision_random[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_random[cat]))</span>
<span id="cb22-16">}</span>
<span id="cb22-17"></span>
<span id="cb22-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">무작위 분류기 범주별 가중 정밀도:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
무작위 분류기 범주별 가중 정밀도:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision_random, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.6538  0.3255 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">무작위 분류기 범주별 가중 재현율:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
무작위 분류기 범주별 가중 재현율:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall_random, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.4983  0.4785 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">무작위 분류기 범주별 가중 F1-score:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
무작위 분류기 범주별 가중 F1-score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score_random, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.5656  0.3874 </code></pre>
</div>
</div>
</section>
<section id="random-forest-모델-학습-및-평가" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-모델-학습-및-평가">Random Forest 모델 학습 및 평가</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1">rf_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">randomForest</span>(</span>
<span id="cb34-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X_train,</span>
<span id="cb34-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_train,</span>
<span id="cb34-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights_train,</span>
<span id="cb34-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ntree =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb34-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mtry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X_train))),</span>
<span id="cb34-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">importance =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb34-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sampsize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(y_train),</span>
<span id="cb34-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb34-10">)</span>
<span id="cb34-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varImpPlot</span>(rf_model)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/15_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">y_pred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(rf_model, X_test)</span>
<span id="cb35-2">actual_classes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_test</span>
<span id="cb35-3">predicted_classes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_pred</span>
<span id="cb35-4">test_weights <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights_test</span>
<span id="cb35-5">outcome_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes)</span>
<span id="cb35-6">weighted_confusion_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb35-7">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(outcome_levels),</span>
<span id="cb35-8">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(outcome_levels),</span>
<span id="cb35-9">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Actual =</span> outcome_levels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Predicted =</span> outcome_levels))</span>
<span id="cb35-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(actual_classes)) {</span>
<span id="cb35-11">  actual_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(actual_classes[i])</span>
<span id="cb35-12">  predicted_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(predicted_classes[i])</span>
<span id="cb35-13">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> test_weights[i]</span>
<span id="cb35-14">  weighted_confusion_matrix[actual_cat, predicted_cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix[actual_cat, predicted_cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight</span>
<span id="cb35-15">}</span>
<span id="cb35-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_confusion_matrix, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Predicted
Actual      active  passive
  active  89806.77 25964.74
  passive 37069.58 21501.58</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">total_weighted_sum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix)</span>
<span id="cb37-2">weighted_accuracy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(weighted_confusion_matrix)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted_sum</span>
<span id="cb37-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가중 정확도: 0.6384 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">weighted_precision <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(outcome_levels))</span>
<span id="cb41-2">weighted_recall <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(outcome_levels))</span>
<span id="cb41-3">weighted_f1_score <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(outcome_levels))</span>
<span id="cb41-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_precision) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_recall) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_f1_score) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> outcome_levels</span>
<span id="cb41-5"></span>
<span id="cb41-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (cat <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> outcome_levels) {</span>
<span id="cb41-7">  TP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix[cat, cat]</span>
<span id="cb41-8">  FP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix[, cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해당 열의 합 - TP</span></span>
<span id="cb41-9">  FN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix[cat, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해당 행의 합 - TP</span></span>
<span id="cb41-10">  weighted_precision[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP))</span>
<span id="cb41-11">  weighted_recall[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN))</span>
<span id="cb41-12">  weighted_f1_score[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((weighted_precision[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb41-13">                                    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (weighted_precision[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weighted_recall[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (weighted_precision[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall[cat]))</span>
<span id="cb41-14">}</span>
<span id="cb41-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">범주별 가중 정밀도:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
범주별 가중 정밀도:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7078  0.4530 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">범주별 가중 재현율:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
범주별 가중 재현율:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7757  0.3671 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">범주별 가중 F1-score:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
범주별 가중 F1-score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7402  0.4055 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">y_pred_prob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(rf_model, X_test, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prob"</span>)</span>
<span id="cb53-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">비가중 ROC 곡선 (참고용):</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
비가중 ROC 곡선 (참고용):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1">plot_roc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>() {</span>
<span id="cb55-2">  num_classes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test))</span>
<span id="cb55-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (num_classes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> num_classes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 범주가 1개 이하이면 플롯 불가능</span></span>
<span id="cb55-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(num_classes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)))</span>
<span id="cb55-5">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (num_classes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {</span>
<span id="cb55-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 범주가 많으면 일부만 표시하거나 레이아웃 조정 필요</span></span>
<span id="cb55-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"범주가 4개 이상입니다. 일부 ROC 곡선만 표시될 수 있습니다. 레이아웃을 조정하거나 플롯 코드 를 수정하세요."</span>)</span>
<span id="cb55-8">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb55-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ROC 곡선을 그릴 범주가 부족합니다.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb55-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 빈 numeric 반환</span></span>
<span id="cb55-11">  }</span>
<span id="cb55-12">  auc_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(num_classes)</span>
<span id="cb55-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(auc_values) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)</span>
<span id="cb55-14">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>num_classes) {</span>
<span id="cb55-15">    class_label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)[i]</span>
<span id="cb55-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(class_label <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(y_test) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> class_label <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(y_pred_prob)) {</span>
<span id="cb55-17">      roc_obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roc</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">response =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(y_test <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> class_label, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">predictor =</span> y_pred_prob[, class_label])</span>
<span id="cb55-18">      auc_values[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auc</span>(roc_obj)</span>
<span id="cb55-19">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(roc_obj, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ROC for"</span>, class_label, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(Unweighted)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb55-20">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>)</span>
<span id="cb55-21">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AUC ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(auc_values[i], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb55-22">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb55-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"클래스"</span>, class_label, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"에 대한 ROC 곡선을 그릴 수 없습니다 (데이터 부족).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb55-24">        auc_values[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AUC 값에 NA 할당</span></span>
<span id="cb55-25">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot.new</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 빈 플롯 생성</span></span>
<span id="cb55-26">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No ROC for"</span>, class_label))</span>
<span id="cb55-27">      }</span>
<span id="cb55-28">  }</span>
<span id="cb55-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">par</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mfrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb55-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(auc_values)</span>
<span id="cb55-31">}</span>
<span id="cb55-32">auc_values_unweighted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_roc</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/15_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">각 클래스별 비가중 AUC:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
각 클래스별 비가중 AUC:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AUC_Unweighted =</span> auc_values_unweighted))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Class AUC_Unweighted
active   active      0.6220194
passive passive      0.6220194</code></pre>
</div>
</div>
</section>
<section id="모델-튜닝" class="level2">
<h2 class="anchored" data-anchor-id="모델-튜닝">모델 튜닝</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1">ctrl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trainControl</span>(</span>
<span id="cb64-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cv"</span>,</span>
<span id="cb64-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb64-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">savePredictions =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"final"</span>,</span>
<span id="cb64-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">classProbs =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb64-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">summaryFunction =</span> multiClassSummary</span>
<span id="cb64-7">)</span>
<span id="cb64-8">param_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(</span>
<span id="cb64-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mtry =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X_train)))</span>
<span id="cb64-10">)</span>
<span id="cb64-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb64-12">  param_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mtry =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb64-13">}</span>
<span id="cb64-14">rf_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">train</span>(</span>
<span id="cb64-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X_train,</span>
<span id="cb64-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_train,</span>
<span id="cb64-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rf"</span>,</span>
<span id="cb64-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accuracy"</span>,</span>
<span id="cb64-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights_train,</span>
<span id="cb64-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trControl =</span> ctrl,</span>
<span id="cb64-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tuneGrid =</span> param_grid,</span>
<span id="cb64-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">importance =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb64-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ntree =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb64-24">)</span>
<span id="cb64-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(rf_tuned)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

3412 samples
  51 predictor
   2 classes: 'active', 'passive' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 2730, 2730, 2730, 2729, 2729 
Resampling results:

  logLoss    AUC       prAUC      Accuracy   Kappa      F1         Sensitivity
  0.6219635  0.740729  0.7297194  0.6787714  0.3564413  0.6590399  0.6340299  
  Specificity  Pos_Pred_Value  Neg_Pred_Value  Precision  Recall   
  0.7219467    0.6875098       0.6726023       0.6875098  0.6340299
  Detection_Rate  Balanced_Accuracy
  0.311242        0.6779883        

Tuning parameter 'mtry' was held constant at a value of 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1">y_pred_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(rf_tuned, X_test)</span>
<span id="cb66-2">actual_classes_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_test</span>
<span id="cb66-3">predicted_classes_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_pred_tuned</span>
<span id="cb66-4">test_weights_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights_test</span>
<span id="cb66-5">weighted_confusion_matrix_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb66-6">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)),</span>
<span id="cb66-7">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)),</span>
<span id="cb66-8">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Actual =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Predicted =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)))</span>
<span id="cb66-9"></span>
<span id="cb66-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(actual_classes_tuned)) {</span>
<span id="cb66-11">  actual_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(actual_classes_tuned[i])</span>
<span id="cb66-12">  predicted_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(predicted_classes_tuned[i])</span>
<span id="cb66-13">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> test_weights_tuned[i]</span>
<span id="cb66-14">   <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (actual_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> predicted_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)) {</span>
<span id="cb66-15">      weighted_confusion_matrix_tuned[actual_cat, predicted_cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_tuned[actual_cat, predicted_cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight</span>
<span id="cb66-16">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb66-17">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"튜닝 모델: 유효하지 않은 범주 발견: 실제 ="</span>, actual_cat, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", 예측 ="</span>, predicted_cat, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인 개체 (인덱스:"</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>))</span>
<span id="cb66-18">  }</span>
<span id="cb66-19">}</span>
<span id="cb66-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 튜닝된 모델 가중 혼동 행렬 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 튜닝된 모델 가중 혼동 행렬 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_confusion_matrix_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 보기 좋게 반올림하여 출력</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Predicted
Actual      active  passive
  active  89635.01 26136.50
  passive 37763.88 20807.29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1">total_weighted_sum_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_tuned)</span>
<span id="cb70-2">weighted_accuracy_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(weighted_confusion_matrix_tuned)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted_sum_tuned</span>
<span id="cb70-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 튜닝된 모델 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 튜닝된 모델 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가중 정확도: 0.6335 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1">weighted_precision_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)))</span>
<span id="cb74-2">weighted_recall_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)))</span>
<span id="cb74-3">weighted_f1_score_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)))</span>
<span id="cb74-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_precision_tuned) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_recall_tuned) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_f1_score_tuned) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)</span>
<span id="cb74-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (cat <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(actual_classes_tuned)) {</span>
<span id="cb74-6">  TP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_tuned[cat, cat]</span>
<span id="cb74-7">  FP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_tuned[, cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb74-8">  FN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_tuned[cat, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb74-9"></span>
<span id="cb74-10">  weighted_precision_tuned[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP))</span>
<span id="cb74-11">  weighted_recall_tuned[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN))</span>
<span id="cb74-12">  weighted_f1_score_tuned[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((weighted_precision_tuned[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_tuned[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb74-13">                                    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (weighted_precision_tuned[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weighted_recall_tuned[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (weighted_precision_tuned[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_tuned[cat]))</span>
<span id="cb74-14">}</span>
<span id="cb74-15"></span>
<span id="cb74-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">튜닝된 모델 범주별 가중 정밀도:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
튜닝된 모델 범주별 가중 정밀도:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7036  0.4432 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">튜닝된 모델 범주별 가중 재현율:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
튜닝된 모델 범주별 가중 재현율:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7742  0.3552 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">튜닝된 모델 범주별 가중 F1-score:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
튜닝된 모델 범주별 가중 F1-score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7372  0.3944 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1">importance_obj_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">varImp</span>(rf_tuned)</span>
<span id="cb86-2"></span>
<span id="cb86-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"importance"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(importance_obj_tuned)) {</span>
<span id="cb86-4">  imp_df_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> importance_obj_tuned<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>importance</span>
<span id="cb86-5">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb86-6">  imp_df_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> importance_obj_tuned</span>
<span id="cb86-7">}</span>
<span id="cb86-8"></span>
<span id="cb86-9">var_names_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(imp_df_tuned)</span>
<span id="cb86-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Overall"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(imp_df_tuned)) {</span>
<span id="cb86-11">  var_importance_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> imp_df_tuned<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Overall</span>
<span id="cb86-12">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb86-13">  var_importance_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> imp_df_tuned[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb86-14">}</span>
<span id="cb86-15"></span>
<span id="cb86-16">importance_df_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb86-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variable =</span> var_names_tuned,</span>
<span id="cb86-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Importance =</span> var_importance_tuned</span>
<span id="cb86-19">)</span>
<span id="cb86-20">importance_df_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> importance_df_tuned[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(importance_df_tuned<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Importance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decreasing =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),]</span>
<span id="cb86-21"></span>
<span id="cb86-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 상위 10개 변수 출력 (튜닝된 모델)</span></span>
<span id="cb86-23">top_vars_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(importance_df_tuned<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Variable, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb86-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">튜닝된 모델에서 가장 중요한 변수 상위 10개:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
튜닝된 모델에서 가장 중요한 변수 상위 10개:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(top_vars_tuned)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "parent_monitoring_w5" "parent_attachment_w5" "friend_stress_w4"    
 [4] "deviant_esteem_w3"    "academic_stress_w4"   "friend_stress_w2"    
 [7] "parent_monitoring_w3" "parent_monitoring_w2" "parent_attachment_w4"
[10] "parent_attachment_w2"</code></pre>
</div>
</div>
</section>
<section id="xgboost-모델" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-모델">XGBoost 모델</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XGBoost 모델 학습 및 평가</span></span>
<span id="cb90-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(xgboost)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xgboost'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 데이터 변환 (XGBoost는 DMatrix 형식을 사용)</span></span>
<span id="cb93-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 먼저 factor를 수치형으로 변환</span></span>
<span id="cb93-3">y_train_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(y_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 0부터 시작하는 인덱스로 변환</span></span>
<span id="cb93-4">y_test_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(y_test) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb93-5"></span>
<span id="cb93-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XGBoost DMatrix 생성</span></span>
<span id="cb93-7">dtrain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xgb.DMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(X_train), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> y_train_numeric, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> weights_train)</span>
<span id="cb93-8">dtest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xgb.DMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(X_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> y_test_numeric, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> weights_test)</span>
<span id="cb93-9"></span>
<span id="cb93-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델 파라미터 설정</span></span>
<span id="cb93-11">xgb_params <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb93-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">objective =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multi:softprob"</span>,</span>
<span id="cb93-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval_metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mlogloss"</span>,</span>
<span id="cb93-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">num_class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_train)),</span>
<span id="cb93-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eta =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 학습률</span></span>
<span id="cb93-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_depth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 트리 최대 깊이</span></span>
<span id="cb93-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min_child_weight =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최소 자식 노드 가중치 합</span></span>
<span id="cb93-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subsample =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 샘플링 비율</span></span>
<span id="cb93-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colsample_bytree =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특성 샘플링 비율</span></span>
<span id="cb93-20">)</span>
<span id="cb93-21"></span>
<span id="cb93-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XGBoost 모델 학습</span></span>
<span id="cb93-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 모델 학습 중...</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 모델 학습 중...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1">xgb_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xgb.train</span>(</span>
<span id="cb95-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> xgb_params,</span>
<span id="cb95-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dtrain,</span>
<span id="cb95-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrounds =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 부스팅 반복 횟수</span></span>
<span id="cb95-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb95-6">)</span>
<span id="cb95-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XGBoost 모델 학습 완료.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>XGBoost 모델 학습 완료.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 변수 중요도 확인</span></span>
<span id="cb97-2">xgb_importance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xgb.importance</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> xgb_model)</span>
<span id="cb97-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(xgb_importance) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb97-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 변수 중요도 상위 10개:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb97-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(xgb_importance, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb97-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xgb.plot.importance</span>(xgb_importance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top_n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb97-7">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb97-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 변수 중요도를 계산할 수 없습니다.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb97-9">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 변수 중요도 상위 10개:
                        Feature       Gain      Cover  Frequency
                         &lt;char&gt;      &lt;num&gt;      &lt;num&gt;      &lt;num&gt;
 1:        parent_monitoring_w5 0.03182668 0.03658157 0.02176108
 2:            friend_stress_w4 0.03088689 0.04049583 0.02153674
 3:        parent_attachment_w5 0.02946235 0.02678660 0.01940550
 4: higher_school_dependence_w5 0.02714116 0.02699829 0.02007852
 5:            desire_stress_w1 0.02705206 0.02603461 0.02602356
 6:        parent_attachment_w4 0.02674024 0.02234054 0.02097588
 7:          academic_stress_w3 0.02657457 0.03015163 0.01985418
 8:          academic_stress_w4 0.02626054 0.03414376 0.01962984
 9:               neg_esteem_w1 0.02609752 0.02822353 0.02288278
10:            friend_stress_w2 0.02527457 0.02162330 0.02153674</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/15_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XGBoost 모델로 테스트 세트 예측</span></span>
<span id="cb99-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 모델로 테스트 세트 예측 중...</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 모델로 테스트 세트 예측 중...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1">xgb_pred_probs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(xgb_model, dtest)</span>
<span id="cb101-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예측 확률을 행렬로 변환 (각 클래스별 확률값)</span></span>
<span id="cb101-3">xgb_pred_probs_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(xgb_pred_probs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb101-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가장 높은 확률을 가진 클래스를 예측값으로 선택</span></span>
<span id="cb101-5">y_pred_xgb_idx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(xgb_pred_probs_matrix, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, which.max) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 0-based 인덱스</span></span>
<span id="cb101-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다시 factor로 변환</span></span>
<span id="cb101-7">y_pred_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)[y_pred_xgb_idx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test))</span>
<span id="cb101-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"예측 완료.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>예측 완료.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가중 혼동 행렬 계산</span></span>
<span id="cb103-2">weighted_confusion_matrix_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb103-3">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb103-4">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb103-5">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Actual =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Predicted =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb103-6"></span>
<span id="cb103-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_test)) {</span>
<span id="cb103-8">  actual_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(y_test[i])</span>
<span id="cb103-9">  predicted_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(y_pred_xgb[i])</span>
<span id="cb103-10">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights_test[i]</span>
<span id="cb103-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (actual_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> predicted_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb103-12">    weighted_confusion_matrix_xgb[actual_cat, predicted_cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_xgb[actual_cat, predicted_cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight</span>
<span id="cb103-13">  }</span>
<span id="cb103-14">}</span>
<span id="cb103-15"></span>
<span id="cb103-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== XGBoost 모델 가중 혼동 행렬 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== XGBoost 모델 가중 혼동 행렬 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_confusion_matrix_xgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Predicted
Actual      active  passive
  active  94434.78 21336.73
  passive 44765.10 13806.06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XGBoost 모델 가중 성능 지표 계산</span></span>
<span id="cb107-2">total_weighted_sum_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_xgb)</span>
<span id="cb107-3">weighted_accuracy_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(weighted_confusion_matrix_xgb)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted_sum_xgb</span>
<span id="cb107-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== XGBoost 모델 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== XGBoost 모델 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_xgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가중 정확도: 0.6209 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 범주별 가중 정밀도, 재현율, F1-score 계산</span></span>
<span id="cb111-2">weighted_precision_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb111-3">weighted_recall_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb111-4">weighted_f1_score_xgb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb111-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_precision_xgb) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_recall_xgb) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_f1_score_xgb) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)</span>
<span id="cb111-6"></span>
<span id="cb111-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (cat <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb111-8">  TP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_xgb[cat, cat]</span>
<span id="cb111-9">  FP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_xgb[, cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb111-10">  FN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_xgb[cat, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb111-11"></span>
<span id="cb111-12">  weighted_precision_xgb[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP))</span>
<span id="cb111-13">  weighted_recall_xgb[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN))</span>
<span id="cb111-14">  weighted_f1_score_xgb[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((weighted_precision_xgb[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_xgb[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb111-15">                                     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (weighted_precision_xgb[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weighted_recall_xgb[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (weighted_precision_xgb[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_xgb[cat]))</span>
<span id="cb111-16">}</span>
<span id="cb111-17"></span>
<span id="cb111-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 모델 범주별 가중 정밀도:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 모델 범주별 가중 정밀도:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision_xgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.6784  0.3929 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb115" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 모델 범주별 가중 재현율:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 모델 범주별 가중 재현율:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall_xgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.8157  0.2357 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">XGBoost 모델 범주별 가중 F1-score:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
XGBoost 모델 범주별 가중 F1-score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score_xgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7407  0.2946 </code></pre>
</div>
</div>
</section>
<section id="로지스틱-회귀-모델" class="level2">
<h2 class="anchored" data-anchor-id="로지스틱-회귀-모델">로지스틱 회귀 모델</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb123" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다항 로지스틱 회귀 모델 학습 및 평가</span></span>
<span id="cb123-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(nnet)</span>
<span id="cb123-3"></span>
<span id="cb123-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다항 로지스틱 회귀 모델 학습 (가중치 적용)</span></span>
<span id="cb123-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다항 로지스틱 회귀 모델 학습 중...</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
다항 로지스틱 회귀 모델 학습 중...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># X_train에 열 이름이 없으면 추가</span></span>
<span id="cb125-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(X_train))) {</span>
<span id="cb125-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(X_train) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X_train))</span>
<span id="cb125-4">}</span>
<span id="cb125-5"></span>
<span id="cb125-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 학습 데이터를 데이터프레임으로 변환</span></span>
<span id="cb125-7">train_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(X_train)</span>
<span id="cb125-8">train_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y_train</span>
<span id="cb125-9"></span>
<span id="cb125-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다항 로지스틱 회귀 모델 학습</span></span>
<span id="cb125-11">logistic_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">multinom</span>(</span>
<span id="cb125-12">  y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .,</span>
<span id="cb125-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> train_df,</span>
<span id="cb125-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights_train,</span>
<span id="cb125-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb125-16">)</span>
<span id="cb125-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"다항 로지스틱 회귀 모델 학습 완료.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>다항 로지스틱 회귀 모델 학습 완료.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델 요약</span></span>
<span id="cb127-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(logistic_model))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = y ~ ., data = train_df, weights = weights_train, 
    trace = FALSE)

Coefficients:
                                   Values   Std. Err.
(Intercept)                 -1.747743e-02 0.002352613
parent_attachment_w1         8.629500e-02 0.003520811
deviant_esteem_w1            2.455207e-02 0.003349262
parent_stress_w1             1.581364e-02 0.002926812
parent_monitoring_w1        -3.621483e-02 0.002691047
desire_stress_w1            -1.654925e-01 0.002964678
friend_stress_w1            -1.484645e-02 0.002712385
self_confidence_w1          -1.833542e-02 0.003513107
higher_school_dependence_w1  5.676484e-02 0.001927342
neg_esteem_w1               -1.340150e-01 0.003292447
academic_stress_w1           1.402940e-02 0.002968398
parent_attachment_w2        -1.597988e-01 0.003607662
deviant_esteem_w2           -3.201644e-03 0.003073032
parent_stress_w2            -3.385004e-03 0.002958998
parent_monitoring_w2        -5.046192e-02 0.002743269
desire_stress_w2            -7.252106e-02 0.002767975
friend_stress_w2             1.161718e-01 0.002658148
self_confidence_w2          -3.121364e-02 0.003129254
higher_school_dependence_w2  2.883447e-02 0.001971023
neg_esteem_w2               -4.552701e-02 0.002822384
academic_stress_w2           5.587968e-02 0.002906613
parent_attachment_w3        -1.932719e-01 0.003799447
deviant_esteem_w3            1.982736e-01 0.003650501
parent_stress_w3             4.636885e-03 0.003426560
parent_monitoring_w3        -5.904395e-02 0.002631096
desire_stress_w3            -5.003618e-02 0.002935088
friend_stress_w3             3.303750e-02 0.003050699
self_confidence_w3           9.940994e-03 0.003381305
higher_school_dependence_w3  5.753226e-04 0.002152310
neg_esteem_w3                6.789459e-02 0.003165765
academic_stress_w3          -7.253990e-03 0.002785823
parent_attachment_w4        -1.965769e-02 0.003727261
deviant_esteem_w4            1.507238e-02 0.003228654
parent_stress_w4             3.484563e-02 0.003474462
parent_monitoring_w4        -4.877685e-02 0.002696410
desire_stress_w4            -4.753889e-02 0.002757239
friend_stress_w4             1.109145e-01 0.003010243
self_confidence_w4           2.145545e-01 0.003658857
higher_school_dependence_w4 -2.398239e-02 0.002350664
neg_esteem_w4               -1.394140e-01 0.003148682
academic_stress_w4          -8.451687e-02 0.002843888
parent_attachment_w5        -1.940178e-01 0.003516885
deviant_esteem_w5           -9.225044e-02 0.003343494
parent_stress_w5             7.638213e-02 0.003335598
parent_monitoring_w5        -1.537289e-01 0.002660936
desire_stress_w5             2.553032e-05 0.002858326
friend_stress_w5             8.165718e-02 0.003068119
self_confidence_w5           9.089148e-02 0.003390435
higher_school_dependence_w5 -7.819745e-02 0.002162491
neg_esteem_w5                7.233250e-02 0.003152148
academic_stress_w5          -1.152715e-01 0.002639858

Residual Deviance: 1055167 
AIC: 1055269 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 테스트 세트 예측</span></span>
<span id="cb129-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다항 로지스틱 회귀 모델로 테스트 세트 예측 중...</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
다항 로지스틱 회귀 모델로 테스트 세트 예측 중...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># X_test에 열 이름이 없으면 추가</span></span>
<span id="cb131-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(X_test))) {</span>
<span id="cb131-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(X_test) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(X_test))</span>
<span id="cb131-4">}</span>
<span id="cb131-5">y_pred_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(logistic_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(X_test))</span>
<span id="cb131-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"예측 완료.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>예측 완료.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가중 혼동 행렬 계산</span></span>
<span id="cb133-2">weighted_confusion_matrix_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb133-3">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb133-4">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)),</span>
<span id="cb133-5">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dimnames =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Actual =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Predicted =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb133-6"></span>
<span id="cb133-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(y_test)) {</span>
<span id="cb133-8">  actual_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(y_test[i])</span>
<span id="cb133-9">  predicted_cat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(y_pred_logistic[i])</span>
<span id="cb133-10">  weight <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights_test[i]</span>
<span id="cb133-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (actual_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> predicted_cat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb133-12">    weighted_confusion_matrix_logistic[actual_cat, predicted_cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_logistic[actual_cat, predicted_cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weight</span>
<span id="cb133-13">  }</span>
<span id="cb133-14">}</span>
<span id="cb133-15"></span>
<span id="cb133-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 다항 로지스틱 회귀 모델 가중 혼동 행렬 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 다항 로지스틱 회귀 모델 가중 혼동 행렬 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_confusion_matrix_logistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Predicted
Actual      active  passive
  active  70274.82 45496.69
  passive 23412.35 35158.82</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다항 로지스틱 회귀 모델 가중 성능 지표 계산</span></span>
<span id="cb137-2">total_weighted_sum_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_logistic)</span>
<span id="cb137-3">weighted_accuracy_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diag</span>(weighted_confusion_matrix_logistic)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_weighted_sum_logistic</span>
<span id="cb137-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 다항 로지스틱 회귀 모델 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 다항 로지스틱 회귀 모델 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_logistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>가중 정확도: 0.6047 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 범주별 가중 정밀도, 재현율, F1-score 계산</span></span>
<span id="cb141-2">weighted_precision_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb141-3">weighted_recall_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb141-4">weighted_f1_score_logistic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)))</span>
<span id="cb141-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_precision_logistic) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_recall_logistic) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(weighted_f1_score_logistic) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)</span>
<span id="cb141-6"></span>
<span id="cb141-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (cat <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test)) {</span>
<span id="cb141-8">  TP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weighted_confusion_matrix_logistic[cat, cat]</span>
<span id="cb141-9">  FP <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_logistic[, cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb141-10">  FN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(weighted_confusion_matrix_logistic[cat, ]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> TP</span>
<span id="cb141-11"></span>
<span id="cb141-12">  weighted_precision_logistic[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FP))</span>
<span id="cb141-13">  weighted_recall_logistic[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (TP <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> FN))</span>
<span id="cb141-14">  weighted_f1_score_logistic[cat] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>((weighted_precision_logistic[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_logistic[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb141-15">                                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (weighted_precision_logistic[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weighted_recall_logistic[cat]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (weighted_precision_logistic[cat] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> weighted_recall_logistic[cat]))</span>
<span id="cb141-16">}</span>
<span id="cb141-17"></span>
<span id="cb141-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다항 로지스틱 회귀 모델 범주별 가중 정밀도:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
다항 로지스틱 회귀 모델 범주별 가중 정밀도:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision_logistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.7501  0.4359 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb145" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다항 로지스틱 회귀 모델 범주별 가중 재현율:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
다항 로지스틱 회귀 모델 범주별 가중 재현율:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall_logistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.6070  0.6003 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb149" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다항 로지스틱 회귀 모델 범주별 가중 F1-score:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
다항 로지스틱 회귀 모델 범주별 가중 F1-score:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score_logistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> active passive 
 0.6710  0.5051 </code></pre>
</div>
</div>
</section>
<section id="최종-모델-성능-비교" class="level2">
<h2 class="anchored" data-anchor-id="최종-모델-성능-비교">최종 모델 성능 비교</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb153" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 모델의 가중 정확도 비교</span></span>
<span id="cb153-2">final_metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb153-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Metric =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"가중 정확도"</span>),</span>
<span id="cb153-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">RandomForest =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_tuned <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb153-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C50_Tree = c(round(weighted_accuracy_c50 * 100, 2)),</span></span>
<span id="cb153-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">XGBoost =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_xgb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb153-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SVM = c(round(weighted_accuracy_svm * 100, 2)),</span></span>
<span id="cb153-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># KNN = c(round(weighted_accuracy_knn * 100, 2)),</span></span>
<span id="cb153-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">LogisticRegression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_accuracy_logistic <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb153-10">)</span>
<span id="cb153-11"></span>
<span id="cb153-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 출력</span></span>
<span id="cb153-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 최종 모델 가중 정확도 비교 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 최종 모델 가중 정확도 비교 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(final_metrics, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"원본 모델 vs 튜닝 모델 가중 정확도 비교"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "format"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: 원본 모델 vs 튜닝 모델 가중 정확도 비교

|Metric      | RandomForest| XGBoost| LogisticRegression|
|:-----------|------------:|-------:|------------------:|
|가중 정확도 |        63.35|   62.09|              60.47|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 클래스별 가중 성능 지표 (튜닝된 모델 결과 사용 권장)</span></span>
<span id="cb159-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 튜닝된 모델 범주별 가중 성능 지표 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 튜닝된 모델 범주별 가중 성능 지표 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1">class_weighted_metrics_tuned <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb161-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(y_test), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y_test 또는 actual_classes_tuned 사용 가능</span></span>
<span id="cb161-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weighted_Precision =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_precision_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb161-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weighted_Recall =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_recall_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb161-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weighted_F1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(weighted_f1_score_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb161-6">)</span>
<span id="cb161-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(class_weighted_metrics_tuned, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"튜닝된 모델 클래스별 가중 성능 지표"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: 튜닝된 모델 클래스별 가중 성능 지표

|        |Class   | Weighted_Precision| Weighted_Recall| Weighted_F1|
|:-------|:-------|------------------:|---------------:|-----------:|
|active  |active  |             0.7036|          0.7742|      0.7372|
|passive |passive |             0.4432|          0.3552|      0.3944|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최종 변수 중요도 요약 (튜닝된 모델 결과 사용)</span></span>
<span id="cb164-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== 튜닝된 모델 변수 중요도 ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== 튜닝된 모델 변수 중요도 ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(importance_df_tuned, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"튜닝된 모델 상위 10개 중요 변수 (가중치 고려 학습 결과)"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: 튜닝된 모델 상위 10개 중요 변수 (가중치 고려 학습 결과)

|   |Variable             | Importance|
|:--|:--------------------|----------:|
|44 |parent_monitoring_w5 |  100.00000|
|41 |parent_attachment_w5 |   98.03124|
|36 |friend_stress_w4     |   91.75903|
|22 |deviant_esteem_w3    |   66.68785|
|40 |academic_stress_w4   |   66.10126|
|16 |friend_stress_w2     |   61.13150|
|24 |parent_monitoring_w3 |   60.13058|
|14 |parent_monitoring_w2 |   57.68542|
|31 |parent_attachment_w4 |   51.69019|
|11 |parent_attachment_w2 |   51.56372|</code></pre>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/15.html</guid>
  <pubDate>Wed, 21 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>preprocessing</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="data-load" class="level2">
<h2 class="anchored" data-anchor-id="data-load">Data Load</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lavaan)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(survey)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid
Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack

Loading required package: survival

Attaching package: 'survey'

The following object is masked from 'package:graphics':

    dotchart</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(semPlot)</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(caret)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:survival':

    cluster

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(randomForest)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2
Type rfNews() to see new features/changes/bug fixes.

Attaching package: 'randomForest'

The following object is masked from 'package:dplyr':

    combine

The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pROC)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kableExtra)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ROSE) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ROSE 패키지 추가 (불균형 데이터 처리)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded ROSE 0.0-4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">ID_VAR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span></span>
<span id="cb18-2">WEIGHT_VAR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt2"</span></span>
<span id="cb18-3">OUTCOME_VAR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status_category"</span></span>
<span id="cb18-4"></span>
<span id="cb18-5">target_pred_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(ID_VAR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a01"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a02"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a03"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a04"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a05"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a06"</span>,</span>
<span id="cb18-6">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a07"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a08"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a09"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a10"</span>,</span>
<span id="cb18-7">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a01"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a02"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a03"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a04"</span>,</span>
<span id="cb18-8">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a07"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a08"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q33a09"</span>,</span>
<span id="cb18-9">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a15"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a16"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a17"</span>,</span>
<span id="cb18-10">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a09"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a10"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a11"</span>,</span>
<span id="cb18-11">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48b1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48b2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48b3"</span>,</span>
<span id="cb18-12">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q12a01"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q12a02"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q12a03"</span>,</span>
<span id="cb18-13">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a04"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a05"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q48a06"</span>,</span>
<span id="cb18-14">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a05"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a06"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q49a08"</span>)</span>
<span id="cb18-15"></span>
<span id="cb18-16">cfa_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb18-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 1. 부모애착</span></span>
<span id="cb18-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  parent_attachment =~ q33a01 + q33a02 + q33a03 + q33a04 + q33a05 + q33a06</span></span>
<span id="cb18-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 2. 일탈적 자아 낙인</span></span>
<span id="cb18-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  deviant_esteem =~ q48a07 + q48a08 + q48a09 + q48a10</span></span>
<span id="cb18-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 3. 부모에 의한 스트레스</span></span>
<span id="cb18-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  parent_stress =~ q49a01 + q49a02 + q49a03 + q49a04</span></span>
<span id="cb18-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 4. 부모감독</span></span>
<span id="cb18-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  parent_monitoring =~ q33a07 + q33a08 + q33a09</span></span>
<span id="cb18-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 5. 물질적 요인으로 인한 스트레스</span></span>
<span id="cb18-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  desire_stress =~ q49a15 + q49a16 + q49a17</span></span>
<span id="cb18-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 6. 친구로 인한 스트레스</span></span>
<span id="cb18-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  friend_stress =~ q49a09 + q49a10 + q49a11</span></span>
<span id="cb18-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 7. 자기신뢰감</span></span>
<span id="cb18-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  self_confidence =~ q48b1 + q48b2 + q48b3</span></span>
<span id="cb18-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 8. 상급학교 의존도</span></span>
<span id="cb18-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  higher_school_dependence =~ q12a01 + q12a02 + q12a03</span></span>
<span id="cb18-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 9. 부정적 자아존중감</span></span>
<span id="cb18-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  neg_esteem =~ q48a04 + q48a05 + q48a06</span></span>
<span id="cb18-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  # 10. 학업으로 인한 스트레스</span></span>
<span id="cb18-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  academic_stress =~ q49a05 + q49a06 + q49a08</span></span>
<span id="cb18-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb18-38"></span>
<span id="cb18-39">df1_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_1.csv'</span>)</span>
<span id="cb18-40">df2_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_2.csv'</span>)</span>
<span id="cb18-41">df3_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_3.csv'</span>)</span>
<span id="cb18-42">df4_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_4.csv'</span>)</span>
<span id="cb18-43">df5_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_5.csv'</span>)</span>
<span id="cb18-44">df6_origin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_data/student_6.csv'</span>)</span></code></pre></div>
</div>
</section>
<section id="cfa-confirmatory-factor-analysis" class="level2">
<h2 class="anchored" data-anchor-id="cfa-confirmatory-factor-analysis">CFA (Confirmatory Factor Analysis)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">merged_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>()</span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {</span>
<span id="cb19-3">  ID_VAR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span></span>
<span id="cb19-4">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"df"</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_origin"</span>))</span>
<span id="cb19-5">  df_analysis <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df[target_pred_var]</span>
<span id="cb19-6">  df_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(df_analysis)</span>
<span id="cb19-7">  cfa_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cfa</span>(</span>
<span id="cb19-8">    cfa_model,</span>
<span id="cb19-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_clean,</span>
<span id="cb19-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sampling.weights =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt1"</span>,</span>
<span id="cb19-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLR"</span>,</span>
<span id="cb19-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"robust.cluster"</span>,</span>
<span id="cb19-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"satorra.bentler"</span>)</span>
<span id="cb19-14">  factor_scores <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lavPredict</span>(cfa_fit)</span>
<span id="cb19-15">  factor_scores_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(df_clean[ID_VAR], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(factor_scores))</span>
<span id="cb19-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(factor_scores_df)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(factor_scores_df)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_w"</span>, i)</span>
<span id="cb19-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb19-18">    merged_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> factor_scores_df</span>
<span id="cb19-19">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb19-20">    merged_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(merged_df, factor_scores_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> ID_VAR, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb19-21">  }</span>
<span id="cb19-22">}</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: lavaan-&gt;lav_options_set():  
   observed.information for ALL test statistics is set to h1.
Warning: lavaan-&gt;lav_options_set():  
   observed.information for ALL test statistics is set to h1.
Warning: lavaan-&gt;lav_options_set():  
   observed.information for ALL test statistics is set to h1.
Warning: lavaan-&gt;lav_options_set():  
   observed.information for ALL test statistics is set to h1.
Warning: lavaan-&gt;lav_options_set():  
   observed.information for ALL test statistics is set to h1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">classify_status <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(q11_value) {</span>
<span id="cb21-2">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (q11_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">71</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">91</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">111</span>)) {</span>
<span id="cb21-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"active"</span>)</span>
<span id="cb21-4">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (q11_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)) {</span>
<span id="cb21-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"passive"</span>)</span>
<span id="cb21-6">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb21-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb21-8">  }</span>
<span id="cb21-9">}</span>
<span id="cb21-10"></span>
<span id="cb21-11">extra_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df6_origin[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"q11"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sex"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"area"</span>)]</span>
<span id="cb21-12">extra_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>status_category <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mapply</span>(classify_status, extra_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>q11)</span>
<span id="cb21-13">merged_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(merged_df, extra_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
</section>
<section id="인구통계학적-분포-분석" class="level2">
<h2 class="anchored" data-anchor-id="인구통계학적-분포-분석">인구통계학적 분포 분석</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">merged_df_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete.cases</span>(.))</span>
<span id="cb22-3"></span>
<span id="cb22-4">sex_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(sex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb22-7"></span>
<span id="cb22-8">birth_year_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(yy) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb22-11"></span>
<span id="cb22-12">area_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(area) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb22-15"></span>
<span id="cb22-16">status_dist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(status_category) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb22-19"></span>
<span id="cb22-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 표 출력</span></span>
<span id="cb22-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(sex_dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"성별 분포 (결측치 제거 후)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"striped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hover"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>성별 분포 (결측치 제거 후)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">sex</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1157</td>
<td style="text-align: right;">47.47641</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1280</td>
<td style="text-align: right;">52.52359</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(birth_year_dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"출생년도 분포 (결측치 제거 후)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"striped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hover"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>출생년도 분포 (결측치 제거 후)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">yy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">88</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">89</td>
<td style="text-align: right;">1884</td>
<td style="text-align: right;">77.3081658</td>
</tr>
<tr class="odd">
<td style="text-align: right;">90</td>
<td style="text-align: right;">551</td>
<td style="text-align: right;">22.6097661</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(area_dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"거주 지역 분포 (결측치 제거 후)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"striped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hover"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>거주 지역 분포 (결측치 제거 후)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">110</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.5744768</td>
</tr>
<tr class="odd">
<td style="text-align: right;">120</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.6155109</td>
</tr>
<tr class="even">
<td style="text-align: right;">121</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">122</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="even">
<td style="text-align: right;">130</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1231022</td>
</tr>
<tr class="odd">
<td style="text-align: right;">131</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.4924087</td>
</tr>
<tr class="even">
<td style="text-align: right;">132</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.2872384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">133</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.8206812</td>
</tr>
<tr class="even">
<td style="text-align: right;">134</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">135</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.4924087</td>
</tr>
<tr class="even">
<td style="text-align: right;">136</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.7386130</td>
</tr>
<tr class="odd">
<td style="text-align: right;">137</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">138</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0.6565449</td>
</tr>
<tr class="odd">
<td style="text-align: right;">139</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">1.5182602</td>
</tr>
<tr class="even">
<td style="text-align: right;">140</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.1641362</td>
</tr>
<tr class="odd">
<td style="text-align: right;">142</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.2462043</td>
</tr>
<tr class="even">
<td style="text-align: right;">143</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="odd">
<td style="text-align: right;">150</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.6155109</td>
</tr>
<tr class="even">
<td style="text-align: right;">151</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.7796471</td>
</tr>
<tr class="odd">
<td style="text-align: right;">152</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="even">
<td style="text-align: right;">153</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.1641362</td>
</tr>
<tr class="odd">
<td style="text-align: right;">156</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.7386130</td>
</tr>
<tr class="even">
<td style="text-align: right;">157</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0.7796471</td>
</tr>
<tr class="odd">
<td style="text-align: right;">158</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0.6565449</td>
</tr>
<tr class="even">
<td style="text-align: right;">200</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="odd">
<td style="text-align: right;">210</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1231022</td>
</tr>
<tr class="even">
<td style="text-align: right;">220</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.8617152</td>
</tr>
<tr class="odd">
<td style="text-align: right;">225</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.6155109</td>
</tr>
<tr class="even">
<td style="text-align: right;">232</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">235</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">240</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.9848174</td>
</tr>
<tr class="odd">
<td style="text-align: right;">300</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.3282725</td>
</tr>
<tr class="even">
<td style="text-align: right;">301</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.8206812</td>
</tr>
<tr class="odd">
<td style="text-align: right;">302</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">1.5592942</td>
</tr>
<tr class="even">
<td style="text-align: right;">305</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.9848174</td>
</tr>
<tr class="odd">
<td style="text-align: right;">306</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.1641362</td>
</tr>
<tr class="even">
<td style="text-align: right;">314</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">320</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">321</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.5334428</td>
</tr>
<tr class="odd">
<td style="text-align: right;">330</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="even">
<td style="text-align: right;">336</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.2051703</td>
</tr>
<tr class="odd">
<td style="text-align: right;">339</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">340</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">350</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="even">
<td style="text-align: right;">355</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="odd">
<td style="text-align: right;">356</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">360</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.5334428</td>
</tr>
<tr class="odd">
<td style="text-align: right;">361</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1.3951580</td>
</tr>
<tr class="even">
<td style="text-align: right;">363</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">367</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">369</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">370</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.1489536</td>
</tr>
<tr class="even">
<td style="text-align: right;">373</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">380</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="even">
<td style="text-align: right;">390</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">402</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1.1899877</td>
</tr>
<tr class="odd">
<td style="text-align: right;">403</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.0258515</td>
</tr>
<tr class="even">
<td style="text-align: right;">404</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="odd">
<td style="text-align: right;">405</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.1489536</td>
</tr>
<tr class="even">
<td style="text-align: right;">406</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="odd">
<td style="text-align: right;">407</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.5744768</td>
</tr>
<tr class="even">
<td style="text-align: right;">411</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.9848174</td>
</tr>
<tr class="odd">
<td style="text-align: right;">412</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.4103406</td>
</tr>
<tr class="even">
<td style="text-align: right;">413</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.8617152</td>
</tr>
<tr class="odd">
<td style="text-align: right;">415</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">420</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1.1899877</td>
</tr>
<tr class="odd">
<td style="text-align: right;">421</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.5334428</td>
</tr>
<tr class="even">
<td style="text-align: right;">422</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">423</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">425</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="odd">
<td style="text-align: right;">426</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="even">
<td style="text-align: right;">427</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">429</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.4924087</td>
</tr>
<tr class="even">
<td style="text-align: right;">430</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.9848174</td>
</tr>
<tr class="odd">
<td style="text-align: right;">431</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">435</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.1489536</td>
</tr>
<tr class="odd">
<td style="text-align: right;">440</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.3282725</td>
</tr>
<tr class="even">
<td style="text-align: right;">441</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="odd">
<td style="text-align: right;">442</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1.2310217</td>
</tr>
<tr class="even">
<td style="text-align: right;">443</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.2462043</td>
</tr>
<tr class="odd">
<td style="text-align: right;">445</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">1.5592942</td>
</tr>
<tr class="even">
<td style="text-align: right;">447</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1231022</td>
</tr>
<tr class="odd">
<td style="text-align: right;">449</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">1.3541239</td>
</tr>
<tr class="even">
<td style="text-align: right;">456</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">459</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">461</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.3693065</td>
</tr>
<tr class="odd">
<td style="text-align: right;">462</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.4103406</td>
</tr>
<tr class="even">
<td style="text-align: right;">463</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.6155109</td>
</tr>
<tr class="odd">
<td style="text-align: right;">464</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">465</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">471</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">472</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="odd">
<td style="text-align: right;">480</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="even">
<td style="text-align: right;">481</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">500</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1.3951580</td>
</tr>
<tr class="even">
<td style="text-align: right;">502</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1.1899877</td>
</tr>
<tr class="odd">
<td style="text-align: right;">503</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="even">
<td style="text-align: right;">506</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.1489536</td>
</tr>
<tr class="odd">
<td style="text-align: right;">517</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.8206812</td>
</tr>
<tr class="even">
<td style="text-align: right;">525</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="odd">
<td style="text-align: right;">530</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">534</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">536</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">540</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1.0258515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">560</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="even">
<td style="text-align: right;">561</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.2872384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">565</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">570</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="odd">
<td style="text-align: right;">573</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.8206812</td>
</tr>
<tr class="even">
<td style="text-align: right;">576</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="odd">
<td style="text-align: right;">579</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">595</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.2872384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">600</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">601</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">602</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.6155109</td>
</tr>
<tr class="even">
<td style="text-align: right;">604</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">607</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">608</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">609</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="even">
<td style="text-align: right;">611</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.2872384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">612</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.8617152</td>
</tr>
<tr class="even">
<td style="text-align: right;">613</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="odd">
<td style="text-align: right;">614</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="even">
<td style="text-align: right;">616</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1231022</td>
</tr>
<tr class="odd">
<td style="text-align: right;">617</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.1231022</td>
</tr>
<tr class="even">
<td style="text-align: right;">619</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">621</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0.9027493</td>
</tr>
<tr class="even">
<td style="text-align: right;">626</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1.2310217</td>
</tr>
<tr class="odd">
<td style="text-align: right;">631</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1.2310217</td>
</tr>
<tr class="even">
<td style="text-align: right;">637</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">638</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">641</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1.2310217</td>
</tr>
<tr class="odd">
<td style="text-align: right;">645</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">650</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">1.0668855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">656</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">660</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">1.3541239</td>
</tr>
<tr class="odd">
<td style="text-align: right;">676</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.7386130</td>
</tr>
<tr class="even">
<td style="text-align: right;">680</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.9437833</td>
</tr>
<tr class="odd">
<td style="text-align: right;">681</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">1.1489536</td>
</tr>
<tr class="even">
<td style="text-align: right;">682</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">1.1079196</td>
</tr>
<tr class="odd">
<td style="text-align: right;">689</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">700</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.5334428</td>
</tr>
<tr class="odd">
<td style="text-align: right;">701</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1.3130899</td>
</tr>
<tr class="even">
<td style="text-align: right;">702</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.2872384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">703</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">704</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">1.8875667</td>
</tr>
<tr class="odd">
<td style="text-align: right;">705</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.4924087</td>
</tr>
<tr class="even">
<td style="text-align: right;">706</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1.3130899</td>
</tr>
<tr class="odd">
<td style="text-align: right;">711</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0820681</td>
</tr>
<tr class="even">
<td style="text-align: right;">712</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.8617152</td>
</tr>
<tr class="odd">
<td style="text-align: right;">718</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">730</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">1.2720558</td>
</tr>
<tr class="odd">
<td style="text-align: right;">742</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">750</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.8617152</td>
</tr>
<tr class="odd">
<td style="text-align: right;">757</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.7386130</td>
</tr>
<tr class="even">
<td style="text-align: right;">760</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.1641362</td>
</tr>
<tr class="odd">
<td style="text-align: right;">764</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="even">
<td style="text-align: right;">770</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0410341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">780</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.6975790</td>
</tr>
<tr class="even">
<td style="text-align: right;">790</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.3693065</td>
</tr>
<tr class="odd">
<td style="text-align: right;">791</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0.6565449</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(status_dist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"종속변수(Active vs Passive) 분포 (결측치 제거 후)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable_styling</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bootstrap_options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"striped"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hover"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full_width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")
Warning in attr(x, "align"): 'xfun::attr()' is deprecated.
Use 'xfun::attr2()' instead.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>종속변수(Active vs Passive) 분포 (결측치 제거 후)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">status_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">active</td>
<td style="text-align: right;">1680</td>
<td style="text-align: right;">68.93722</td>
</tr>
<tr class="even">
<td style="text-align: left;">passive</td>
<td style="text-align: right;">757</td>
<td style="text-align: right;">31.06278</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="분포-시각화" class="level2">
<h2 class="anchored" data-anchor-id="분포-시각화">분포 시각화</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 성별 분포 시각화</span></span>
<span id="cb30-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(sex_dist, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> sex)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(percentage, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"성별 분포"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"성별"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 출생년도 분포 시각화</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(birth_year_dist, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> yy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(percentage, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"출생년도 분포"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"출생년도"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 종속변수 분포 시각화</span></span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(status_dist, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> status_category, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> status_category)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(percentage, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Active vs Passive 분포"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"상태 카테고리"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"빈도"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="지역-분포" class="level2">
<h2 class="anchored" data-anchor-id="지역-분포">지역 분포</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 한국 지도 데이터 패키지 설치 및 로드</span></span>
<span id="cb33-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(kormaps2014)) {</span>
<span id="cb33-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringi"</span>)</span>
<span id="cb33-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"devtools"</span>)</span>
<span id="cb33-5">  devtools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cardiomoon/kormaps2014"</span>)</span>
<span id="cb33-6">}</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: kormaps2014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(kormaps2014)</span>
<span id="cb35-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb35-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringi)</span>
<span id="cb35-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mapproj)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'maps'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    map</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 대한민국 지역 시각화를 위한 준비</span></span>
<span id="cb39-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb39-3"></span>
<span id="cb39-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 지역 코드와 merged_df의 area 코드 매핑 함수</span></span>
<span id="cb39-5">map_area_code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(area_code) {</span>
<span id="cb39-6">  area_mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb39-7">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-8">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"110"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-9">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"120"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-10">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"121"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"122"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"130"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"131"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"132"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"133"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-16">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"134"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-17">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"135"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-18">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"136"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-19">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"137"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-20">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"138"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-21">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"139"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-22">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"140"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-23">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"142"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-24">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"143"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-25">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"150"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-26">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"151"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-27">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"152"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-28">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"153"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-29">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"156"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-30">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"157"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-31">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"158"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"서울"</span>,</span>
<span id="cb39-32">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"200"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-33">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"209"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-34">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"210"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-35">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"215"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-36">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"217"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-37">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"219"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-38">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"220"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-39">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"225"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-40">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"230"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-41">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"232"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-42">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"233"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-43">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"235"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-44">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"240"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-45">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"245"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-46">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"250"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-47">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"252"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-48">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"255"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-49">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"269"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"강원"</span>,</span>
<span id="cb39-50">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"300"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대전"</span>,</span>
<span id="cb39-51">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"301"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대전"</span>,</span>
<span id="cb39-52">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"302"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대전"</span>,</span>
<span id="cb39-53">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"305"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대전"</span>,</span>
<span id="cb39-54">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"306"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대전"</span>,</span>
<span id="cb39-55">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"312"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-56">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"314"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-57">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"320"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-58">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"321"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-59">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"323"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-60">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"325"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-61">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"330"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-62">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"336"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-63">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"339"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-64">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"340"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-65">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"343"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-66">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"345"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-67">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"350"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-68">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"355"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-69">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"356"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-70">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"357"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충남"</span>,</span>
<span id="cb39-71">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"360"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-72">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"361"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-73">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"363"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-74">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"365"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-75">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"367"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-76">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"368"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-77">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"369"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-78">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"370"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-79">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"373"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-80">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"376"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-81">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"380"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-82">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"390"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-83">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"395"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"충북"</span>,</span>
<span id="cb39-84">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-85">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"401"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-86">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"402"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-87">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"403"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-88">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"404"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-89">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"405"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-90">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"406"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-91">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"407"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-92">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"409"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-93">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"411"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-94">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"412"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-95">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"413"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-96">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"415"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-97">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"417"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"인천"</span>,</span>
<span id="cb39-98">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"420"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-99">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"421"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-100">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"422"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-101">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"423"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-102">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"425"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-103">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"426"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-104">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"427"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-105">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"429"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-106">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"430"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-107">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"431"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-108">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"435"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-109">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"437"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-110">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"440"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-111">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"441"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-112">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"442"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-113">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"443"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-114">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"445"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-115">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"447"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-116">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"449"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-117">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"456"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-118">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"459"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-119">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"461"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-120">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"462"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-121">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"463"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-122">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"464"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-123">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"465"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-124">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"467"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-125">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"469"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-126">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"471"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-127">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"472"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-128">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"476"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-129">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"477"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-130">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"480"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-131">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"481"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-132">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"482"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-133">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"483"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-134">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"487"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경기"</span>,</span>
<span id="cb39-135">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"500"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"광주"</span>,</span>
<span id="cb39-136">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"501"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"광주"</span>,</span>
<span id="cb39-137">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"502"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"광주"</span>,</span>
<span id="cb39-138">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"503"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"광주"</span>,</span>
<span id="cb39-139">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"506"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"광주"</span>,</span>
<span id="cb39-140">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"513"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-141">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"515"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-142">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"516"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-143">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"517"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-144">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"519"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-145">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"520"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-146">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"525"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-147">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"526"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-148">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"527"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-149">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"529"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-150">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"530"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-151">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"534"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-152">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"535"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-153">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"536"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-154">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"537"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-155">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"539"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-156">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"540"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-157">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"542"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-158">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"545"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-159">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"546"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-160">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"548"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-161">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"550"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전남"</span>,</span>
<span id="cb39-162">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"560"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-163">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"561"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-164">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"565"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-165">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"566"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-166">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"567"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-167">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"568"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-168">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"570"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-169">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"573"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-170">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"576"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-171">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"579"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-172">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"580"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-173">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"585"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-174">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"590"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-175">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"595"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-176">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"597"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"전북"</span>,</span>
<span id="cb39-177">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"600"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-178">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"601"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-179">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"602"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-180">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"604"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-181">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"606"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-182">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"607"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-183">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"608"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-184">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"609"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-185">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"611"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-186">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"612"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-187">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"613"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-188">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"614"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-189">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"616"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-190">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"617"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-191">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"618"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-192">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"619"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"부산"</span>,</span>
<span id="cb39-193">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"621"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-194">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"626"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-195">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"627"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-196">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"631"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-197">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"635"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-198">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"636"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-199">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"637"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-200">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"638"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-201">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"641"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-202">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"645"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-203">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"650"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-204">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"656"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-205">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"660"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-206">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"664"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-207">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"666"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-208">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"667"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-209">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"668"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-210">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"670"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-211">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"676"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-212">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"678"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경남"</span>,</span>
<span id="cb39-213">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"680"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"울산"</span>,</span>
<span id="cb39-214">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"681"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"울산"</span>,</span>
<span id="cb39-215">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"682"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"울산"</span>,</span>
<span id="cb39-216">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"683"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"울산"</span>,</span>
<span id="cb39-217">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"689"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"울산"</span>,</span>
<span id="cb39-218">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"690"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"제주"</span>,</span>
<span id="cb39-219">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"695"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"제주"</span>,</span>
<span id="cb39-220">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"697"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"제주"</span>,</span>
<span id="cb39-221">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"699"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"제주"</span>,</span>
<span id="cb39-222">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"700"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-223">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"701"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-224">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"702"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-225">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"703"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-226">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"704"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-227">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"705"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-228">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"706"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-229">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"711"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대구"</span>,</span>
<span id="cb39-230">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"712"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-231">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"714"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-232">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"716"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-233">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"717"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-234">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"718"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-235">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"719"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-236">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"730"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-237">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"740"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-238">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"742"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-239">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"745"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-240">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"750"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-241">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"755"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-242">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"757"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-243">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"760"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-244">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"763"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-245">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"764"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-246">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"766"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-247">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"767"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-248">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"769"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-249">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"770"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-250">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"780"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-251">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"790"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-252">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"791"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-253">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"799"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경북"</span>,</span>
<span id="cb39-254">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"999"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"국외"</span></span>
<span id="cb39-255">  )</span>
<span id="cb39-256">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(area_mapping[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(area_code)])</span>
<span id="cb39-257">}</span>
<span id="cb39-258"></span>
<span id="cb39-259"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># area 코드를 지역명으로 변환</span></span>
<span id="cb39-260">merged_df_clean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>area_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(merged_df_clean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>area, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_area_code</span>(x))</span>
<span id="cb39-261"></span>
<span id="cb39-262"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 지역별 집계</span></span>
<span id="cb39-263">region_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb39-264">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(area_name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb39-265">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage =</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb39-266"></span>
<span id="cb39-267"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 지역 분포 시각화 - 막대 그래프로 표현</span></span>
<span id="cb39-268"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(region_counts, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(area_name, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>percentage), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percentage, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> area_name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-269">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-270">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(percentage, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-271">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"지역별 분포 (결측치 제거 후)"</span>,</span>
<span id="cb39-272">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"지역"</span>, </span>
<span id="cb39-273">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"비율 (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-274">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-275">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb39-276">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="데이터-전처리-및-train-test-split" class="level2">
<h2 class="anchored" data-anchor-id="데이터-전처리-및-train-test-split">데이터 전처리 및 train test split</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">pred_vars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(merged_df)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_w[1-5]$"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(merged_df))]</span>
<span id="cb40-2">model_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(ID_VAR), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(OUTCOME_VAR), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sym</span>(WEIGHT_VAR), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(pred_vars))</span>
<span id="cb40-4">model_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">complete.cases</span>(.))</span>
<span id="cb40-6">model_df[[OUTCOME_VAR]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(model_df[[OUTCOME_VAR]])</span>
<span id="cb40-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(model_df[[OUTCOME_VAR]]) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.names</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(model_df[[OUTCOME_VAR]]))</span>
<span id="cb40-8"></span>
<span id="cb40-9">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_df[, pred_vars]</span>
<span id="cb40-10">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_df[[OUTCOME_VAR]]</span>
<span id="cb40-11">weights <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model_df[[WEIGHT_VAR]]</span>
<span id="cb40-12"></span>
<span id="cb40-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1234</span>)</span>
<span id="cb40-14">train_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">createDataPartition</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">list =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb40-15"></span>
<span id="cb40-16">X_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X[train_index, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb40-17">X_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>train_index, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb40-18">y_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y[train_index]</span>
<span id="cb40-19">y_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>train_index]</span>
<span id="cb40-20">weights_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights[train_index]</span>
<span id="cb40-21">weights_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> weights[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>train_index]</span></code></pre></div>
</div>
</section>
<section id="오버샘플링" class="level2">
<h2 class="anchored" data-anchor-id="오버샘플링">오버샘플링</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">train_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(X_train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_train)</span>
<span id="cb41-2">rose_train_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ROSE</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> train_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">N =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(train_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data</span>
<span id="cb41-3"></span>
<span id="cb41-4">X_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rose_train_data[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(rose_train_data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]</span>
<span id="cb41-5">y_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rose_train_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span></code></pre></div>
</div>
</section>
<section id="데이터-저장" class="level2">
<h2 class="anchored" data-anchor-id="데이터-저장">데이터 저장</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1">train_data_to_save <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb42-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_train,</span>
<span id="cb42-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights_train,</span>
<span id="cb42-4">  X_train</span>
<span id="cb42-5">)</span>
<span id="cb42-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(train_data_to_save, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_data/train_data.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb42-7">test_data_to_save <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb42-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_test,</span>
<span id="cb42-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weights =</span> weights_test,</span>
<span id="cb42-10">  X_test</span>
<span id="cb42-11">)</span>
<span id="cb42-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(test_data_to_save, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_data/test_data.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/14.html</guid>
  <pubDate>Wed, 21 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>총괄생산계획</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/11.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="총괄생산계획" class="level2">
<h2 class="anchored" data-anchor-id="총괄생산계획">총괄생산계획</h2>
<ul>
<li>중기 범위(6-18개월) 기간에 대한 유사한 제품 묶음 수준에서 수요-공급 균형을 맞추기 위한 생산 계획</li>
<li>제품 묶음
<ul>
<li>생산 공정, 시간, 비용, 필요 자원 등의 측면에서 유사.</li>
<li>개별 제품에 비해 예측 정확도가 높음</li>
</ul></li>
<li>계획 수립 후 주기적으로 업데이트</li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>생산시스템관리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/11.html</guid>
  <pubDate>Sun, 18 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/12.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <category>OR</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/12.pdf</guid>
  <pubDate>Sun, 18 May 2025 00:27:43 GMT</pubDate>
</item>
<item>
  <title>Regression Analysis</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/statistics/04.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>



<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>확률과 통계</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/statistics/04.html</guid>
  <pubDate>Mon, 12 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>예측</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/10.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<p>4페이지 집중 못함</p>
<section id="판단적-기법정성적-기법" class="level2">
<h2 class="anchored" data-anchor-id="판단적-기법정성적-기법">판단적 기법(정성적 기법)</h2>
<ul>
<li>전문가의 경험과 직관에 의존하여 예측하는 기법</li>
<li>비정량적 / 주관적 데이터로 정량적인 예측치를 구함
<ul>
<li>단순예측법: 최근의 자료가 미래에 대한 최선의 추정치</li>
<li>추세분석:치전기와 현기 사이의 추세를 다음 기의 판매예측에 반영하는 방법</li>
<li>시장조사법</li>
<li>전문가 의견 종합법</li>
<li>사례유추법: 비슷한 제품이랑 비교</li>
<li>델파이 기법</li>
</ul></li>
</ul>
</section>
<section id="시계열-기법" class="level2">
<h2 class="anchored" data-anchor-id="시계열-기법">시계열 기법</h2>
<ul>
<li>단순 이동평균법: time window를 계속 이동하면서 평균 구하는거
<ul>
<li>time window ↑: 먼 과거까지 보겠다</li>
</ul></li>
<li>가중 이동평균법: 가까울 수록 가중치를 크게 부여</li>
<li>지수평활법: 과거의 모든 데이터를 가중 평균
<ul>
<li>지수평활계수(α): 최근의 값을 더 높은 가중치가 부여되도록 추정</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Chat%7By_%7Bt+1%7D%7D%20=%20%CE%B1y_t+%20(1-%CE%B1)%5Chat%7By_t%7D%20=%20%5Chat%7By_t%7D%20+%20%CE%B1(y_t%20-%20%5Chat%7By_t%7D"></li>
<li>예측치와 관측치 중 어디에 중점을 둘 지에 따라서 α 결정</li>
<li>== 오차를 어느정도 반영할지에 따라서 α 결정</li>
</ul></li>
</ul>
</section>
<section id="상관관계-기법" class="level2">
<h2 class="anchored" data-anchor-id="상관관계-기법">상관관계 기법</h2>
<ul>
<li>선행 지수법</li>
</ul>
</section>
<section id="계절성-수요예측" class="level2">
<h2 class="anchored" data-anchor-id="계절성-수요예측">계절성 수요예측</h2>
<ul>
<li>계절</li>
<li>추세</li>
</ul>
</section>
<section id="예측의-품질-평가" class="level2">
<h2 class="anchored" data-anchor-id="예측의-품질-평가">예측의 품질 평가</h2>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>생산시스템관리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/10.html</guid>
  <pubDate>Sun, 11 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/06.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <category>데이터 마이닝</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/06.pdf</guid>
  <pubDate>Sat, 10 May 2025 00:37:01 GMT</pubDate>
</item>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/05.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <category>데이터 마이닝</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/05.pdf</guid>
  <pubDate>Sat, 10 May 2025 00:36:38 GMT</pubDate>
</item>
<item>
  <title>Support vector machine</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/03.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<ul>
<li>bias variance tradeoff
<ul>
<li>margin ↑, bias ↑, variance ↓</li>
<li>margin ↓, bias ↓, variance ↑</li>
</ul></li>
<li>suppot vector: 임계값에 가까운 데이터 포인트</li>
<li>linear classification fomulation:</li>
</ul>
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/img/2025-05-05-10-49-25.png" class="img-fluid"></p>
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/img/2025-05-05-10-49-34.png" class="img-fluid"></p>
<ul>
<li>if not linear solvable → kernel functions</li>
<li>soft margin: 이상치를 포함할 수 있는 마진
<ul>
<li>cross validation으로 최적의 soft margin을 찾는다.</li>
</ul></li>
</ul>



<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/03.html</guid>
  <pubDate>Sun, 04 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>의사결정 트리</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/02.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<p>불순도가 가장 낮은 leaves를 root에 두고, 그 다음 불순도가 낮은 leaf를 그 아래에 두는 방식으로 트리를 구성한다. leaf 노드의 과반수가 같은 클래스를 가지면 그 클래스를 리턴한다. overfit을 방비하기 위해 pruning을 하거나 max depth를 설정한다.</p>
<section id="과정" class="level2">
<h2 class="anchored" data-anchor-id="과정">과정</h2>
<ol type="1">
<li>루트 노드에서 시작전체 데이터셋을 기준으로 시작하여 가장 좋은 분할속성(feature)을 선택</li>
<li>분할 기준 평가각 속성에 대해 데이터를 분할했을 때의 분할 평가함수 적용
<ul>
<li>gini index</li>
<li>entropy</li>
<li>information gain</li>
<li>gain ratio</li>
</ul></li>
<li>최적의 분할 선택 평가된 기준 중 가장 순도가 높은 점수를 갖는 속성을 선택 (greedy)</li>
<li>재귀적으로 하위 노드 분할분할된 하위 데이터에 대해 위의 과정을 반복</li>
<li>종료 조건 만족 시 정지</li>
</ol>
</section>
<section id="algorithm" class="level2">
<h2 class="anchored" data-anchor-id="algorithm">Algorithm</h2>
<ol type="1">
<li>CART
<ul>
<li>분할 기준
<ul>
<li>분류: gini index</li>
<li>회귀: MSE</li>
</ul></li>
<li>모든 분할에서 이진 트리로 분할</li>
<li>사후 가지치기
<ul>
<li>비용 복잡도 가지치기: <img src="https://latex.codecogs.com/png.latex?Total%20SSR%20+%20%CE%B1(leaf%20size)">이 제일 작은 트리 선택</li>
<li>α는 cross validation으로 결정</li>
</ul></li>
</ul></li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/02.html</guid>
  <pubDate>Sun, 04 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>수송문제와 할당 문제들</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/11.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<iframe src="new.pdf" width="100%" height="600px" allowfullscreen="">
</iframe>



<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>OR</category>
  <category>학부 정리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/11.html</guid>
  <pubDate>Thu, 01 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>선형계획을 위한 다른 알고리즘들</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/10.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="쌍대-심플렉스-방법" class="level2">
<h2 class="anchored" data-anchor-id="쌍대-심플렉스-방법">쌍대 심플렉스 방법</h2>
<ul>
<li>쌍대 문제 제약식에 -1 하고 slack 변수 추가해서 반대로 품.</li>
</ul>
</section>
<section id="상한-기법" class="level2">
<h2 class="anchored" data-anchor-id="상한-기법">상한 기법</h2>
<ul>
<li>일단은 대수적으로 푸는 방법만 배움.</li>
<li>변수가 0일 때 뿐만 아니라 upper bound일 때도 non-basic variable로 취급.</li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>OR</category>
  <category>학부 정리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/10.html</guid>
  <pubDate>Thu, 01 May 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>프로젝트 관리</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/09.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="프로젝트-vs-프로세스" class="level2">
<h2 class="anchored" data-anchor-id="프로젝트-vs-프로세스">프로젝트 vs 프로세스</h2>
<ul>
<li>프로젝트: 일회성, 하나의 흐름단위</li>
<li>프로세스: 지속적, 여러 흐름 단위</li>
</ul>
</section>
<section id="주경로-기법critical-path-method-cpm" class="level2">
<h2 class="anchored" data-anchor-id="주경로-기법critical-path-method-cpm">주경로 기법(Critical Path Method, CPM)</h2>
<ul>
<li>프로젝트 완료 시간 계산</li>
<li>종속성 path(가장 짧은 시간) 중 가장 긴 path가 critial path
<ul>
<li>이 path의 활동이 지연되면 프로젝트 전체가 지연됨</li>
<li>프로세스 흐름도에서 개별작업의 처리능력이 중요했던것과 달리 프로젝트 종료 시간이 중요.</li>
</ul></li>
</ul>
</section>
<section id="불확실성-하에서의-프로젝트-관리" class="level2">
<h2 class="anchored" data-anchor-id="불확실성-하에서의-프로젝트-관리">불확실성 하에서의 프로젝트 관리</h2>
<ul>
<li>CPM(Critical Path Method): 소요 시간이 정확하게 알려져 있다고 가정</li>
<li>PERT(Program Evaluation and Review Technique): 소요 시간이 불확실하다고 가정</li>
</ul>
<section id="가정" class="level3">
<h3 class="anchored" data-anchor-id="가정">가정</h3>
<ol type="1">
<li>주 경로는 각 활동의 평균 소요시간으로구함</li>
<li>주 경로는 바뀌지 않음</li>
<li>각 활동의 소요시간은 독립적임</li>
</ol>
</section>
<section id="특징" class="level3">
<h3 class="anchored" data-anchor-id="특징">특징</h3>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?d_1,%20d_2,%20...,%20d_n">이 확률변수이면 프로젝트 완성시간 (<img src="https://latex.codecogs.com/png.latex?X">)도 확률변수</li>
<li><img src="https://latex.codecogs.com/png.latex?d_1,%20d_2,%20...,%20d_n">이 정규분포를 따른다면 <img src="https://latex.codecogs.com/png.latex?X">도 정규분포를 따름</li>
</ul>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>생산시스템관리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/09.html</guid>
  <pubDate>Tue, 29 Apr 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>프로세스 성과에 미치는 변동성의 영향: 산술 손실</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/08.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<ul>
<li><p>범위는 대략 16까지</p></li>
<li><p>고객이 대기하다가 포기하는 경우를 고려</p></li>
</ul>
<section id="example-food-truck" class="level2">
<h2 class="anchored" data-anchor-id="example-food-truck">example: Food Truck</h2>
<ul>
<li>변동(동일한 확률 가정)
<ul>
<li><strong>수요</strong></li>
<li><strong>공급할 수 있는 양</strong></li>
</ul></li>
<li>수요와 공급이 <strong>동시</strong>에 발생하지 않는 경우로 인해 평균 흐름률이 실제랑 다름.
<ul>
<li><strong>변동성이 흐름률에 영향을 미침</strong></li>
<li>buffer가 있으면 흐름률 높일 수 있음
<ul>
<li>buffer가 없다면?</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="example-병원-외상-센터" class="level2">
<h2 class="anchored" data-anchor-id="example-병원-외상-센터">example: 병원 외상 센터</h2>
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-04-28-18-55-18.png" class="img-fluid"></p>
<ul>
<li>대기해야 할 상황이 있으면 다른 병원으로 이동
<ul>
<li>diversion 상태, loss(service를 못 받음)</li>
</ul></li>
</ul>
<section id="diversion-상태-확률" class="level3">
<h3 class="anchored" data-anchor-id="diversion-상태-확률">Diversion 상태 확률</h3>
<ul>
<li><p>D &lt; C 가정하지 않음</p></li>
<li><p>도착 간격은 지수분포 가정 (processing time 분포는 가정 안함)</p></li>
<li><p>대기하지 않고 바로 이탈한다고 가정</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?P_m">: <strong>내재활용률</strong>과 <strong>자원의 수</strong>에 의해 결정됨</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?r%20=%20um%20=%20%5Cfrac%7Bp%7D%7Ba%7D">, 해야하는 일의 양을 의미</p>
<ul>
<li>단위: Erlang</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-04-28-19-01-52.png" class="img-fluid figure-img"></p>
<figcaption>Erlang Loss Table</figcaption>
</figure>
</div>
<ul>
<li>들어온 인원: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Ba%7D(1%20-%20P_m(r))"></li>
<li>안 들어온 인원: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Ba%7DP_m(r)"></li>
</ul>
</section>
</section>
<section id="erlang-loss-table" class="level2">
<h2 class="anchored" data-anchor-id="erlang-loss-table">Erlang Loss Table</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-05-01-19-57-26.png" class="img-fluid figure-img"></p>
<figcaption>얼랑 솔실 공식<sup>1</sup></figcaption>
</figure>
</div>
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-05-01-20-09-03.png" class="img-fluid"></p>
</section>
<section id="buffer의-역할" class="level2">
<h2 class="anchored" data-anchor-id="buffer의-역할">buffer의 역할</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-05-01-20-10-25.png" class="img-fluid figure-img"></p>
<figcaption>변동성으로 인해 capacity가 낮아지는 이유</figcaption>
</figure>
</div>
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/img/2025-05-01-20-19-03.png" class="img-fluid"></p>
<ul>
<li>변동성이 없다면 cycle time은 1/capacity</li>
<li>변동성이 있다면 cycle time은 늘어남. (시뮬레이션으로 계산)</li>
<li>버퍼가 있으면 1/capacity로 점점 줄어듦.</li>
<li>cell layout을 사용하면 cycle time을 제일 많이 줄일 수 있음.</li>
</ul>


</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">각주</h2>

<ol>
<li id="fn1"><p>diversion 확률, 꽉 차있을 확률, 도착한 환자가 서비스 받을 확률, 다른 병원으로 갈 확률 시험에 나온다.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>생산시스템관리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/product/08.html</guid>
  <pubDate>Sun, 27 Apr 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>association rule mining</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/04.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/human-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="pattern-minig" class="level2">
<h2 class="anchored" data-anchor-id="pattern-minig">Pattern minig</h2>
<section id="basic-concepts" class="level3">
<h3 class="anchored" data-anchor-id="basic-concepts">Basic Concepts</h3>
<ul>
<li>pattern: dataset 안에서 함께 자주 발생하는 subsequences, substructures, set of items
<ul>
<li>이 pattern은 인과관계를 의미하진 않는다.</li>
</ul></li>
<li>Association rule minig: 최소 지지도나 신뢰도를 넘는 모든 항목에 대해 pattern을 찾는다.</li>
</ul>
</section>
<section id="applications" class="level3">
<h3 class="anchored" data-anchor-id="applications">Applications</h3>
<ul>
<li>association rule, correlation, classification, clustering data mining의 기반이 될 수 있다.</li>
<li>장바구니 분석</li>
<li>연속 구매 분석</li>
</ul>
</section>
<section id="terminologies" class="level3">
<h3 class="anchored" data-anchor-id="terminologies">Terminologies</h3>
<ul>
<li><strong>지지도(Support):</strong> 전체 거래 중 특정 항목 집합이 포함된 거래의 비율.</li>
<li><strong>신뢰도(Confidence):</strong> 항목 X를 포함하는 거래 중에서 항목 Y도 함께 포함하는 거래의 비율.</li>
<li><strong>빈발 패턴(frequent):</strong> 최소 지지도를 넘는 pattern
<ul>
<li>빈발 항목 집합(frequent itemset): 단순한 묶음</li>
<li>빈발 시퀀스</li>
</ul></li>
</ul>
</section>
<section id="closed-pattern" class="level3">
<h3 class="anchored" data-anchor-id="closed-pattern">closed pattern</h3>
<ul>
<li>x가 빈발이고, 지지도가 상위 집합들과 다른 집합 (지지도는 상위로 갈 수록 떨어짐)</li>
<li>지지도 정보를 유지할 수 있다.
<ul>
<li>신뢰도 계산할 때 사용할 수 있음</li>
</ul></li>
</ul>
</section>
<section id="max-patterns" class="level3">
<h3 class="anchored" data-anchor-id="max-patterns">max patterns</h3>
<ul>
<li>x가 빈발이고, 상위 집합들 모두가 빈발 집합이 아닌 집합</li>
<li>지지도 정보는 유지되지 않음.
<ul>
<li>신뢰도 계산할 때 사용할 수 없어서 사실 상 결과 요약 외의 용도는 없음</li>
</ul></li>
<li>Downward closure property: 어떤 itemset이 빈발하지 않으면, 그 모든 superset은 무조건 빈발하지 않는다. 대우도 성립
<ul>
<li>교수님은 anti-monotone property로 설명하셨지만 이게 더 자주 사용되는 용어</li>
</ul></li>
</ul>
</section>
</section>
<section id="association-rule" class="level2">
<h2 class="anchored" data-anchor-id="association-rule">Association Rule</h2>
<ol type="1">
<li>find frequent itemsets
<ul>
<li>Apriori (breadth-first search)</li>
<li>FP-Growth</li>
<li>Eclat (depth-first search)</li>
</ul></li>
<li>generate association rules
<ul>
<li>모든 빈발 itemset I에 대해 모든 I의 subset s로 ‘s -&gt; (I - s)’ 규칙을 생성</li>
<li>최소 신뢰도 조건을 만족하는 규칙만 남김</li>
</ul></li>
</ol>
</section>
<section id="algorithm" class="level2">
<h2 class="anchored" data-anchor-id="algorithm">Algorithm</h2>
<section id="apirori" class="level3">
<h3 class="anchored" data-anchor-id="apirori">Apirori</h3>
<ul>
<li>Monotone 성질을 이용하여 빈발하지 않는 집합은 후보에서 제거</li>
</ul>
<ol type="1">
<li>scan DB once to get 1-itemsets</li>
<li>반복
<ol type="1">
<li>k개의 itemset에 대해 k+1-itemset의 후보를 생성
<ol type="1">
<li>self-join: k-itemset을 두 개 합쳐서 k+1-itemset을 생성</li>
<li>prune: k+1-itemset을 생성할 때, k-itemset의 subset이 모두 빈발해야 k+1-itemset이 빈발할 수 있다.</li>
</ol></li>
<li>k+1-itemset 후보에 대해 DB를 scan하여 빈발한 itemset을 찾는다.</li>
<li>k += 1</li>
<li>빈발 itemset이 없으면 종료</li>
</ol></li>
</ol>
<ul>
<li>Apriori의 단점: DB scan을 여러 번 해야함, 후보가 많아질 수 있음
<ul>
<li>후보 수를 줄이는 방법: Hashing</li>
</ul></li>
</ul>
</section>
<section id="dhp-direct-hashing-and-pruning" class="level3">
<h3 class="anchored" data-anchor-id="dhp-direct-hashing-and-pruning">DHP (Direct Hashing and Pruning)</h3>
<ul>
<li><p>Hash값이 같은 itemset의 count를 합하고, minimum support를 넘는 itemset만 남김</p></li>
<li><p>Hash table을 매번 만드는 번거로움이 있지만, apriori보다 빠름</p></li>
<li><p>반복</p>
<ol type="1">
<li>빈발 항목 찾기, 후보 해시 테이블 생성
<ul>
<li>데이터베이스를 scan하여 최소 지지도를 넘는 1-itemset 후보를 찾음</li>
<li>동시에 조합 가능한 2-itemset을 만들어 mapping된 해시 테이블 bucket에 count += 1</li>
</ul></li>
<li>가지치기
<ul>
<li>1-itemset 후보를 이용해 self-join, prune으로 2-itemset 후보 생성</li>
<li>완성된 후보를 1단계에서 만든 hash table에 매핑해서 최소 지지도를 넘는 2-itemset bucket이 아닐 경우 배제</li>
</ul></li>
</ol></li>
</ul>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>data mining</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/data_mining/04.html</guid>
  <pubDate>Sun, 27 Apr 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/computer/01.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/computer/01.pdf</guid>
  <pubDate>Sat, 26 Apr 2025 02:25:15 GMT</pubDate>
</item>
<item>
  <title></title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/07.pdf</link>
  <description><![CDATA[ undefined ]]></description>
  <category>보고서</category>
  <category>OR</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/07.pdf</guid>
  <pubDate>Sat, 19 Apr 2025 03:06:02 GMT</pubDate>
</item>
<item>
  <title>쌍대이론과 민감도 분석 (part 6)</title>
  <link>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/05.html</link>
  <description><![CDATA[ 




<p><img src="https://cryscham123.github.io/img/stat-thumb.jpg" class="post-thumbnail img-fluid"></p>
<section id="쌍대이론의-본질" class="level2">
<h2 class="anchored" data-anchor-id="쌍대이론의-본질">쌍대이론의 본질</h2>
<ul>
<li>모든 선형계획 문제는 쌍대문제를 가진다:
<ul>
<li>원문제(Primal): 예를 들어 이익 최대화.</li>
<li>쌍대문제(Dual): 자원비용 최소화.</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/img/2025-04-19-11-51-58.png" class="img-fluid figure-img"></p>
<figcaption>원 문제와 쌍대 문제의 관계</figcaption>
</figure>
</div>
<section id="원-쌍대-관계의-성질" class="level3">
<h3 class="anchored" data-anchor-id="원-쌍대-관계의-성질">원-쌍대 관계의 성질</h3>
<ul>
<li>원문제의 최적해가 존재하면 쌍대문제의 최적해도 존재하며, 두 목적함수값은 같다.</li>
<li>원문제의 해로부터 쌍대해를 읽을 수 있고, 그 역도 성립한다.</li>
<li>쌍대해는 자원의 경제적 가치(잠재가격, shadow price)를 의미한다</li>
</ul>
</section>
</section>
<section id="원-쌍대-관계와-상보기저해" class="level2">
<h2 class="anchored" data-anchor-id="원-쌍대-관계와-상보기저해">원-쌍대 관계와 상보기저해</h2>
<section id="상보해complementary-solutions" class="level3">
<h3 class="anchored" data-anchor-id="상보해complementary-solutions">상보해(Complementary Solutions)</h3>
<ul>
<li>원문제의 기저해와 쌍대문제의 기저해는 서로 직접적으로 대응한다.</li>
<li>최적해에서는 원문제와 쌍대문제의 목적함수값이 같다.</li>
</ul>
</section>
<section id="상보여유성" class="level3">
<h3 class="anchored" data-anchor-id="상보여유성">상보여유성</h3>
<ul>
<li>원문제의 기저변수가 0이 아니면, 대응 쌍대변수는 0이고, 그 반대도 성립한다.</li>
<li>이 속성은 심플렉스 방법의 반복과정에서 두 문제의 해가 어떻게 연동되는지 설명한다.</li>
</ul>
</section>
</section>
<section id="다른-원문제-형태의-쌍대문제" class="level2">
<h2 class="anchored" data-anchor-id="다른-원문제-형태의-쌍대문제">다른 원문제 형태의 쌍대문제</h2>
<ul>
<li>비표준형(등식제약식, 변수의 음수 허용 등)에서도 쌍대문제는 항상 존재
<ul>
<li>등식제약식은 쌍대에서 해당 쌍대변수의 부호제약을 제거(음수 허용)한다.</li>
<li>변수의 음수 허용은 쌍대에서 등식제약식으로 나타난다.</li>
</ul></li>
</ul>
<section id="sobsensible-odd-bizarre-법칙" class="level3">
<h3 class="anchored" data-anchor-id="sobsensible-odd-bizarre-법칙">SOB(Sensible-Odd-Bizarre) 법칙</h3>
<ul>
<li>원문제의 제약식 및 변수의 형태(≤, =, ≥, 비음, 무제약 등)에 따라 쌍대문제의 대응 형태를 쉽게 결정하는 규칙.</li>
<li>대칭성: 쌍대문제의 쌍대는 원문제이므로, 두 문제의 관계는 완전히 대칭적이다.</li>
</ul>
</section>
</section>
<section id="민감도-분석" class="level2">
<h2 class="anchored" data-anchor-id="민감도-분석">민감도 분석</h2>
</section>
<section id="민감도-분석-적용-요약-및-주요-내용" class="level2">
<h2 class="anchored" data-anchor-id="민감도-분석-적용-요약-및-주요-내용">6.7 민감도 분석 적용 – 요약 및 주요 내용</h2>
<p><strong>6.7절 “민감도 분석 적용”</strong>은 선형계획(Linear Programming) 문제에서 민감도 분석(Sensitivity Analysis)을 실제로 어떻게 적용하는지, 그리고 다양한 매개변수 변화가 최적해에 어떤 영향을 미치는지 구체적으로 설명하는 부분입니다.</p>
<section id="주요-내용-요약" class="level3">
<h3 class="anchored" data-anchor-id="주요-내용-요약">주요 내용 요약</h3>
<ul>
<li><p><strong>민감도 분석의 출발점</strong><br>
민감도 분석은 보통 자원(b₁, b₂, …, bₘ)의 공급량 변화가 해에 미치는 영향을 분석하는 것으로 시작합니다. 이는 실제 모델에서 자원의 양을 조정할 수 있는 융통성이 크기 때문입니다.</p></li>
<li><p><strong>우변(b) 변화의 영향</strong><br>
자원(b)의 값이 변하면, 최종 심플렉스 표의 우변만 바뀌고 나머지(행 0의 비기저변수 계수 등)는 변하지 않을 수 있습니다. 이때는 우변만 수정해서 해가 여전히 가능(feasible)한지(기저변수 값이 모두 음이 아닌지) 확인하면 됩니다. 만약 불가능해지면 쌍대심플렉스법 등으로 재최적화가 필요합니다.</p></li>
<li><p><strong>증분 분석</strong><br>
자원의 값이 변화할 때, 변화분만큼의 영향(증분)을 계산해서 새로운 해와 목적함수 값을 빠르게 구할 수 있습니다.</p></li>
<li><p><strong>허용범위(Allowable Range)</strong><br>
각 자원(b)의 변화가 해의 가능성과 최적성을 유지할 수 있는 범위를 계산합니다. 이 범위 내에서는 잠재가격(dual price, shadow price)이 유효하게 적용됩니다.</p></li>
<li><p><strong>동시 변화와 100% 규칙</strong><br>
여러 자원의 값이 동시에 변할 때, 각 변화가 허용범위 내에서 차지하는 비율의 합이 100%를 넘지 않으면 잠재가격을 이용한 해석이 유효합니다.</p></li>
<li><p><strong>목적함수 계수 변화</strong><br>
비기저변수나 기저변수의 목적함수 계수(c)가 변할 때 해가 어떻게 변하는지, 허용범위를 어떻게 계산하는지 설명합니다.</p></li>
<li><p><strong>새로운 제약식 추가</strong><br>
모델에 새로운 제약식이 추가되면, 기존 최적해가 여전히 가능해인지 확인하고, 아니라면 심플렉스 표에 새로운 행을 추가해 재최적화를 진행합니다.</p></li>
<li><p><strong>파라메트릭 분석</strong><br>
하나 또는 여러 매개변수를 연속적으로 변화시키면서 최적해가 어떻게 달라지는지 체계적으로 분석합니다.</p></li>
</ul>
</section>
<section id="예시-wyndor-glass-co.-모델" class="level3">
<h3 class="anchored" data-anchor-id="예시-wyndor-glass-co.-모델">예시: Wyndor Glass Co.&nbsp;모델</h3>
<ul>
<li>b₂(자원 2의 공급량)가 12에서 24로 증가하면, 기저해가 더 이상 가능하지 않게 되고, 쌍대심플렉스법을 통해 새로운 최적해를 구해야 함을 보여줍니다.</li>
<li>허용범위 내에서만 자원의 변화에 대해 잠재가격이 유효하며, 이를 벗어나면 해가 바뀌고 잠재가격도 달라집니다.</li>
<li>여러 자원이 동시에 변할 때 100% 규칙을 적용해, 변화의 합이 100%를 넘지 않으면 기존 해석이 유효함을 설명합니다.</li>
</ul>
</section>
<section id="실무적-의의" class="level3">
<h3 class="anchored" data-anchor-id="실무적-의의">실무적 의의</h3>
<ul>
<li>실제 기업(예: Pacific Lumber Company)의 대규모 산림관리 최적화 문제에 민감도 분석이 어떻게 적용되어, 불확실성 하에서 더 나은 의사결정과 수익 증대에 기여했는지 사례로 제시합니다.</li>
</ul>
<hr>
<p><strong>요약:</strong><br>
6.7절은 선형계획의 해가 자원, 목적함수 계수, 제약식 등 모델의 매개변수 변화에 얼마나 민감한지, 그리고 이런 변화가 있을 때 해를 신속하게 갱신하거나 재최적화하는 절차를 구체적으로 다룹니다. 이를 통해 실제 의사결정에서 불확실성을 관리하고, 최적화 모델의 실용성을 높일 수 있음을 보여줍니다.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a> ]]></description>
  <category>OR</category>
  <category>학부 정리</category>
  <guid>https://cryscham123.github.io/posts/01_projects/bs_3_1/notes/OR/05.html</guid>
  <pubDate>Fri, 18 Apr 2025 15:00:00 GMT</pubDate>
</item>
</channel>
</rss>
